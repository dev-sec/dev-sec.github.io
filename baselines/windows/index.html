<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>
  DevSec Windows Baseline â€“ DevSec Hardening Framework
</title>

    <link rel="stylesheet" href="/css/app.css" />
    <link rel="stylesheet" href="/css/github_buttons.css" />

    <link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300' rel='stylesheet' type='text/css'>
  </head>
  <body>

    
    <nav class="top-bar" data-topbar role="navigation">
  <ul class="title-area">
    <li class="name">
      <h1>
        <a href="/index.html" id="nav-logo">
          <img src="/images/hardening_logo.png" style="width: 45px;"/>
          DevSec Hardening Framework
        </a>
      </h1>

    </li>
     
    <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
  </ul>

  <section class="top-bar-section">
    <ul class="right">
      
        <li>
          <a href="/project/">
            About
          </a>
        </li>
      
        <li>
          <a href="/baselines/">
            Baselines
          </a>
        </li>
      
        <li>
          <a href="/videos/">
            Videos
          </a>
        </li>
      
        <li>
          <a href="/community/">
            Community
          </a>
        </li>
      
        <li>
          <a href="/blog/">
            News
          </a>
        </li>
      
        <li>
          <a href="https://github.com/dev-sec">
            GitHub
          </a>
        </li>
      
    </ul>
  </section>
</nav>

    

    
    

<div id="windows-baseline" class="section baseline-links">
    <div class="row">
        <div class="inner">
            <div class="row center links">
              
              <a href="https://github.com/dev-sec/windows-baseline" class="button"><i class="icon-github-circled"></i><span>InSpec Profile</span></a>
              
              <a href="https://github.com/dev-sec/ansible-windows-hardening" class="button"><i class="icon-github-circled"></i><span>Ansible Remediation Role</span></a>
              
              <a href="https://github.com/dev-sec/chef-windows-hardening" class="button"><i class="icon-github-circled"></i><span>Chef Remediation Cookbook</span></a>
              
            </div>
        </div>
    </div>
</div>


<noscript>Please enable JavaScript to view this website.</noscript>

<script>(function(a){function b(a){return q.typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?b=function(a){return typeof a}:b=function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},b(a)}function c(a){function b(d,e){try{var f=a[d](e),g=f.value,h=g instanceof q.AwaitValue;Promise.resolve(h?g.wrapped:g).then(function(a){return h?void b("next",a):void c(f.done?"return":"normal",a)},function(a){b("throw",a)})}catch(a){c("throw",a)}}function c(a,c){switch(a){case"return":d.resolve({value:c,done:!0});break;case"throw":d.reject(c);break;default:d.resolve({value:c,done:!1});}d=d.next,d?b(d.key,d.arg):e=null}var d,e;this._invoke=function(a,c){return new Promise(function(f,g){var h={key:a,arg:c,resolve:f,reject:g,next:null};e?e=e.next=h:(d=e=h,b(a,c))})},"function"!==typeof a.return&&(this.return=void 0)}function d(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function e(a,b){for(var c in b){var d=b[c];d.configurable=d.enumerable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,c,d)}if(Object.getOwnPropertySymbols)for(var e=Object.getOwnPropertySymbols(b),f=0;f<e.length;f++){var g=e[f],d=b[g];d.configurable=d.enumerable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,g,d)}return a}function f(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function g(){return q.extends=g=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},g.apply(this,arguments)}function h(a){return q.getPrototypeOf=h=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},h(a)}function i(a,b){return q.setPrototypeOf=i=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},i(a,b)}function j(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function k(){return q.construct=j()?k=Reflect.construct:k=function(b,c,d){var e=[null];e.push.apply(e,c);var a=Function.bind.apply(b,e),f=new a;return d&&q.setPrototypeOf(f,d.prototype),f},k.apply(null,arguments)}function l(a){var b="function"===typeof Map?new Map:void 0;return q.wrapNativeSuper=l=function(a){function c(){return q.construct(a,arguments,q.getPrototypeOf(this).constructor)}if(null===a)return null;if("function"!==typeof a)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof b){if(b.has(a))return b.get(a);b.set(a,c)}return c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),q.setPrototypeOf(c,a)},l(a)}function m(a,b,c){return q.get="undefined"!==typeof Reflect&&Reflect.get?m=Reflect.get:m=function(a,b,c){var d=q.superPropBase(a,b);if(d){var e=Object.getOwnPropertyDescriptor(d,b);return e.get?e.get.call(c):e.value}},m(a,b,c||a)}function n(a,b,c,d){return n="undefined"!==typeof Reflect&&Reflect.set?Reflect.set:function(a,b,c,d){var e,f=q.superPropBase(a,b);if(f){if(e=Object.getOwnPropertyDescriptor(f,b),e.set)return e.set.call(d,c),!0;if(!e.writable)return!1}if(e=Object.getOwnPropertyDescriptor(d,b),e){if(!e.writable)return!1;e.value=c,Object.defineProperty(d,b,e)}else q.defineProperty(d,b,c);return!0},n(a,b,c,d)}function o(a,b,c,d,e){var f=n(a,b,c,d||a);if(!f&&e)throw new Error("failed to set property");return c}function p(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}var q=a.babelHelpers={};q.typeof=b,q.asyncIterator=function(a){var b;if("function"===typeof Symbol){if(Symbol.asyncIterator&&(b=a[Symbol.asyncIterator],null!=b))return b.call(a);if(Symbol.iterator&&(b=a[Symbol.iterator],null!=b))return b.call(a)}throw new TypeError("Object is not async iterable")},q.AwaitValue=function(a){this.wrapped=a},"function"===typeof Symbol&&Symbol.asyncIterator&&(c.prototype[Symbol.asyncIterator]=function(){return this}),c.prototype.next=function(a){return this._invoke("next",a)},c.prototype.throw=function(a){return this._invoke("throw",a)},c.prototype.return=function(a){return this._invoke("return",a)},q.AsyncGenerator=c,q.wrapAsyncGenerator=function(a){return function(){return new q.AsyncGenerator(a.apply(this,arguments))}},q.awaitAsyncGenerator=function(a){return new q.AwaitValue(a)},q.asyncGeneratorDelegate=function(a,b){function c(c,d){return e=!0,d=new Promise(function(b){b(a[c](d))}),{done:!1,value:b(d)}}var d={},e=!1;return"function"===typeof Symbol&&Symbol.iterator&&(d[Symbol.iterator]=function(){return this}),d.next=function(a){return e?(e=!1,a):c("next",a)},"function"===typeof a.throw&&(d.throw=function(a){if(e)throw e=!1,a;return c("throw",a)}),"function"===typeof a.return&&(d.return=function(a){return c("return",a)}),d},q.asyncToGenerator=function(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){function f(a,b){try{var c=i[a](b),f=c.value}catch(a){return void e(a)}c.done?d(f):Promise.resolve(f).then(g,h)}function g(a){f("next",a)}function h(a){f("throw",a)}var i=a.apply(b,c);g()})}},q.classCallCheck=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},q.createClass=function(a,b,c){return b&&d(a.prototype,b),c&&d(a,c),a},q.defineEnumerableProperties=e,q.defaults=function(a,b){for(var c=Object.getOwnPropertyNames(b),d=0;d<c.length;d++){var e=c[d],f=Object.getOwnPropertyDescriptor(b,e);f&&f.configurable&&a[e]===void 0&&Object.defineProperty(a,e,f)}return a},q.defineProperty=f,q.extends=g,q.objectSpread=function(a){for(var b=1;b<arguments.length;b++){var c=null==arguments[b]?{}:arguments[b],d=Object.keys(c);"function"===typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){q.defineProperty(a,b,c[b])})}return a},q.inherits=function(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&q.setPrototypeOf(a,b)},q.getPrototypeOf=h,q.setPrototypeOf=i,q.construct=k,q.wrapNativeSuper=l,q.instanceof=function(a,b){return null!=b&&"undefined"!==typeof Symbol&&b[Symbol.hasInstance]?b[Symbol.hasInstance](a):a instanceof b},q.interopRequireDefault=function(a){return a&&a.__esModule?a:{default:a}},q.interopRequireWildcard=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b},q.newArrowCheck=function(a,b){if(a!==b)throw new TypeError("Cannot instantiate an arrow function")},q.objectDestructuringEmpty=function(a){if(null==a)throw new TypeError("Cannot destructure undefined")},q.objectWithoutProperties=function(a,b){if(null==a)return{};var c,d,e={},f=Object.keys(a);for(d=0;d<f.length;d++)c=f[d],0<=b.indexOf(c)||(e[c]=a[c]);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(a);for(d=0;d<g.length;d++)c=g[d],!(0<=b.indexOf(c))&&Object.prototype.propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e},q.assertThisInitialized=function(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a},q.possibleConstructorReturn=function(a,b){return b&&("object"===typeof b||"function"===typeof b)?b:q.assertThisInitialized(a)},q.superPropBase=function(a,b){for(;!Object.prototype.hasOwnProperty.call(a,b)&&(a=q.getPrototypeOf(a),null!==a););return a},q.get=m,q.set=o,q.taggedTemplateLiteral=function(a,b){return b||(b=a.slice(0)),Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(b)}}))},q.temporalRef=function(a,b){if(a===q.temporalUndefined)throw new ReferenceError(b+" is not defined - temporal dead zone");else return a},q.readOnlyError=function(a){throw new Error("\""+a+"\" is read-only")},q.temporalUndefined={},q.slicedToArray=function(a,b){return q.arrayWithHoles(a)||q.iterableToArrayLimit(a,b)||q.nonIterableRest()},q.toArray=function(a){return q.arrayWithHoles(a)||q.iterableToArray(a)||q.nonIterableRest()},q.toConsumableArray=function(a){return q.arrayWithoutHoles(a)||q.iterableToArray(a)||q.nonIterableSpread()},q.arrayWithoutHoles=function(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}},q.arrayWithHoles=function(a){if(Array.isArray(a))return a},q.iterableToArray=p,q.iterableToArrayLimit=function(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c},q.nonIterableSpread=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")},q.nonIterableRest=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")},q.toPropertyKey=function(a){return"symbol"===typeof a?a:a+""}})("undefined"===typeof global?self:global);</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>
<script src="/node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>
<script>"use strict";(function(){function a(a,b,c){var d=a;if(d.state=b,d.stateData=c,0<d.onNextStateChange.length){var e=d.onNextStateChange.slice();d.onNextStateChange.length=0;for(var f,g=0,h=e;g<h.length;g++)f=h[g],f()}return d}function b(b){function d(){try{document.head.removeChild(f)}catch(a){}}var e=a(b,"Loading",void 0),f=document.createElement("script");return f.src=b.url,f.onload=function(){var a,b;void 0===r?(a=[],b=void 0):(f=r(),a=f[0],b=f[1]),c(e,a,b),d();var f},f.onerror=function(){g(b,new TypeError("Failed to fetch "+b.url)),d()},document.head.appendChild(f),e}function c(b,c,e){var f=d(b,c),g=f[0],h=f[1];return a(b,"WaitingForTurn",{args:g,deps:h,moduleBody:e})}function d(a,c){for(var e,f=[],g=[],i=0,j=c;i<j.length;i++){if(e=j[i],"exports"===e){f.push(a.exports);continue}if("require"===e){f.push(function(b,c,e){var f=d(a,b),g=f[0],i=f[1];h(i,function(){c&&c.apply(null,g)},e)});continue}if("meta"===e){f.push({url:!0===a.isTopLevel?a.url.substring(0,a.url.lastIndexOf("#")):a.url});continue}var l=k(n(a.urlBase,e));f.push(l.exports),g.push(l),"Initialized"===l.state&&b(l)}return[f,g]}function e(b){var c=a(b,"WaitingOnDeps",b.stateData);return h(b.stateData.deps,function(){return f(c)},function(a){return g(c,a)}),c}function f(b){var c=b.stateData;if(null!=c.moduleBody)try{c.moduleBody.apply(null,c.args)}catch(a){return g(b,a)}return a(b,"Executed",void 0)}function g(b,c){return!0===b.isTopLevel&&setTimeout(function(){throw c}),a(b,"Failed",c)}function h(a,b,c){var d=a.shift();return void 0===d?void(b&&b()):"WaitingOnDeps"===d.state?(!1,void h(a,b,c)):void i(d,function(){h(a,b,c)},c)}function i(a,b,c){switch(a.state){case"WaitingForTurn":return e(a),void i(a,b,c);case"Failed":return void(c&&c(a.stateData));case"Executed":return void b();case"Loading":case"WaitingOnDeps":return void a.onNextStateChange.push(function(){return i(a,b,c)});case"Initialized":throw new Error("All dependencies should be loading already before pressureDependencyToExecute is called.");default:throw new Error("Impossible module state: "+a.state);}}function j(a,b){switch(a.state){case"Executed":case"Failed":return void b();default:a.onNextStateChange.push(function(){return j(a,b)});}}function k(a){var b=q[a];return void 0===b&&(b=q[a]={url:a,urlBase:m(a),exports:Object.create(null),state:"Initialized",stateData:void 0,isTopLevel:!1,onNextStateChange:[]}),b}function l(a){return v.href=a,v.href}function m(a){return a=a.split("?")[0],a=a.split("#")[0],a.substring(0,a.lastIndexOf("/")+1)}function n(a,b){return-1===b.indexOf("://")?l(a+b):b}function o(){return document.baseURI||(document.querySelector("base")||window.location).href}function p(){var b=document.currentScript;if(!b)return u;if(window.HTMLImports){var c=window.HTMLImports.importForElement(b);return c?c.href:u}var d=b.ownerDocument.createElement("a");return d.href="",d.href}if(!window.define){var q=Object.create(null),r=void 0,s=0,t=void 0,u=o();window.define=function(a,b){var d=!1;r=function(){return d=!0,r=void 0,[a,b]};var f=p();setTimeout(function(){if(!1==d){r=void 0;var g=f+"#"+s++,h=k(g);h.isTopLevel=!0;var i=c(h,a,b);void 0===t?e(i):j(k(t),function(){e(i)}),t=g}},0)},window.define._reset=function(){for(var a in q)delete q[a];r=void 0,s=0,t=void 0,u=o()};var v=document.createElement("a")}})();</script>
<script>
  requirejs(["/components/inspec-profile.js"]);
</script>

<div style="max-width: 800px; margin: auto;" class="profile">
  <inspec-profile></inspec-profile>
</div>
<script>
  window.profile = document.getElementsByTagName("inspec-profile")[0];
  profile.profile = {"attributes":[],"controls":[{"code":"control 'windows-base-100' do\n  impact 1.0\n  title 'Verify the Windows folder permissions are properly set'\n  describe file('c:/windows') do\n    it { should be_directory }\n    # it { should_not be_readable }\n    # it { should_not be_writable.by('Administrator') }\n  end\nend\n","desc":null,"descriptions":{},"id":"windows-base-100","impact":1,"refs":[],"source_location":{"line":5,"ref":"windows-baseline-master/controls/access_config.rb"},"tags":{},"title":"Verify the Windows folder permissions are properly set"},{"code":"control 'windows-base-101' do\n  impact 1.0\n  title 'Safe DLL Search Mode is Enabled'\n  desc '\n    cannot be managed via group policy\n    @link: https://msdn.microsoft.com/en-us/library/ms682586(v=vs.85).aspx\n    @link: https://technet.microsoft.com/en-us/library/dd277307.aspx\n  '\n  describe registry_key('HKLM\\System\\CurrentControlSet\\Control\\Session Manager') do\n    it { should exist }\n    it { should_not have_property_value('SafeDllSearchMode', :type_dword, '0') }\n  end\nend\n","desc":"cannot be managed via group policy\n@link: https://msdn.microsoft.com/en-us/library/ms682586(v=vs.85).aspx\n@link: https://technet.microsoft.com/en-us/library/dd277307.aspx","descriptions":{"default":"cannot be managed via group policy\n@link: https://msdn.microsoft.com/en-us/library/ms682586(v=vs.85).aspx\n@link: https://technet.microsoft.com/en-us/library/dd277307.aspx"},"id":"windows-base-101","impact":1,"refs":[],"source_location":{"line":17,"ref":"windows-baseline-master/controls/access_config.rb"},"tags":{},"title":"Safe DLL Search Mode is Enabled"},{"code":"control 'windows-base-102' do\n  impact 1.0\n  title 'Anonymous Access to Windows Shares and Named Pipes is Disallowed'\n  tag cis: ['windows_2012r2:2.3.11.8', 'windows_2016:2.3.10.9']\n  ref 'CIS Microsoft Windows Server 2012 R2 Benchmark'\n  ref 'CIS Microsoft Windows Server 2016 RTM (Release 1607) Benchmark'\n  describe registry_key('HKLM\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters') do\n    it { should exist }\n    its('RestrictNullSessAccess') { should eq 1 }\n  end\nend\n","desc":null,"descriptions":{},"id":"windows-base-102","impact":1,"refs":[{"ref":"CIS Microsoft Windows Server 2012 R2 Benchmark"},{"ref":"CIS Microsoft Windows Server 2016 RTM (Release 1607) Benchmark"}],"source_location":{"line":33,"ref":"windows-baseline-master/controls/access_config.rb"},"tags":{"cis":["windows_2012r2:2.3.11.8","windows_2016:2.3.10.9"]},"title":"Anonymous Access to Windows Shares and Named Pipes is Disallowed"},{"code":"control 'windows-base-103' do\n  impact 1.0\n  title 'All Shares are Configured to Prevent Anonymous Access'\n  describe registry_key('HKLM\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters') do\n    it { should exist }\n    its('NullSessionShares') { should eq [''] }\n  end\nend\n","desc":null,"descriptions":{},"id":"windows-base-103","impact":1,"refs":[],"source_location":{"line":45,"ref":"windows-baseline-master/controls/access_config.rb"},"tags":{},"title":"All Shares are Configured to Prevent Anonymous Access"},{"code":"control 'windows-base-104' do\n  impact 1.0\n  title 'Force Encrypted Windows Network Passwords'\n  describe registry_key('HKLM\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters') do\n    it { should exist }\n    its('EnablePlainTextPassword') { should eq 0 }\n  end\nend\n","desc":null,"descriptions":{},"id":"windows-base-104","impact":1,"refs":[],"source_location":{"line":54,"ref":"windows-baseline-master/controls/access_config.rb"},"tags":{},"title":"Force Encrypted Windows Network Passwords"},{"code":"control 'windows-base-105' do\n  title 'SMB1 to Windows Shares is disabled'\n  desc 'All Windows Shares are Configured to disable the SMB1 protocol'\n  impact 1.0\n  describe registry_key('HKLM\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters') do\n    it { should exist }\n    its('SMB1') { should eq 0 }\n  end\nend\n","desc":"All Windows Shares are Configured to disable the SMB1 protocol","descriptions":{"default":"All Windows Shares are Configured to disable the SMB1 protocol"},"id":"windows-base-105","impact":1,"refs":[],"source_location":{"line":63,"ref":"windows-baseline-master/controls/access_config.rb"},"tags":{},"title":"SMB1 to Windows Shares is disabled"},{"code":"control 'windows-base-201' do\n  impact 1.0\n  title 'Strong Windows NTLMv2 Authentication Enabled; Weak LM Disabled'\n  desc '\n    @link: http://support.microsoft.com/en-us/kb/823659\n  '\n  describe registry_key('HKLM\\System\\CurrentControlSet\\Control\\Lsa') do\n    it { should exist }\n    its('LmCompatibilityLevel') { should eq 4 }\n  end\nend\n","desc":"@link: http://support.microsoft.com/en-us/kb/823659","descriptions":{"default":"@link: http://support.microsoft.com/en-us/kb/823659"},"id":"windows-base-201","impact":1,"refs":[],"source_location":{"line":76,"ref":"windows-baseline-master/controls/access_config.rb"},"tags":{},"title":"Strong Windows NTLMv2 Authentication Enabled; Weak LM Disabled"},{"code":"control 'windows-base-202' do\n  impact 1.0\n  title 'Enable Strong Encryption for Windows Network Sessions on Clients'\n  describe registry_key('HKLM\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0') do\n    it { should exist }\n    its('NtlmMinClientSec') { should eq 537_395_200 }\n  end\nend\n","desc":null,"descriptions":{},"id":"windows-base-202","impact":1,"refs":[],"source_location":{"line":88,"ref":"windows-baseline-master/controls/access_config.rb"},"tags":{},"title":"Enable Strong Encryption for Windows Network Sessions on Clients"},{"code":"control 'windows-base-203' do\n  impact 1.0\n  title 'Enable Strong Encryption for Windows Network Sessions on Servers'\n  describe registry_key('HKLM\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0') do\n    it { should exist }\n    its('NtlmMinServerSec') { should eq 537_395_200 }\n  end\nend\n","desc":null,"descriptions":{},"id":"windows-base-203","impact":1,"refs":[],"source_location":{"line":97,"ref":"windows-baseline-master/controls/access_config.rb"},"tags":{},"title":"Enable Strong Encryption for Windows Network Sessions on Servers"},{"code":"control 'cis-account-lockout-duration-1.2.1' do\n  impact 0.7\n  title '1.2.1 Set Account lockout duration to 15 or more minutes'\n  desc 'Set Account lockout duration to 15 or more minutes'\n  describe security_policy do\n    its('LockoutDuration') { should be \u003e= 15 }\n  end\nend\n","desc":"Set Account lockout duration to 15 or more minutes","descriptions":{"default":"Set Account lockout duration to 15 or more minutes"},"id":"cis-account-lockout-duration-1.2.1","impact":0.7,"refs":[],"source_location":{"line":5,"ref":"windows-baseline-master/controls/account_lockout.rb"},"tags":{},"title":"1.2.1 Set Account lockout duration to 15 or more minutes"},{"code":"control 'cis-account-lockout-threshold-1.2.2' do\n  impact 0.7\n  title '1.2.2 Set Account lockout threshold to 10 or fewer invalid logon attempts but not 0'\n  desc 'Set Account lockout threshold to 10 or fewer invalid logon attempts but not 0'\n  describe security_policy do\n    its('LockoutBadCount') { should be \u003c= 10 }\n    its('LockoutBadCount') { should be \u003e 0 }\n  end\nend\n","desc":"Set Account lockout threshold to 10 or fewer invalid logon attempts but not 0","descriptions":{"default":"Set Account lockout threshold to 10 or fewer invalid logon attempts but not 0"},"id":"cis-account-lockout-threshold-1.2.2","impact":0.7,"refs":[],"source_location":{"line":14,"ref":"windows-baseline-master/controls/account_lockout.rb"},"tags":{},"title":"1.2.2 Set Account lockout threshold to 10 or fewer invalid logon attempts but not 0"},{"code":"control 'cis-reset-account-lockout-1.2.3' do\n  impact 0.7\n  title '1.2.3 Set Reset account lockout counter after to 15 or more minutes'\n  desc 'Set Reset account lockout counter after to 15 or more minutes'\n  describe security_policy do\n    its('ResetLockoutCount') { should be \u003e= 15 }\n  end\nend\n","desc":"Set Reset account lockout counter after to 15 or more minutes","descriptions":{"default":"Set Reset account lockout counter after to 15 or more minutes"},"id":"cis-reset-account-lockout-1.2.3","impact":0.7,"refs":[],"source_location":{"line":24,"ref":"windows-baseline-master/controls/account_lockout.rb"},"tags":{},"title":"1.2.3 Set Reset account lockout counter after to 15 or more minutes"},{"code":"control 'windows-account-100' do\n  impact 1.0\n  title 'Windows Remote Desktop Configured to Only Allow System Administrators Access'\n  describe security_policy do\n    # verifies that only the 'Administrators' group has remote access\n    its('SeRemoteInteractiveLogonRight') { should eq ['S-1-5-32-544'] }\n  end\nend\n","desc":null,"descriptions":{},"id":"windows-account-100","impact":1,"refs":[],"source_location":{"line":33,"ref":"windows-baseline-master/controls/account_lockout.rb"},"tags":{},"title":"Windows Remote Desktop Configured to Only Allow System Administrators Access"},{"code":"control 'windows-account-101' do\n  impact 1.0\n  title 'Windows Default Guest Account is Disabled'\n  describe security_policy do\n    its('EnableGuestAccount') { should eq 0 }\n  end\nend\n","desc":null,"descriptions":{},"id":"windows-account-101","impact":1,"refs":[],"source_location":{"line":42,"ref":"windows-baseline-master/controls/account_lockout.rb"},"tags":{},"title":"Windows Default Guest Account is Disabled"},{"code":"control 'windows-account-102' do\n  impact 1.0\n  title 'Windows Password Complexity is Enabled'\n  tag cis: ['windows_2012r2:1.1.5', 'windows_2016:1.1.5']\n  ref 'Password must meet complexity requirements', url: 'https://technet.microsoft.com/en-us/library/hh994562(v=ws.11).aspx'\n  ref 'CIS Microsoft Windows Server 2012 R2 Benchmark'\n  ref 'CIS Microsoft Windows Server 2016 RTM (Release 1607) Benchmark'\n  describe security_policy do\n    its('PasswordComplexity') { should eq 1 }\n  end\nend\n","desc":null,"descriptions":{},"id":"windows-account-102","impact":1,"refs":[{"ref":"Password must meet complexity requirements","url":"https://technet.microsoft.com/en-us/library/hh994562(v=ws.11).aspx"},{"ref":"CIS Microsoft Windows Server 2012 R2 Benchmark"},{"ref":"CIS Microsoft Windows Server 2016 RTM (Release 1607) Benchmark"}],"source_location":{"line":50,"ref":"windows-baseline-master/controls/account_lockout.rb"},"tags":{"cis":["windows_2012r2:1.1.5","windows_2016:1.1.5"]},"title":"Windows Password Complexity is Enabled"},{"code":"control 'windows-account-103' do\n  impact 1.0\n  title 'Minimum Windows Password Length Configured to be at Least 8 Characters'\n  desc 'Minimum password length'\n  describe security_policy do\n    # TODO: check that the number is greater than 8\n    its('MinimumPasswordLength') { should_not eq 0 }\n  end\nend\n","desc":"Minimum password length","descriptions":{"default":"Minimum password length"},"id":"windows-account-103","impact":1,"refs":[],"source_location":{"line":62,"ref":"windows-baseline-master/controls/account_lockout.rb"},"tags":{},"title":"Minimum Windows Password Length Configured to be at Least 8 Characters"},{"code":"control 'windows-account-104' do\n  impact 1.0\n  title 'Set Windows Account lockout threshold'\n  desc 'Account lockout threshold, see https://technet.microsoft.com/en-us/library/hh994574.aspx'\n  describe security_policy do\n    # TODO: setting above 4 and below 10\n    its('LockoutBadCount') { should_not eq 0 }\n  end\nend\n","desc":"Account lockout threshold, see https://technet.microsoft.com/en-us/library/hh994574.aspx","descriptions":{"default":"Account lockout threshold, see https://technet.microsoft.com/en-us/library/hh994574.aspx"},"id":"windows-account-104","impact":1,"refs":[],"source_location":{"line":72,"ref":"windows-baseline-master/controls/account_lockout.rb"},"tags":{},"title":"Set Windows Account lockout threshold"},{"code":"control 'windows-account-105' do\n  impact 1.0\n  title 'Windows Account Lockout Counter Configured to Wait at Least 30 Minutes Before Reset'\n  desc 'Reset lockout counter after, see https://technet.microsoft.com/en-us/library/hh994568.aspx'\n  describe security_policy do\n    # TODO: make time variable for ranges\n    its('ResetLockoutCount') { should_not eq 0 }\n  end\nend\n","desc":"Reset lockout counter after, see https://technet.microsoft.com/en-us/library/hh994568.aspx","descriptions":{"default":"Reset lockout counter after, see https://technet.microsoft.com/en-us/library/hh994568.aspx"},"id":"windows-account-105","impact":1,"refs":[],"source_location":{"line":82,"ref":"windows-baseline-master/controls/account_lockout.rb"},"tags":{},"title":"Windows Account Lockout Counter Configured to Wait at Least 30 Minutes Before Reset"},{"code":"control 'windows-account-106' do\n  impact 1.0\n  title 'Windows Account Lockout Duration Configured to at Least 30 Minutes'\n  desc 'Account lockout duration, see https://technet.microsoft.com/en-us/library/hh994569.aspx'\n  describe security_policy do\n    # TODO: make time variable for ranges\n    its('LockoutDuration') { should_not eq 0 }\n  end\nend\n","desc":"Account lockout duration, see https://technet.microsoft.com/en-us/library/hh994569.aspx","descriptions":{"default":"Account lockout duration, see https://technet.microsoft.com/en-us/library/hh994569.aspx"},"id":"windows-account-106","impact":1,"refs":[],"source_location":{"line":92,"ref":"windows-baseline-master/controls/account_lockout.rb"},"tags":{},"title":"Windows Account Lockout Duration Configured to at Least 30 Minutes"},{"code":"control 'windows-audit-100' do\n  impact 0.1\n  title 'Configure System Event Log (Application)'\n  desc 'Only appies for Windows 2008 and newer'\n  describe registry_key('HKLM\\Software\\Policies\\Microsoft\\Windows\\EventLog\\Application') do\n    it { should exist }\n    its('MaxSize') { should_not eq nil }\n  end\nend\n","desc":"Only appies for Windows 2008 and newer","descriptions":{"default":"Only appies for Windows 2008 and newer"},"id":"windows-audit-100","impact":0.1,"refs":[],"source_location":{"line":5,"ref":"windows-baseline-master/controls/audit_log_config.rb"},"tags":{},"title":"Configure System Event Log (Application)"},{"code":"control 'windows-audit-101' do\n  impact 0.1\n  title 'Configure System Event Log (Security)'\n  desc 'Only appies for Windows 2008 and newer'\n  describe registry_key('HKLM\\Software\\Policies\\Microsoft\\Windows\\EventLog\\Security') do\n    it { should exist }\n    its('MaxSize') { should_not eq nil }\n  end\nend\n","desc":"Only appies for Windows 2008 and newer","descriptions":{"default":"Only appies for Windows 2008 and newer"},"id":"windows-audit-101","impact":0.1,"refs":[],"source_location":{"line":15,"ref":"windows-baseline-master/controls/audit_log_config.rb"},"tags":{},"title":"Configure System Event Log (Security)"},{"code":"control 'windows-audit-102' do\n  impact 0.1\n  title 'Configure System Event Log (Setup)'\n  desc 'Only appies for Windows 2008 and newer'\n  describe registry_key('HKLM\\Software\\Policies\\Microsoft\\Windows\\EventLog\\Setup') do\n    it { should exist }\n    its('MaxSize') { should_not eq nil }\n  end\nend\n","desc":"Only appies for Windows 2008 and newer","descriptions":{"default":"Only appies for Windows 2008 and newer"},"id":"windows-audit-102","impact":0.1,"refs":[],"source_location":{"line":25,"ref":"windows-baseline-master/controls/audit_log_config.rb"},"tags":{},"title":"Configure System Event Log (Setup)"},{"code":"control 'windows-audit-103' do\n  impact 0.1\n  title 'Configure System Event Log (System)'\n  desc 'Only appies for Windows 2008 and newer'\n  describe registry_key('HKLM\\Software\\Policies\\Microsoft\\Windows\\EventLog\\System') do\n    it { should exist }\n    its('MaxSize') { should_not eq nil }\n  end\nend\n","desc":"Only appies for Windows 2008 and newer","descriptions":{"default":"Only appies for Windows 2008 and newer"},"id":"windows-audit-103","impact":0.1,"refs":[],"source_location":{"line":35,"ref":"windows-baseline-master/controls/audit_log_config.rb"},"tags":{},"title":"Configure System Event Log (System)"},{"code":"control 'windows-audit-201' do\n  impact 1.0\n  title 'Kerberos Authentication Service Audit Log'\n  desc '\n    policy_name: Audit Kerberos Authentication Service\n    policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon\n  '\n  describe audit_policy do\n    its('Kerberos Authentication Service') { should_not eq 'No Auditing' }\n  end\nend\n","desc":"policy_name: Audit Kerberos Authentication Service\npolicy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon","descriptions":{"default":"policy_name: Audit Kerberos Authentication Service\npolicy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon"},"id":"windows-audit-201","impact":1,"refs":[],"source_location":{"line":45,"ref":"windows-baseline-master/controls/audit_log_config.rb"},"tags":{},"title":"Kerberos Authentication Service Audit Log"},{"code":"control 'windows-audit-202' do\n  impact 1.0\n  title 'Kerberos Service Ticket Operations Audit Log'\n  desc '\n    policy_name: Audit Kerberos Service Ticket Operations\n    policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon\n  '\n  describe audit_policy do\n    its('Kerberos Service Ticket Operations') { should_not eq 'No Auditing' }\n  end\nend\n","desc":"policy_name: Audit Kerberos Service Ticket Operations\npolicy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon","descriptions":{"default":"policy_name: Audit Kerberos Service Ticket Operations\npolicy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon"},"id":"windows-audit-202","impact":1,"refs":[],"source_location":{"line":57,"ref":"windows-baseline-master/controls/audit_log_config.rb"},"tags":{},"title":"Kerberos Service Ticket Operations Audit Log"},{"code":"control 'windows-audit-203' do\n  impact 1.0\n  title 'Account Logon Audit Log'\n  desc '\n    policy_name: Audit Other Account Logon Events\n    policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon\n  '\n  describe audit_policy do\n    its('Other Account Logon Events') { should_not eq 'No Auditing' }\n  end\nend\n","desc":"policy_name: Audit Other Account Logon Events\npolicy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon","descriptions":{"default":"policy_name: Audit Other Account Logon Events\npolicy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Logon"},"id":"windows-audit-203","impact":1,"refs":[],"source_location":{"line":69,"ref":"windows-baseline-master/controls/audit_log_config.rb"},"tags":{},"title":"Account Logon Audit Log"},{"code":"control 'windows-audit-204' do\n  impact 1.0\n  title 'Audit Application Group Management'\n  desc '\n    policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\n  '\n  describe audit_policy do\n    its('Application Group Management') { should_not eq 'No Auditing' }\n  end\nend\n","desc":"policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management","descriptions":{"default":"policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management"},"id":"windows-audit-204","impact":1,"refs":[],"source_location":{"line":81,"ref":"windows-baseline-master/controls/audit_log_config.rb"},"tags":{},"title":"Audit Application Group Management"},{"code":"control 'windows-audit-205' do\n  impact 1.0\n  title 'Audit Computer Account Management'\n  desc '\n    policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\n  '\n  tag cis: ['windows_2012r2:17.2.2', 'windows_2016L:17.2.2']\n  ref 'CIS Microsoft Windows Server 2012 R2 Benchmark'\n  ref 'CIS Microsoft Windows Server 2016 RTM (Release 1607) Benchmark'\n  describe audit_policy do\n    its('Computer Account Management') { should eq 'Success and Failure' }\n  end\nend\n","desc":"policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management","descriptions":{"default":"policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management"},"id":"windows-audit-205","impact":1,"refs":[{"ref":"CIS Microsoft Windows Server 2012 R2 Benchmark"},{"ref":"CIS Microsoft Windows Server 2016 RTM (Release 1607) Benchmark"}],"source_location":{"line":92,"ref":"windows-baseline-master/controls/audit_log_config.rb"},"tags":{"cis":["windows_2012r2:17.2.2","windows_2016L:17.2.2"]},"title":"Audit Computer Account Management"},{"code":"control 'windows-audit-206' do\n  impact 1.0\n  title 'Audit Distributed Group Management'\n  desc '\n    policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\n  '\n  describe audit_policy do\n    its('Distribution Group Management') { should_not eq 'No Auditing' }\n  end\nend\n","desc":"policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management","descriptions":{"default":"policy_path: Computer Configuration\\Windows Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management"},"id":"windows-audit-206","impact":1,"refs":[],"source_location":{"line":106,"ref":"windows-baseline-master/controls/audit_log_config.rb"},"tags":{},"title":"Audit Distributed Group Management"},{"code":"control 'windows-ie-101' do\n  impact 1.0\n  title 'IE 64-bit tab'\n  describe registry_key('HKLM\\Software\\Policies\\Microsoft\\Internet Explorer\\Main') do\n    it { should exist }\n    its('Isolation64Bit') { should eq 1 }\n  end\nend\n","desc":null,"descriptions":{},"id":"windows-ie-101","impact":1,"refs":[],"source_location":{"line":5,"ref":"windows-baseline-master/controls/ie_config.rb"},"tags":{},"title":"IE 64-bit tab"},{"code":"control 'windows-ie-102' do\n  impact 1.0\n  title 'Run antimalware programs against ActiveX controls'\n  describe registry_key('HKLM\\Software\\Policies\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones\\3') do\n    it { should exist }\n    its('270C') { should eq 0 }\n  end\nend\n","desc":null,"descriptions":{},"id":"windows-ie-102","impact":1,"refs":[],"source_location":{"line":14,"ref":"windows-baseline-master/controls/ie_config.rb"},"tags":{},"title":"Run antimalware programs against ActiveX controls"},{"code":"control 'cis-enforce-password-history-1.1.1' do\n  impact 0.7\n  title '1.1.1 Set Enforce password history to 24 or more passwords'\n  desc 'Set Enforce password history to 24 or more passwords'\n  describe security_policy do\n    its('PasswordHistorySize') { should be \u003e= 24 }\n  end\nend\n","desc":"Set Enforce password history to 24 or more passwords","descriptions":{"default":"Set Enforce password history to 24 or more passwords"},"id":"cis-enforce-password-history-1.1.1","impact":0.7,"refs":[],"source_location":{"line":5,"ref":"windows-baseline-master/controls/password_policy.rb"},"tags":{},"title":"1.1.1 Set Enforce password history to 24 or more passwords"},{"code":"control 'cis-maximum-password-age-1.1.2' do\n  impact 0.7\n  title '1.1.2 Set Maximum password age to 60 or fewer days, but not 0'\n  desc 'Set Maximum password age to 60 or fewer days, but not 0'\n  describe security_policy do\n    its('MaximumPasswordAge') { should be \u003c= 60 }\n    its('MaximumPasswordAge') { should be \u003e 0 }\n  end\nend\n","desc":"Set Maximum password age to 60 or fewer days, but not 0","descriptions":{"default":"Set Maximum password age to 60 or fewer days, but not 0"},"id":"cis-maximum-password-age-1.1.2","impact":0.7,"refs":[],"source_location":{"line":14,"ref":"windows-baseline-master/controls/password_policy.rb"},"tags":{},"title":"1.1.2 Set Maximum password age to 60 or fewer days, but not 0"},{"code":"control 'cis-minimum-password-age-1.1.3' do\n  impact 0.7\n  title '1.1.3 Set Minimum password age to 1 or more days'\n  desc 'Set Minimum password age to 1 or more days'\n  describe security_policy do\n    its('MinimumPasswordAge') { should be \u003e= 1 }\n  end\nend\n","desc":"Set Minimum password age to 1 or more days","descriptions":{"default":"Set Minimum password age to 1 or more days"},"id":"cis-minimum-password-age-1.1.3","impact":0.7,"refs":[],"source_location":{"line":24,"ref":"windows-baseline-master/controls/password_policy.rb"},"tags":{},"title":"1.1.3 Set Minimum password age to 1 or more days"},{"code":"control 'cis-minimum-password-length-1.1.4' do\n  impact 0.7\n  title '1.1.4 Set Minimum password length to 14 or more characters'\n  desc 'Set Minimum password length to 14 or more characters'\n  describe security_policy do\n    its('MinimumPasswordLength') { should be \u003e= 14 }\n  end\nend\n","desc":"Set Minimum password length to 14 or more characters","descriptions":{"default":"Set Minimum password length to 14 or more characters"},"id":"cis-minimum-password-length-1.1.4","impact":0.7,"refs":[],"source_location":{"line":33,"ref":"windows-baseline-master/controls/password_policy.rb"},"tags":{},"title":"1.1.4 Set Minimum password length to 14 or more characters"},{"code":"control 'cis-password-complexity-1.1.6' do\n  impact 0.7\n  title '1.1.6 Set Store passwords using reversible encryption to Disabled'\n  desc 'Set Store passwords using reversible encryption to Disabled'\n  describe security_policy do\n    its('ClearTextPassword') { should eq 0 }\n  end\nend\n","desc":"Set Store passwords using reversible encryption to Disabled","descriptions":{"default":"Set Store passwords using reversible encryption to Disabled"},"id":"cis-password-complexity-1.1.6","impact":0.7,"refs":[],"source_location":{"line":42,"ref":"windows-baseline-master/controls/password_policy.rb"},"tags":{},"title":"1.1.6 Set Store passwords using reversible encryption to Disabled"},{"code":"control 'powershell-script-blocklogging' do\n  impact 1.0\n  title 'PowerShell Script Block Logging'\n  desc 'Enabling PowerShell script block logging will record detailed information from the processing of PowerShell commands and scripts'\n  tag cis: '18.9.84.1'\n  ref 'CIS Microsoft Windows Server 2012 R2 Benchmark', url: 'https://benchmarks.cisecurity.org/tools2/windows/CIS_Microsoft_Windows_Server_2012_R2_Benchmark_v2.2.1.pdf'\n  describe registry_key('HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging') do\n    it { should exist }\n    its('EnableScriptBlockLogging') { should eq 0 }\n  end\nend\n","desc":"Enabling PowerShell script block logging will record detailed information from the processing of PowerShell commands and scripts","descriptions":{"default":"Enabling PowerShell script block logging will record detailed information from the processing of PowerShell commands and scripts"},"id":"powershell-script-blocklogging","impact":1,"refs":[{"ref":"CIS Microsoft Windows Server 2012 R2 Benchmark","url":"https://benchmarks.cisecurity.org/tools2/windows/CIS_Microsoft_Windows_Server_2012_R2_Benchmark_v2.2.1.pdf"}],"source_location":{"line":5,"ref":"windows-baseline-master/controls/powershell.rb"},"tags":{"cis":"18.9.84.1"},"title":"PowerShell Script Block Logging"},{"code":"control 'powershell-transcription' do\n  impact 1.0\n  title 'PowerShell Transcription'\n  desc 'Transcription creates a unique record of every PowerShell session, including all input and output, exactly as it appears in the session.'\n  tag cis: '18.9.84.2'\n  ref 'CIS Microsoft Windows Server 2012 R2 Benchmark', url: 'https://benchmarks.cisecurity.org/tools2/windows/CIS_Microsoft_Windows_Server_2012_R2_Benchmark_v2.2.1.pdf'\n  describe registry_key('HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription') do\n    it { should exist }\n    its('EnableTranscripting') { should eq 0 }\n  end\nend\n","desc":"Transcription creates a unique record of every PowerShell session, including all input and output, exactly as it appears in the session.","descriptions":{"default":"Transcription creates a unique record of every PowerShell session, including all input and output, exactly as it appears in the session."},"id":"powershell-transcription","impact":1,"refs":[{"ref":"CIS Microsoft Windows Server 2012 R2 Benchmark","url":"https://benchmarks.cisecurity.org/tools2/windows/CIS_Microsoft_Windows_Server_2012_R2_Benchmark_v2.2.1.pdf"}],"source_location":{"line":17,"ref":"windows-baseline-master/controls/powershell.rb"},"tags":{"cis":"18.9.84.2"},"title":"PowerShell Transcription"},{"code":"control 'microsoft-online-accounts' do\n  impact 1.0\n  title 'Microsoft Online Accounts'\n  desc 'Disabling Microsoft account logon sign-in option, eg. logging in without having to use local credentials and using microsoft online accounts'\n  ref 'Block Microsoft Accounts', url: 'https://technet.microsoft.com/en-us/library/jj966262(v=ws.11).aspx'\n  describe registry_key('HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\default\\Settings\\AllowYourAccount') do\n    it { should exist }\n    its('value') { should eq 0 }\n  end\nend\n","desc":"Disabling Microsoft account logon sign-in option, eg. logging in without having to use local credentials and using microsoft online accounts","descriptions":{"default":"Disabling Microsoft account logon sign-in option, eg. logging in without having to use local credentials and using microsoft online accounts"},"id":"microsoft-online-accounts","impact":1,"refs":[{"ref":"Block Microsoft Accounts","url":"https://technet.microsoft.com/en-us/library/jj966262(v=ws.11).aspx"}],"source_location":{"line":5,"ref":"windows-baseline-master/controls/privacy.rb"},"tags":{},"title":"Microsoft Online Accounts"},{"code":"control 'disable-windows-store' do\n  impact 1.0\n  title 'Disable Windows Store'\n  desc 'Ensure Turn off Automatic Download and Install ofupdates is set to Disabled'\n  tag cis: '18.9.61.1'\n  ref 'CIS Microsoft Windows Server 2012 R2 Benchmark', url: 'https://benchmarks.cisecurity.org/tools2/windows/CIS_Microsoft_Windows_Server_2012_R2_Benchmark_v2.2.1.pdf'\n  describe registry_key('HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore') do\n    it { should exist }\n    its('AutoDownload') { should eq 4 }\n    its('DisableOSUpgrade') { should eq 1 }\n  end\nend\n","desc":"Ensure Turn off Automatic Download and Install ofupdates is set to Disabled","descriptions":{"default":"Ensure Turn off Automatic Download and Install ofupdates is set to Disabled"},"id":"disable-windows-store","impact":1,"refs":[{"ref":"CIS Microsoft Windows Server 2012 R2 Benchmark","url":"https://benchmarks.cisecurity.org/tools2/windows/CIS_Microsoft_Windows_Server_2012_R2_Benchmark_v2.2.1.pdf"}],"source_location":{"line":16,"ref":"windows-baseline-master/controls/privacy.rb"},"tags":{"cis":"18.9.61.1"},"title":"Disable Windows Store"},{"code":"control 'disable-index-encrypted-files' do\n  impact 1.0\n  title 'Disable indexing encrypted files'\n  desc 'Ensure Allow indexing of encrypted files is set to Disabled'\n  tag cis: '18.9.54.2'\n  ref 'CIS Microsoft Windows Server 2012 R2 Benchmark', url: 'https://benchmarks.cisecurity.org/tools2/windows/CIS_Microsoft_Windows_Server_2012_R2_Benchmark_v2.2.1.pdf'\n  describe registry_key('HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search') do\n    it { should exist }\n    its('AllowIndexingEncryptedStoresOrItems') { should eq 0 }\n  end\nend\n","desc":"Ensure Allow indexing of encrypted files is set to Disabled","descriptions":{"default":"Ensure Allow indexing of encrypted files is set to Disabled"},"id":"disable-index-encrypted-files","impact":1,"refs":[{"ref":"CIS Microsoft Windows Server 2012 R2 Benchmark","url":"https://benchmarks.cisecurity.org/tools2/windows/CIS_Microsoft_Windows_Server_2012_R2_Benchmark_v2.2.1.pdf"}],"source_location":{"line":29,"ref":"windows-baseline-master/controls/privacy.rb"},"tags":{"cis":"18.9.54.2"},"title":"Disable indexing encrypted files"},{"code":"control 'windows-rdp-100' do\n  impact 1.0\n  title 'Windows Remote Desktop Configured to Always Prompt for Password'\n  describe registry_key('HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services') do\n    it { should exist }\n    its('fPromptForPassword') { should eq 1 }\n  end\nend\n","desc":null,"descriptions":{},"id":"windows-rdp-100","impact":1,"refs":[],"source_location":{"line":5,"ref":"windows-baseline-master/controls/rdp_config.rb"},"tags":{},"title":"Windows Remote Desktop Configured to Always Prompt for Password"},{"code":"control 'windows-rdp-101' do\n  impact 1.0\n  title 'Strong Encryption for Windows Remote Desktop Required'\n  describe registry_key('HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services') do\n    it { should exist }\n    its('MinEncryptionLevel') { should eq 3 }\n  end\nend\n","desc":null,"descriptions":{},"id":"windows-rdp-101","impact":1,"refs":[],"source_location":{"line":14,"ref":"windows-baseline-master/controls/rdp_config.rb"},"tags":{},"title":"Strong Encryption for Windows Remote Desktop Required"},{"code":"control 'cis-access-cred-manager-2.2.1' do\n  impact 0.7\n  title '2.2.1 Set Access Credential Manager as a trusted caller to No One'\n  desc 'Set Access Credential Manager as a trusted caller to No One'\n  describe security_policy do\n    its('SeTrustedCredManAccessPrivilege') { should eq ['S-1-0-0'] }\n  end\nend\n","desc":"Set Access Credential Manager as a trusted caller to No One","descriptions":{"default":"Set Access Credential Manager as a trusted caller to No One"},"id":"cis-access-cred-manager-2.2.1","impact":0.7,"refs":[],"source_location":{"line":5,"ref":"windows-baseline-master/controls/user_rights.rb"},"tags":{},"title":"2.2.1 Set Access Credential Manager as a trusted caller to No One"},{"code":"control 'cis-network-access-2.2.2' do\n  impact 0.7\n  title '2.2.2 Set Access this computer from the network'\n  desc 'Set Access this computer from the network'\n  describe security_policy do\n    its('SeNetworkLogonRight') { should eq ['S-1-0-0'] }\n  end\nend\n","desc":"Set Access this computer from the network","descriptions":{"default":"Set Access this computer from the network"},"id":"cis-network-access-2.2.2","impact":0.7,"refs":[],"source_location":{"line":14,"ref":"windows-baseline-master/controls/user_rights.rb"},"tags":{},"title":"2.2.2 Set Access this computer from the network"},{"code":"control 'cis-act-as-os-2.2.3' do\n  impact 0.7\n  title '2.2.3 Set Act as part of the operating system to No One'\n  desc 'Set Act as part of the operating system to No One'\n  describe security_policy do\n    its('SeTcbPrivilege') { should eq ['S-1-0-0'] }\n  end\nend\n","desc":"Set Act as part of the operating system to No One","descriptions":{"default":"Set Act as part of the operating system to No One"},"id":"cis-act-as-os-2.2.3","impact":0.7,"refs":[],"source_location":{"line":23,"ref":"windows-baseline-master/controls/user_rights.rb"},"tags":{},"title":"2.2.3 Set Act as part of the operating system to No One"},{"code":"control 'cis-add-workstations-2.2.4' do\n  impact 0.7\n  title '2.2.4 Set Add workstations to domain to Administrators'\n  desc 'Set Add workstations to domain to Administrators'\n  describe security_policy do\n    its('SeMachineAccountPrivilege') { should eq ['S-1-5-32-544'] }\n  end\nend\n","desc":"Set Add workstations to domain to Administrators","descriptions":{"default":"Set Add workstations to domain to Administrators"},"id":"cis-add-workstations-2.2.4","impact":0.7,"refs":[],"source_location":{"line":32,"ref":"windows-baseline-master/controls/user_rights.rb"},"tags":{},"title":"2.2.4 Set Add workstations to domain to Administrators"},{"code":"control 'cis-adjust-memory-quotas-2.2.5' do\n  impact 0.7\n  title '2.2.5 Set Adust memory quotas for a process to Administrators, LOCAL SERVICE, NETWORK SERVICE'\n  desc 'Set Adust memory quotas for a process to Administrators, LOCAL SERVICE, NETWORK SERVICE'\n  describe security_policy do\n    its('SeIncreaseQuotaPrivilege') { should include 'S-1-5-19' }\n    its('SeIncreaseQuotaPrivilege') { should include 'S-1-5-20' }\n    its('SeIncreaseQuotaPrivilege') { should include 'S-1-5-32-544' }\n  end\nend\n","desc":"Set Adust memory quotas for a process to Administrators, LOCAL SERVICE, NETWORK SERVICE","descriptions":{"default":"Set Adust memory quotas for a process to Administrators, LOCAL SERVICE, NETWORK SERVICE"},"id":"cis-adjust-memory-quotas-2.2.5","impact":0.7,"refs":[],"source_location":{"line":41,"ref":"windows-baseline-master/controls/user_rights.rb"},"tags":{},"title":"2.2.5 Set Adust memory quotas for a process to Administrators, LOCAL SERVICE, NETWORK SERVICE"}],"copyright":"DevSec Hardening Framework Team","copyright_email":"hello@dev-sec.io","generator":{"name":"inspec","version":"2.3.23"},"groups":[{"controls":["windows-base-100","windows-base-101","windows-base-102","windows-base-103","windows-base-104","windows-base-105","windows-base-201","windows-base-202","windows-base-203"],"id":"controls/access_config.rb","title":"Windows Access Configuration"},{"controls":["cis-account-lockout-duration-1.2.1","cis-account-lockout-threshold-1.2.2","cis-reset-account-lockout-1.2.3","windows-account-100","windows-account-101","windows-account-102","windows-account-103","windows-account-104","windows-account-105","windows-account-106"],"id":"controls/account_lockout.rb","title":"Account Lockout Policy"},{"controls":["windows-audit-100","windows-audit-101","windows-audit-102","windows-audit-103","windows-audit-201","windows-audit-202","windows-audit-203","windows-audit-204","windows-audit-205","windows-audit-206"],"id":"controls/audit_log_config.rb","title":"Windows Audit \u0026 Logging Configuration"},{"controls":["windows-ie-101","windows-ie-102"],"id":"controls/ie_config.rb","title":"Windows IE Configuration"},{"controls":["cis-enforce-password-history-1.1.1","cis-maximum-password-age-1.1.2","cis-minimum-password-age-1.1.3","cis-minimum-password-length-1.1.4","cis-password-complexity-1.1.6"],"id":"controls/password_policy.rb","title":"Password Policy"},{"controls":["powershell-script-blocklogging","powershell-transcription"],"id":"controls/powershell.rb","title":"Windows PowerShell"},{"controls":["microsoft-online-accounts","disable-windows-store","disable-index-encrypted-files"],"id":"controls/privacy.rb","title":"Windows Privacy"},{"controls":["windows-rdp-100","windows-rdp-101"],"id":"controls/rdp_config.rb","title":"Windows RDP Configuration"},{"controls":["cis-access-cred-manager-2.2.1","cis-network-access-2.2.2","cis-act-as-os-2.2.3","cis-add-workstations-2.2.4","cis-adjust-memory-quotas-2.2.5"],"id":"controls/user_rights.rb","title":"User Rights Assignment"}],"license":"Apache 2 license","maintainer":"DevSec Hardening Framework Team","name":"windows-baseline","sha256":"45c4caa3cbd3b0d3535412aca10a142a899ed9b4aefc45bc7a2ee0bc4ab2efd3","summary":"Baseline for best-practice Windows OS hardening","supports":[{"platform-family":"windows"}],"title":"DevSec Windows Security Baseline","version":"1.1.1"}
</script>


    
    
    

    
    <footer>
      <ul>
  <li><a href="/legal">Legal notice</a></li>
  <li><a href="/contributing">Contributing</a></li>
  <li><a href="https://twitter.com/devsecio">Twitter</a></li>
  <li><a href="https://gitter.im/dev-sec/general?source=orgpage">Gitter</a></li>
  <li><a href="https://galaxy.ansible.com/dev-sec/">Ansible Galaxy</a></li>
  <li><a href="https://supermarket.getchef.com/cookbooks?q=hardening">Chef Community</a></li>
  <li><a href="https://forge.puppetlabs.com/hardening">Puppet Forge</a></li>
</ul>

    </footer>
    

    <script src="/jquery/dist/jquery.min.js"></script>
    <script src="/foundation/js/foundation/foundation.js"></script>
    <script src="/foundation/js/foundation/foundation.equalizer.js"></script>
    <script src="/foundation/js/foundation/foundation.topbar.js"></script>

    <script src="/js/app.js"></script>

    <script type="text/javascript">
    var $buoop = {vs:{i:9,f:15,o:12.1,s:5.1}};
    $buoop.ol = window.onload;
    window.onload=function(){
      console.log($buoop);
      try {if ($buoop.ol) $buoop.ol();}catch (e) {}
      var e = document.createElement("script");
      e.setAttribute("type", "text/javascript");
      e.setAttribute("src", "//browser-update.org/update.js");
      document.body.appendChild(e);
    }

    </script>
  </body>
</html>
