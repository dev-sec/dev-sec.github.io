<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title> DevSec Nginx Baseline – DevSec Hardening Framework </title>

    <link rel="stylesheet" href="/css/app.css" />
    <link rel="stylesheet" href="/css/github_buttons.css" />

    <link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300' rel='stylesheet' type='text/css'>
  </head>
  <body>

    
    <nav class="top-bar" data-topbar role="navigation">
  <ul class="title-area">
    <li class="name">
      <h1>
        <a href="/" id="nav-logo">
          <img src="/images/hardening_logo.png" style="width: 45px;"/>
          DevSec Hardening Framework
        </a>
      </h1>

    </li>
     
    <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
  </ul>

  <section class="top-bar-section">
    <ul class="right">
      
        <li>
          <a href="/project/">
            About
          </a>
        </li>
      
        <li>
          <a href="/baselines/">
            Baselines
          </a>
        </li>
      
        <li>
          <a href="/videos/">
            Videos
          </a>
        </li>
      
        <li>
          <a href="/community/">
            Community
          </a>
        </li>
      
        <li>
          <a href="/blog/">
            News
          </a>
        </li>
      
        <li>
          <a href="https://github.com/dev-sec">
            GitHub
          </a>
        </li>
      
    </ul>
  </section>
</nav>

    

    
    
    

<div id="nginx-baseline" class="section baseline-links">
    <div class="row">
        <div class="inner">
            <div class="row center links">
              
              <a href="https://github.com/dev-sec/nginx-baseline" class="button"><i class="icon-github-circled"></i><span>InSpec Profile</span></a>
              
              <a href="https://github.com/dev-sec/ansible-nginx-hardening" class="button"><i class="icon-github-circled"></i><span>Ansible Remediation Role</span></a>
              
              <a href="https://github.com/dev-sec/chef-nginx-hardening" class="button"><i class="icon-github-circled"></i><span>Chef Remediation Cookbook</span></a>
              
              <a href="https://github.com/hardening-io/puppet-nginx-hardening" class="button"><i class="icon-github-circled"></i><span>Puppet Remediation Module</span></a>
              
            </div>
        </div>
    </div>
</div>


<noscript>Please enable JavaScript to view this website.</noscript>

<script>(function(a){function b(a){return q.typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?b=function(a){return typeof a}:b=function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},b(a)}function c(a){function b(d,e){try{var f=a[d](e),g=f.value,h=g instanceof q.AwaitValue;Promise.resolve(h?g.wrapped:g).then(function(a){return h?void b("next",a):void c(f.done?"return":"normal",a)},function(a){b("throw",a)})}catch(a){c("throw",a)}}function c(a,c){switch(a){case"return":d.resolve({value:c,done:!0});break;case"throw":d.reject(c);break;default:d.resolve({value:c,done:!1});}d=d.next,d?b(d.key,d.arg):e=null}var d,e;this._invoke=function(a,c){return new Promise(function(f,g){var h={key:a,arg:c,resolve:f,reject:g,next:null};e?e=e.next=h:(d=e=h,b(a,c))})},"function"!==typeof a.return&&(this.return=void 0)}function d(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function e(a,b){for(var c in b){var d=b[c];d.configurable=d.enumerable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,c,d)}if(Object.getOwnPropertySymbols)for(var e=Object.getOwnPropertySymbols(b),f=0;f<e.length;f++){var g=e[f],d=b[g];d.configurable=d.enumerable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,g,d)}return a}function f(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function g(){return q.extends=g=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},g.apply(this,arguments)}function h(a){return q.getPrototypeOf=h=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},h(a)}function i(a,b){return q.setPrototypeOf=i=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},i(a,b)}function j(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function k(){return q.construct=j()?k=Reflect.construct:k=function(b,c,d){var e=[null];e.push.apply(e,c);var a=Function.bind.apply(b,e),f=new a;return d&&q.setPrototypeOf(f,d.prototype),f},k.apply(null,arguments)}function l(a){var b="function"===typeof Map?new Map:void 0;return q.wrapNativeSuper=l=function(a){function c(){return q.construct(a,arguments,q.getPrototypeOf(this).constructor)}if(null===a)return null;if("function"!==typeof a)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof b){if(b.has(a))return b.get(a);b.set(a,c)}return c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),q.setPrototypeOf(c,a)},l(a)}function m(a,b,c){return q.get="undefined"!==typeof Reflect&&Reflect.get?m=Reflect.get:m=function(a,b,c){var d=q.superPropBase(a,b);if(d){var e=Object.getOwnPropertyDescriptor(d,b);return e.get?e.get.call(c):e.value}},m(a,b,c||a)}function n(a,b,c,d){return n="undefined"!==typeof Reflect&&Reflect.set?Reflect.set:function(a,b,c,d){var e,f=q.superPropBase(a,b);if(f){if(e=Object.getOwnPropertyDescriptor(f,b),e.set)return e.set.call(d,c),!0;if(!e.writable)return!1}if(e=Object.getOwnPropertyDescriptor(d,b),e){if(!e.writable)return!1;e.value=c,Object.defineProperty(d,b,e)}else q.defineProperty(d,b,c);return!0},n(a,b,c,d)}function o(a,b,c,d,e){var f=n(a,b,c,d||a);if(!f&&e)throw new Error("failed to set property");return c}function p(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}var q=a.babelHelpers={};q.typeof=b,q.asyncIterator=function(a){var b;if("function"===typeof Symbol){if(Symbol.asyncIterator&&(b=a[Symbol.asyncIterator],null!=b))return b.call(a);if(Symbol.iterator&&(b=a[Symbol.iterator],null!=b))return b.call(a)}throw new TypeError("Object is not async iterable")},q.AwaitValue=function(a){this.wrapped=a},"function"===typeof Symbol&&Symbol.asyncIterator&&(c.prototype[Symbol.asyncIterator]=function(){return this}),c.prototype.next=function(a){return this._invoke("next",a)},c.prototype.throw=function(a){return this._invoke("throw",a)},c.prototype.return=function(a){return this._invoke("return",a)},q.AsyncGenerator=c,q.wrapAsyncGenerator=function(a){return function(){return new q.AsyncGenerator(a.apply(this,arguments))}},q.awaitAsyncGenerator=function(a){return new q.AwaitValue(a)},q.asyncGeneratorDelegate=function(a,b){function c(c,d){return e=!0,d=new Promise(function(b){b(a[c](d))}),{done:!1,value:b(d)}}var d={},e=!1;return"function"===typeof Symbol&&Symbol.iterator&&(d[Symbol.iterator]=function(){return this}),d.next=function(a){return e?(e=!1,a):c("next",a)},"function"===typeof a.throw&&(d.throw=function(a){if(e)throw e=!1,a;return c("throw",a)}),"function"===typeof a.return&&(d.return=function(a){return c("return",a)}),d},q.asyncToGenerator=function(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){function f(a,b){try{var c=i[a](b),f=c.value}catch(a){return void e(a)}c.done?d(f):Promise.resolve(f).then(g,h)}function g(a){f("next",a)}function h(a){f("throw",a)}var i=a.apply(b,c);g()})}},q.classCallCheck=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},q.createClass=function(a,b,c){return b&&d(a.prototype,b),c&&d(a,c),a},q.defineEnumerableProperties=e,q.defaults=function(a,b){for(var c=Object.getOwnPropertyNames(b),d=0;d<c.length;d++){var e=c[d],f=Object.getOwnPropertyDescriptor(b,e);f&&f.configurable&&a[e]===void 0&&Object.defineProperty(a,e,f)}return a},q.defineProperty=f,q.extends=g,q.objectSpread=function(a){for(var b=1;b<arguments.length;b++){var c=null==arguments[b]?{}:arguments[b],d=Object.keys(c);"function"===typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){q.defineProperty(a,b,c[b])})}return a},q.inherits=function(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&q.setPrototypeOf(a,b)},q.getPrototypeOf=h,q.setPrototypeOf=i,q.construct=k,q.wrapNativeSuper=l,q.instanceof=function(a,b){return null!=b&&"undefined"!==typeof Symbol&&b[Symbol.hasInstance]?b[Symbol.hasInstance](a):a instanceof b},q.interopRequireDefault=function(a){return a&&a.__esModule?a:{default:a}},q.interopRequireWildcard=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b},q.newArrowCheck=function(a,b){if(a!==b)throw new TypeError("Cannot instantiate an arrow function")},q.objectDestructuringEmpty=function(a){if(null==a)throw new TypeError("Cannot destructure undefined")},q.objectWithoutProperties=function(a,b){if(null==a)return{};var c,d,e={},f=Object.keys(a);for(d=0;d<f.length;d++)c=f[d],0<=b.indexOf(c)||(e[c]=a[c]);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(a);for(d=0;d<g.length;d++)c=g[d],!(0<=b.indexOf(c))&&Object.prototype.propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e},q.assertThisInitialized=function(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a},q.possibleConstructorReturn=function(a,b){return b&&("object"===typeof b||"function"===typeof b)?b:q.assertThisInitialized(a)},q.superPropBase=function(a,b){for(;!Object.prototype.hasOwnProperty.call(a,b)&&(a=q.getPrototypeOf(a),null!==a););return a},q.get=m,q.set=o,q.taggedTemplateLiteral=function(a,b){return b||(b=a.slice(0)),Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(b)}}))},q.temporalRef=function(a,b){if(a===q.temporalUndefined)throw new ReferenceError(b+" is not defined - temporal dead zone");else return a},q.readOnlyError=function(a){throw new Error("\""+a+"\" is read-only")},q.temporalUndefined={},q.slicedToArray=function(a,b){return q.arrayWithHoles(a)||q.iterableToArrayLimit(a,b)||q.nonIterableRest()},q.toArray=function(a){return q.arrayWithHoles(a)||q.iterableToArray(a)||q.nonIterableRest()},q.toConsumableArray=function(a){return q.arrayWithoutHoles(a)||q.iterableToArray(a)||q.nonIterableSpread()},q.arrayWithoutHoles=function(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}},q.arrayWithHoles=function(a){if(Array.isArray(a))return a},q.iterableToArray=p,q.iterableToArrayLimit=function(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c},q.nonIterableSpread=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")},q.nonIterableRest=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")},q.toPropertyKey=function(a){return"symbol"===typeof a?a:a+""}})("undefined"===typeof global?self:global);</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>
<script src="/node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>
<script>"use strict";(function(){function a(a,b,c){var d=a;if(d.state=b,d.stateData=c,0<d.onNextStateChange.length){var e=d.onNextStateChange.slice();d.onNextStateChange.length=0;for(var f,g=0,h=e;g<h.length;g++)f=h[g],f()}return d}function b(b){function d(){try{document.head.removeChild(f)}catch(a){}}var e=a(b,"Loading",void 0),f=document.createElement("script");return f.src=b.url,f.onload=function(){var a,b;void 0===r?(a=[],b=void 0):(f=r(),a=f[0],b=f[1]),c(e,a,b),d();var f},f.onerror=function(){g(b,new TypeError("Failed to fetch "+b.url)),d()},document.head.appendChild(f),e}function c(b,c,e){var f=d(b,c),g=f[0],h=f[1];return a(b,"WaitingForTurn",{args:g,deps:h,moduleBody:e})}function d(a,c){for(var e,f=[],g=[],i=0,j=c;i<j.length;i++){if(e=j[i],"exports"===e){f.push(a.exports);continue}if("require"===e){f.push(function(b,c,e){var f=d(a,b),g=f[0],i=f[1];h(i,function(){c&&c.apply(null,g)},e)});continue}if("meta"===e){f.push({url:!0===a.isTopLevel?a.url.substring(0,a.url.lastIndexOf("#")):a.url});continue}var l=k(n(a.urlBase,e));f.push(l.exports),g.push(l),"Initialized"===l.state&&b(l)}return[f,g]}function e(b){var c=a(b,"WaitingOnDeps",b.stateData);return h(b.stateData.deps,function(){return f(c)},function(a){return g(c,a)}),c}function f(b){var c=b.stateData;if(null!=c.moduleBody)try{c.moduleBody.apply(null,c.args)}catch(a){return g(b,a)}return a(b,"Executed",void 0)}function g(b,c){return!0===b.isTopLevel&&setTimeout(function(){throw c}),a(b,"Failed",c)}function h(a,b,c){var d=a.shift();return void 0===d?void(b&&b()):"WaitingOnDeps"===d.state?(!1,void h(a,b,c)):void i(d,function(){h(a,b,c)},c)}function i(a,b,c){switch(a.state){case"WaitingForTurn":return e(a),void i(a,b,c);case"Failed":return void(c&&c(a.stateData));case"Executed":return void b();case"Loading":case"WaitingOnDeps":return void a.onNextStateChange.push(function(){return i(a,b,c)});case"Initialized":throw new Error("All dependencies should be loading already before pressureDependencyToExecute is called.");default:throw new Error("Impossible module state: "+a.state);}}function j(a,b){switch(a.state){case"Executed":case"Failed":return void b();default:a.onNextStateChange.push(function(){return j(a,b)});}}function k(a){var b=q[a];return void 0===b&&(b=q[a]={url:a,urlBase:m(a),exports:Object.create(null),state:"Initialized",stateData:void 0,isTopLevel:!1,onNextStateChange:[]}),b}function l(a){return v.href=a,v.href}function m(a){return a=a.split("?")[0],a=a.split("#")[0],a.substring(0,a.lastIndexOf("/")+1)}function n(a,b){return-1===b.indexOf("://")?l(a+b):b}function o(){return document.baseURI||(document.querySelector("base")||window.location).href}function p(){var b=document.currentScript;if(!b)return u;if(window.HTMLImports){var c=window.HTMLImports.importForElement(b);return c?c.href:u}var d=b.ownerDocument.createElement("a");return d.href="",d.href}if(!window.define){var q=Object.create(null),r=void 0,s=0,t=void 0,u=o();window.define=function(a,b){var d=!1;r=function(){return d=!0,r=void 0,[a,b]};var f=p();setTimeout(function(){if(!1==d){r=void 0;var g=f+"#"+s++,h=k(g);h.isTopLevel=!0;var i=c(h,a,b);void 0===t?e(i):j(k(t),function(){e(i)}),t=g}},0)},window.define._reset=function(){for(var a in q)delete q[a];r=void 0,s=0,t=void 0,u=o()};var v=document.createElement("a")}})();</script>
<script>
  requirejs(["/components/inspec-profile.js"]);
</script>

<div style="max-width: 800px; margin: auto;" class="profile">
  <inspec-profile></inspec-profile>
</div>
<script>
  window.profile = document.getElementsByTagName("inspec-profile")[0];
  profile.profile = {"controls":[{"code":"control 'nginx-01' do\n  impact 1.0\n  title 'Running worker process as non-privileged user'\n  desc 'The NGINX worker processes should run as non-privileged user. In case of compromise of the process, an attacker has full access to the system.'\n  describe user(nginx_lib.valid_users) do\n    it { should exist }\n  end\n  describe parse_config_file(nginx_conf, options) do\n    its('user') { should eq nginx_lib.valid_users }\n  end\n\n  describe parse_config_file(nginx_conf, options) do\n    its('group') { should_not eq 'root' }\n  end\nend\n","desc":"The NGINX worker processes should run as non-privileged user. In case of compromise of the process, an attacker has full access to the system.","descriptions":{"default":"The NGINX worker processes should run as non-privileged user. In case of compromise of the process, an attacker has full access to the system."},"id":"nginx-01","impact":1,"refs":[],"source_location":{"line":108,"ref":"../nginx-baseline/controls/nginx_spec.rb"},"tags":{},"title":"Running worker process as non-privileged user"},{"code":"control 'nginx-02' do\n  impact 1.0\n  title 'Check NGINX config file owner, group and permissions.'\n  desc 'The NGINX config file should owned by root, only be writable by owner and not write- and readable by others.'\n  describe file(nginx_conf) do\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n    it { should_not be_readable.by('others') }\n    it { should_not be_writable.by('others') }\n    it { should_not be_executable.by('others') }\n  end\nend\n","desc":"The NGINX config file should owned by root, only be writable by owner and not write- and readable by others.","descriptions":{"default":"The NGINX config file should owned by root, only be writable by owner and not write- and readable by others."},"id":"nginx-02","impact":1,"refs":[],"source_location":{"line":124,"ref":"../nginx-baseline/controls/nginx_spec.rb"},"tags":{},"title":"Check NGINX config file owner, group and permissions."},{"code":"control 'nginx-03' do\n  impact 1.0\n  title 'Nginx default files'\n  desc 'Remove the default nginx config files.'\n  describe file(File.join(nginx_confd, 'default.conf')) do\n    it { should_not be_file }\n  end\n\n  describe file(File.join(nginx_enabled, 'default')) do\n    it { should_not be_file }\n  end\nend\n","desc":"Remove the default nginx config files.","descriptions":{"default":"Remove the default nginx config files."},"id":"nginx-03","impact":1,"refs":[],"source_location":{"line":137,"ref":"../nginx-baseline/controls/nginx_spec.rb"},"tags":{},"title":"Nginx default files"},{"code":"control 'nginx-04' do\n  impact 1.0\n  title 'Check for multiple instances'\n  desc 'Different instances of the nginx webserver should run in separate environments'\n  describe command('ps aux | egrep \"nginx: master\" | egrep -v \"grep\" | wc -l') do\n    its(:stdout) { should match(/^1$/) }\n  end\nend\n","desc":"Different instances of the nginx webserver should run in separate environments","descriptions":{"default":"Different instances of the nginx webserver should run in separate environments"},"id":"nginx-04","impact":1,"refs":[],"source_location":{"line":150,"ref":"../nginx-baseline/controls/nginx_spec.rb"},"tags":{},"title":"Check for multiple instances"},{"code":"control 'nginx-05' do\n  impact 1.0\n  title 'Disable server_tokens directive'\n  desc 'Disables emitting nginx version in error messages and in the “Server” response header field.'\n  describe parse_config(nginx_parsed_config, options) do\n    its('server_tokens') { should eq 'off' }\n  end\nend\n","desc":"Disables emitting nginx version in error messages and in the “Server” response header field.","descriptions":{"default":"Disables emitting nginx version in error messages and in the “Server” response header field."},"id":"nginx-05","impact":1,"refs":[],"source_location":{"line":159,"ref":"../nginx-baseline/controls/nginx_spec.rb"},"tags":{},"title":"Disable server_tokens directive"},{"code":"control 'nginx-06' do\n  impact 1.0\n  title 'Prevent buffer overflow attacks'\n  desc 'Buffer overflow attacks are made possible by writing data to a buffer and exceeding that buffer boundary and overwriting memory fragments of a process. To prevent this in nginx we can set buffer size limitations for all clients.'\n  describe parse_config(nginx_parsed_config, options) do\n    its('client_body_buffer_size') { should eq CLIENT_BODY_BUFFER_SIZE }\n  end\n  describe parse_config(nginx_parsed_config, options) do\n    its('client_max_body_size') { should eq CLIENT_MAX_BODY_SIZE }\n  end\n  describe parse_config(nginx_parsed_config, options) do\n    its('client_header_buffer_size') { should eq CLIENT_HEADER_BUFFER_SIZE }\n  end\n  describe parse_config(nginx_parsed_config, options) do\n    its('large_client_header_buffers') { should eq LARGE_CLIENT_HEADER_BUFFER }\n  end\nend\n","desc":"Buffer overflow attacks are made possible by writing data to a buffer and exceeding that buffer boundary and overwriting memory fragments of a process. To prevent this in nginx we can set buffer size limitations for all clients.","descriptions":{"default":"Buffer overflow attacks are made possible by writing data to a buffer and exceeding that buffer boundary and overwriting memory fragments of a process. To prevent this in nginx we can set buffer size limitations for all clients."},"id":"nginx-06","impact":1,"refs":[],"source_location":{"line":168,"ref":"../nginx-baseline/controls/nginx_spec.rb"},"tags":{},"title":"Prevent buffer overflow attacks"},{"code":"control 'nginx-07' do\n  impact 1.0\n  title 'Control simultaneous connections'\n  desc 'NginxHttpLimitZone module to limit the number of simultaneous connections for the assigned session or as a special case, from one IP address.'\n  describe parse_config(nginx_parsed_config, options) do\n    its('limit_conn_zone') { should eq '$binary_remote_addr zone=default:10m' }\n  end\n  describe parse_config(nginx_parsed_config, options) do\n    its('limit_conn') { should eq 'default 5' }\n  end\nend\n","desc":"NginxHttpLimitZone module to limit the number of simultaneous connections for the assigned session or as a special case, from one IP address.","descriptions":{"default":"NginxHttpLimitZone module to limit the number of simultaneous connections for the assigned session or as a special case, from one IP address."},"id":"nginx-07","impact":1,"refs":[],"source_location":{"line":186,"ref":"../nginx-baseline/controls/nginx_spec.rb"},"tags":{},"title":"Control simultaneous connections"},{"code":"control 'nginx-08' do\n  impact 1.0\n  title 'Prevent clickjacking'\n  desc 'Do not allow the browser to render the page inside an frame or iframe.'\n  describe parse_config(nginx_parsed_config, options_add_header) do\n    its('add_header') { should include 'X-Frame-Options SAMEORIGIN' }\n  end\nend\n","desc":"Do not allow the browser to render the page inside an frame or iframe.","descriptions":{"default":"Do not allow the browser to render the page inside an frame or iframe."},"id":"nginx-08","impact":1,"refs":[],"source_location":{"line":198,"ref":"../nginx-baseline/controls/nginx_spec.rb"},"tags":{},"title":"Prevent clickjacking"},{"code":"control 'nginx-09' do\n  impact 1.0\n  title 'Enable Cross-site scripting filter'\n  desc 'This header is used to configure the built in reflective XSS protection. This tells the browser to block the response if it detects an attack rather than sanitising the script.'\n  describe parse_config(nginx_parsed_config, options_add_header) do\n    its('add_header') { should include 'X-XSS-Protection \"1; mode=block\"' }\n  end\nend\n","desc":"This header is used to configure the built in reflective XSS protection. This tells the browser to block the response if it detects an attack rather than sanitising the script.","descriptions":{"default":"This header is used to configure the built in reflective XSS protection. This tells the browser to block the response if it detects an attack rather than sanitising the script."},"id":"nginx-09","impact":1,"refs":[],"source_location":{"line":207,"ref":"../nginx-baseline/controls/nginx_spec.rb"},"tags":{},"title":"Enable Cross-site scripting filter"},{"code":"control 'nginx-10' do\n  impact 1.0\n  title 'Disable content-type sniffing'\n  desc 'It prevents browser from trying to mime-sniff the content-type of a response away from the one being declared by the server. It reduces exposure to drive-by downloads and the risks of user uploaded content that, with clever naming, could be treated as a different content-type, like an executable.'\n  describe parse_config(nginx_parsed_config, options_add_header) do\n    its('add_header') { should include 'X-Content-Type-Options nosniff' }\n  end\nend\n","desc":"It prevents browser from trying to mime-sniff the content-type of a response away from the one being declared by the server. It reduces exposure to drive-by downloads and the risks of user uploaded content that, with clever naming, could be treated as a different content-type, like an executable.","descriptions":{"default":"It prevents browser from trying to mime-sniff the content-type of a response away from the one being declared by the server. It reduces exposure to drive-by downloads and the risks of user uploaded content that, with clever naming, could be treated as a different content-type, like an executable."},"id":"nginx-10","impact":1,"refs":[],"source_location":{"line":216,"ref":"../nginx-baseline/controls/nginx_spec.rb"},"tags":{},"title":"Disable content-type sniffing"},{"code":"control 'nginx-12' do\n  impact 1.0\n  title 'TLS Protocols'\n  desc 'When choosing a cipher during an SSLv3 or TLSv1 handshake, normally the client\\'s preference is used. If this directive is enabled, the server\\'s preference will be used instead.'\n  ref 'SSL Hardening config', url: 'https://mozilla.github.io/server-side-tls/ssl-config-generator/'\n  describe parse_config(nginx_parsed_config, options) do\n    its('ssl_protocols') { should eq 'TLSv1.2' }\n    its('ssl_session_tickets') { should eq 'off' }\n    its('ssl_ciphers') { should eq '\\'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256\\'' }\n    its('ssl_prefer_server_ciphers') { should eq 'on' }\n    its('ssl_dhparam') { should eq '/etc/nginx/dh2048.pem' }\n  end\nend\n","desc":"When choosing a cipher during an SSLv3 or TLSv1 handshake, normally the client's preference is used. If this directive is enabled, the server's preference will be used instead.","descriptions":{"default":"When choosing a cipher during an SSLv3 or TLSv1 handshake, normally the client's preference is used. If this directive is enabled, the server's preference will be used instead."},"id":"nginx-12","impact":1,"refs":[{"ref":"SSL Hardening config","url":"https://mozilla.github.io/server-side-tls/ssl-config-generator/"}],"source_location":{"line":225,"ref":"../nginx-baseline/controls/nginx_spec.rb"},"tags":{},"title":"TLS Protocols"},{"code":"control 'nginx-13' do\n  impact 1.0\n  title 'Add HSTS Header'\n  desc 'HTTP Strict Transport Security (HSTS) is a web security policy mechanism which helps to protect websites against protocol downgrade attacks and cookie hijacking. It allows web servers to declare that web browsers (or other complying user agents) should only interact with it using secure HTTPS connections, and never via the insecure HTTP protocol. HSTS is an IETF standards track protocol and is specified in RFC 6797.'\n  describe parse_config(nginx_parsed_config, options_add_header) do\n    its('add_header') { should include 'Strict-Transport-Security max-age=15768000' }\n  end\nend\n","desc":"HTTP Strict Transport Security (HSTS) is a web security policy mechanism which helps to protect websites against protocol downgrade attacks and cookie hijacking. It allows web servers to declare that web browsers (or other complying user agents) should only interact with it using secure HTTPS connections, and never via the insecure HTTP protocol. HSTS is an IETF standards track protocol and is specified in RFC 6797.","descriptions":{"default":"HTTP Strict Transport Security (HSTS) is a web security policy mechanism which helps to protect websites against protocol downgrade attacks and cookie hijacking. It allows web servers to declare that web browsers (or other complying user agents) should only interact with it using secure HTTPS connections, and never via the insecure HTTP protocol. HSTS is an IETF standards track protocol and is specified in RFC 6797."},"id":"nginx-13","impact":1,"refs":[],"source_location":{"line":239,"ref":"../nginx-baseline/controls/nginx_spec.rb"},"tags":{},"title":"Add HSTS Header"},{"code":"control 'nginx-14' do\n  impact 1.0\n  title 'Disable insecure HTTP-methods'\n  desc 'Disable insecure HTTP-methods and allow only necessary methods.'\n  ref 'OWASP HTTP Methods', url: 'https://www.owasp.org/index.php/Test_HTTP_Methods_(OTG-CONFIG-006)'\n\n  only_if { HTTP_METHODS_CHECK != false }\n  describe file(nginx_conf) do\n    its('content') { should match(/^\\s*if\\s+\\(\\$request_method\\s+\\!\\~\\s+\\^\\(#{HTTP_METHODS}\\)\\$\\)\\{?$/) }\n  end\nend\n","desc":"Disable insecure HTTP-methods and allow only necessary methods.","descriptions":{"default":"Disable insecure HTTP-methods and allow only necessary methods."},"id":"nginx-14","impact":1,"refs":[{"ref":"OWASP HTTP Methods","url":"https://www.owasp.org/index.php/Test_HTTP_Methods_(OTG-CONFIG-006)"}],"source_location":{"line":248,"ref":"../nginx-baseline/controls/nginx_spec.rb"},"tags":{},"title":"Disable insecure HTTP-methods"},{"code":"control 'nginx-15' do\n  impact 1.0\n  title 'Content-Security-Policy'\n  desc 'The Content-Security-Policy HTTP response header helps you reduce XSS risks on modern browsers by declaring what dynamic resources are allowed to load via a HTTP Header'\n  describe parse_config(nginx_parsed_config, options_add_header) do\n    its('add_header') { should include 'Content-Security-Policy \"script-src \\'self\\'; object-src \\'self\\'\"' }\n  end\nend\n","desc":"The Content-Security-Policy HTTP response header helps you reduce XSS risks on modern browsers by declaring what dynamic resources are allowed to load via a HTTP Header","descriptions":{"default":"The Content-Security-Policy HTTP response header helps you reduce XSS risks on modern browsers by declaring what dynamic resources are allowed to load via a HTTP Header"},"id":"nginx-15","impact":1,"refs":[],"source_location":{"line":260,"ref":"../nginx-baseline/controls/nginx_spec.rb"},"tags":{},"title":"Content-Security-Policy"},{"code":"control 'nginx-16' do\n  impact 1.0\n  title 'Set cookie with HttpOnly and Secure flag'\n  desc 'You can mitigate most of the common Cross Site Scripting attack using HttpOnly and Secure flag in a cookie. Without having HttpOnly and Secure, it is possible to steal or manipulate web application session and cookies and it’s dangerous.'\n  only_if { NGINX_COOKIE_FLAG_MODULE != false }\n  describe parse_config(nginx_parsed_config, options_add_header) do\n    its('set_cookie_flag') { should include '* HttpOnly secure' }\n  end\nend\n","desc":"You can mitigate most of the common Cross Site Scripting attack using HttpOnly and Secure flag in a cookie. Without having HttpOnly and Secure, it is possible to steal or manipulate web application session and cookies and it’s dangerous.","descriptions":{"default":"You can mitigate most of the common Cross Site Scripting attack using HttpOnly and Secure flag in a cookie. Without having HttpOnly and Secure, it is possible to steal or manipulate web application session and cookies and it’s dangerous."},"id":"nginx-16","impact":1,"refs":[],"source_location":{"line":269,"ref":"../nginx-baseline/controls/nginx_spec.rb"},"tags":{},"title":"Set cookie with HttpOnly and Secure flag"},{"code":"control 'nginx-17' do\n  impact 1.0\n  title 'Control timeouts to improve performance'\n  desc 'Control timeouts to improve server performance and cut clients.'\n  describe parse_config(nginx_parsed_config, options) do\n    its('keepalive_timeout') { should eq KEEPALIVE_TIMEOUT }\n  end\n  describe parse_config(nginx_parsed_config, options) do\n    its('client_body_timeout') { should eq CLIENT_BODY_TIMEOUT }\n  end\n  describe parse_config(nginx_parsed_config, options) do\n    its('client_header_timeout') { should eq CLIENT_HEADER_TIMEOUT }\n  end\n  describe parse_config(nginx_parsed_config, options) do\n    its('send_timeout') { should eq SEND_TIMEOUT }\n  end\nend\n","desc":"Control timeouts to improve server performance and cut clients.","descriptions":{"default":"Control timeouts to improve server performance and cut clients."},"id":"nginx-17","impact":1,"refs":[],"source_location":{"line":279,"ref":"../nginx-baseline/controls/nginx_spec.rb"},"tags":{},"title":"Control timeouts to improve performance"}],"copyright":"DevSec Hardening Framework Team","copyright_email":"hello@dev-sec.io","generator":{"name":"inspec","version":"3.9.3"},"groups":[{"controls":["nginx-01","nginx-02","nginx-03","nginx-04","nginx-05","nginx-06","nginx-07","nginx-08","nginx-09","nginx-10","nginx-12","nginx-13","nginx-14","nginx-15","nginx-16","nginx-17"],"id":"controls/nginx_spec.rb","title":"NGINX server config"}],"inputs":[{"name":"client_max_body_size","options":{"description":"Sets the maximum allowed size of the client request body, specified in the “Content-Length” request header field. If the size in a request exceeds the configured value, the 413 (Request Entity Too Large) error is returned to the client. Please be aware that browsers cannot correctly display this error. Setting size to 0 disables checking of client request body size.","value":"1k"}},{"name":"client_body_buffer_size","options":{"description":"Sets buffer size for reading client request body. In case the request body is larger than the buffer, the whole body or only its part is written to a temporary file. By default, buffer size is equal to two memory pages. This is 8K on x86, other 32-bit platforms, and x86-64. It is usually 16K on other 64-bit platforms.","value":"1k"}},{"name":"client_header_buffer_size","options":{"description":"Sets buffer size for reading client request header. For most requests, a buffer of 1K bytes is enough. However, if a request includes long cookies, or comes from a WAP client, it may not fit into 1K. If a request line or a request header field does not fit into this buffer then larger buffers, configured by the large_client_header_buffers directive, are allocated.","value":"1k"}},{"name":"large_client_header_buffers","options":{"description":"Sets the maximum number and size of buffers used for reading large client request header. A request line cannot exceed the size of one buffer, or the 414 (Request-URI Too Large) error is returned to the client. A request header field cannot exceed the size of one buffer as well, or the 400 (Bad Request) error is returned to the client. Buffers are allocated only on demand. By default, the buffer size is equal to 8K bytes. If after the end of request processing a connection is transitioned into the keep-alive state, these buffers are released.","value":"2 1k"}},{"name":"keepalive_timeout","options":{"description":"The first parameter sets a timeout during which a keep-alive client connection will stay open on the server side. The zero value disables keep-alive client connections. The optional second parameter sets a value in the “Keep-Alive: timeout=time” response header field. Two parameters may differ.","value":"5 5"}},{"name":"client_body_timeout","options":{"description":"Defines a timeout for reading client request body. The timeout is set only for a period between two successive read operations, not for the transmission of the whole request body. If a client does not transmit anything within this time, the 408 (Request Time-out) error is returned to the client.","value":"10"}},{"name":"client_header_timeout","options":{"description":"Defines a timeout for reading client request header. If a client does not transmit the entire header within this time, the 408 (Request Time-out) error is returned to the client.","value":"10"}},{"name":"send_timeout","options":{"description":"Sets a timeout for transmitting a response to the client. The timeout is set only between two successive write operations, not for the transmission of the whole response. If the client does not receive anything within this time, the connection is closed.","value":"10"}},{"name":"http_methods","options":{"description":"Specify the used HTTP methods","value":"GET\\|HEAD\\|POST"}},{"name":"http_methods_check","options":{"description":"Defines if http_methods should be checked in the nginx configuration","value":false}},{"name":"nginx_cookie_flag_module","options":{"description":"Defines if nginx has been compiled with nginx_cookie_flag_module","value":false}}],"license":"Apache-2.0","maintainer":"DevSec Hardening Framework Team","name":"nginx-baseline","sha256":"30fda8ac65b3129c8522ab53bbca67b3d2243321819225ab2dd16d2c45bff06a","status":"loaded","summary":"Test-suite for best-practice nginx hardening","supports":[{"platform-family":"unix"}],"title":"DevSec Nginx Baseline","version":"2.3.0"}
</script>


    
    
    

    
    <footer>
      <ul>
  <li><a href="/legal">Legal notice</a></li>
  <li><a href="/contributing">Contributing</a></li>
  <li><a href="https://twitter.com/devsecio">Twitter</a></li>
  <li><a href="https://galaxy.ansible.com/devsec/hardening">Ansible Galaxy</a></li>
  <li><a href="https://supermarket.getchef.com/cookbooks?q=hardening">Chef Community</a></li>
  <li><a href="https://forge.puppetlabs.com/hardening">Puppet Forge</a></li>
</ul>

    </footer>
    

    <script src="/jquery/dist/jquery.min.js"></script>
    <script src="/foundation/js/foundation/foundation.js"></script>
    <script src="/foundation/js/foundation/foundation.equalizer.js"></script>
    <script src="/foundation/js/foundation/foundation.topbar.js"></script>

    <script src="/js/app.js"></script>

    <script type="text/javascript">
    var $buoop = {vs:{i:9,f:15,o:12.1,s:5.1}};
    $buoop.ol = window.onload;
    window.onload=function(){
      console.log($buoop);
      try {if ($buoop.ol) $buoop.ol();}catch (e) {}
      var e = document.createElement("script");
      e.setAttribute("type", "text/javascript");
      e.setAttribute("src", "//browser-update.org/update.js");
      document.body.appendChild(e);
    }

    </script>
  </body>
</html>
