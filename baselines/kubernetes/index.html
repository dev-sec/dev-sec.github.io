<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title> DevSec Kubernetes Baseline â€“ DevSec Hardening Framework </title>

    <link rel="stylesheet" href="/css/app.css" />
    <link rel="stylesheet" href="/css/github_buttons.css" />

    <link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300' rel='stylesheet' type='text/css'>
  </head>
  <body>

    
    <nav class="top-bar" data-topbar role="navigation">
  <ul class="title-area">
    <li class="name">
      <h1>
        <a href="/" id="nav-logo">
          <img src="/images/hardening_logo.png" style="width: 45px;"/>
          DevSec Hardening Framework
        </a>
      </h1>

    </li>
     
    <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
  </ul>

  <section class="top-bar-section">
    <ul class="right">
      
        <li>
          <a href="/project/">
            About
          </a>
        </li>
      
        <li>
          <a href="/baselines/">
            Baselines
          </a>
        </li>
      
        <li>
          <a href="/videos/">
            Videos
          </a>
        </li>
      
        <li>
          <a href="/community/">
            Community
          </a>
        </li>
      
        <li>
          <a href="/blog/">
            News
          </a>
        </li>
      
        <li>
          <a href="https://github.com/dev-sec">
            GitHub
          </a>
        </li>
      
    </ul>
  </section>
</nav>

    

    
    
    

<div id="kubernetes-baseline" class="section baseline-links">
    <div class="row">
        <div class="inner">
            <div class="row center links">
              
              <a href="https://github.com/dev-sec/cis-kubernetes-benchmark" class="button"><i class="icon-github-circled"></i><span>InSpec Profile</span></a>
              
            </div>
        </div>
    </div>
</div>


<noscript>Please enable JavaScript to view this website.</noscript>

<script>(function(a){function b(a){return q.typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?b=function(a){return typeof a}:b=function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},b(a)}function c(a){function b(d,e){try{var f=a[d](e),g=f.value,h=g instanceof q.AwaitValue;Promise.resolve(h?g.wrapped:g).then(function(a){return h?void b("next",a):void c(f.done?"return":"normal",a)},function(a){b("throw",a)})}catch(a){c("throw",a)}}function c(a,c){switch(a){case"return":d.resolve({value:c,done:!0});break;case"throw":d.reject(c);break;default:d.resolve({value:c,done:!1});}d=d.next,d?b(d.key,d.arg):e=null}var d,e;this._invoke=function(a,c){return new Promise(function(f,g){var h={key:a,arg:c,resolve:f,reject:g,next:null};e?e=e.next=h:(d=e=h,b(a,c))})},"function"!==typeof a.return&&(this.return=void 0)}function d(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function e(a,b){for(var c in b){var d=b[c];d.configurable=d.enumerable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,c,d)}if(Object.getOwnPropertySymbols)for(var e=Object.getOwnPropertySymbols(b),f=0;f<e.length;f++){var g=e[f],d=b[g];d.configurable=d.enumerable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,g,d)}return a}function f(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function g(){return q.extends=g=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},g.apply(this,arguments)}function h(a){return q.getPrototypeOf=h=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},h(a)}function i(a,b){return q.setPrototypeOf=i=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},i(a,b)}function j(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function k(){return q.construct=j()?k=Reflect.construct:k=function(b,c,d){var e=[null];e.push.apply(e,c);var a=Function.bind.apply(b,e),f=new a;return d&&q.setPrototypeOf(f,d.prototype),f},k.apply(null,arguments)}function l(a){var b="function"===typeof Map?new Map:void 0;return q.wrapNativeSuper=l=function(a){function c(){return q.construct(a,arguments,q.getPrototypeOf(this).constructor)}if(null===a)return null;if("function"!==typeof a)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof b){if(b.has(a))return b.get(a);b.set(a,c)}return c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),q.setPrototypeOf(c,a)},l(a)}function m(a,b,c){return q.get="undefined"!==typeof Reflect&&Reflect.get?m=Reflect.get:m=function(a,b,c){var d=q.superPropBase(a,b);if(d){var e=Object.getOwnPropertyDescriptor(d,b);return e.get?e.get.call(c):e.value}},m(a,b,c||a)}function n(a,b,c,d){return n="undefined"!==typeof Reflect&&Reflect.set?Reflect.set:function(a,b,c,d){var e,f=q.superPropBase(a,b);if(f){if(e=Object.getOwnPropertyDescriptor(f,b),e.set)return e.set.call(d,c),!0;if(!e.writable)return!1}if(e=Object.getOwnPropertyDescriptor(d,b),e){if(!e.writable)return!1;e.value=c,Object.defineProperty(d,b,e)}else q.defineProperty(d,b,c);return!0},n(a,b,c,d)}function o(a,b,c,d,e){var f=n(a,b,c,d||a);if(!f&&e)throw new Error("failed to set property");return c}function p(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}var q=a.babelHelpers={};q.typeof=b,q.asyncIterator=function(a){var b;if("function"===typeof Symbol){if(Symbol.asyncIterator&&(b=a[Symbol.asyncIterator],null!=b))return b.call(a);if(Symbol.iterator&&(b=a[Symbol.iterator],null!=b))return b.call(a)}throw new TypeError("Object is not async iterable")},q.AwaitValue=function(a){this.wrapped=a},"function"===typeof Symbol&&Symbol.asyncIterator&&(c.prototype[Symbol.asyncIterator]=function(){return this}),c.prototype.next=function(a){return this._invoke("next",a)},c.prototype.throw=function(a){return this._invoke("throw",a)},c.prototype.return=function(a){return this._invoke("return",a)},q.AsyncGenerator=c,q.wrapAsyncGenerator=function(a){return function(){return new q.AsyncGenerator(a.apply(this,arguments))}},q.awaitAsyncGenerator=function(a){return new q.AwaitValue(a)},q.asyncGeneratorDelegate=function(a,b){function c(c,d){return e=!0,d=new Promise(function(b){b(a[c](d))}),{done:!1,value:b(d)}}var d={},e=!1;return"function"===typeof Symbol&&Symbol.iterator&&(d[Symbol.iterator]=function(){return this}),d.next=function(a){return e?(e=!1,a):c("next",a)},"function"===typeof a.throw&&(d.throw=function(a){if(e)throw e=!1,a;return c("throw",a)}),"function"===typeof a.return&&(d.return=function(a){return c("return",a)}),d},q.asyncToGenerator=function(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){function f(a,b){try{var c=i[a](b),f=c.value}catch(a){return void e(a)}c.done?d(f):Promise.resolve(f).then(g,h)}function g(a){f("next",a)}function h(a){f("throw",a)}var i=a.apply(b,c);g()})}},q.classCallCheck=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},q.createClass=function(a,b,c){return b&&d(a.prototype,b),c&&d(a,c),a},q.defineEnumerableProperties=e,q.defaults=function(a,b){for(var c=Object.getOwnPropertyNames(b),d=0;d<c.length;d++){var e=c[d],f=Object.getOwnPropertyDescriptor(b,e);f&&f.configurable&&a[e]===void 0&&Object.defineProperty(a,e,f)}return a},q.defineProperty=f,q.extends=g,q.objectSpread=function(a){for(var b=1;b<arguments.length;b++){var c=null==arguments[b]?{}:arguments[b],d=Object.keys(c);"function"===typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){q.defineProperty(a,b,c[b])})}return a},q.inherits=function(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&q.setPrototypeOf(a,b)},q.getPrototypeOf=h,q.setPrototypeOf=i,q.construct=k,q.wrapNativeSuper=l,q.instanceof=function(a,b){return null!=b&&"undefined"!==typeof Symbol&&b[Symbol.hasInstance]?b[Symbol.hasInstance](a):a instanceof b},q.interopRequireDefault=function(a){return a&&a.__esModule?a:{default:a}},q.interopRequireWildcard=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b},q.newArrowCheck=function(a,b){if(a!==b)throw new TypeError("Cannot instantiate an arrow function")},q.objectDestructuringEmpty=function(a){if(null==a)throw new TypeError("Cannot destructure undefined")},q.objectWithoutProperties=function(a,b){if(null==a)return{};var c,d,e={},f=Object.keys(a);for(d=0;d<f.length;d++)c=f[d],0<=b.indexOf(c)||(e[c]=a[c]);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(a);for(d=0;d<g.length;d++)c=g[d],!(0<=b.indexOf(c))&&Object.prototype.propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e},q.assertThisInitialized=function(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a},q.possibleConstructorReturn=function(a,b){return b&&("object"===typeof b||"function"===typeof b)?b:q.assertThisInitialized(a)},q.superPropBase=function(a,b){for(;!Object.prototype.hasOwnProperty.call(a,b)&&(a=q.getPrototypeOf(a),null!==a););return a},q.get=m,q.set=o,q.taggedTemplateLiteral=function(a,b){return b||(b=a.slice(0)),Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(b)}}))},q.temporalRef=function(a,b){if(a===q.temporalUndefined)throw new ReferenceError(b+" is not defined - temporal dead zone");else return a},q.readOnlyError=function(a){throw new Error("\""+a+"\" is read-only")},q.temporalUndefined={},q.slicedToArray=function(a,b){return q.arrayWithHoles(a)||q.iterableToArrayLimit(a,b)||q.nonIterableRest()},q.toArray=function(a){return q.arrayWithHoles(a)||q.iterableToArray(a)||q.nonIterableRest()},q.toConsumableArray=function(a){return q.arrayWithoutHoles(a)||q.iterableToArray(a)||q.nonIterableSpread()},q.arrayWithoutHoles=function(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}},q.arrayWithHoles=function(a){if(Array.isArray(a))return a},q.iterableToArray=p,q.iterableToArrayLimit=function(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c},q.nonIterableSpread=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")},q.nonIterableRest=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")},q.toPropertyKey=function(a){return"symbol"===typeof a?a:a+""}})("undefined"===typeof global?self:global);</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>
<script src="/node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>
<script>"use strict";(function(){function a(a,b,c){var d=a;if(d.state=b,d.stateData=c,0<d.onNextStateChange.length){var e=d.onNextStateChange.slice();d.onNextStateChange.length=0;for(var f,g=0,h=e;g<h.length;g++)f=h[g],f()}return d}function b(b){function d(){try{document.head.removeChild(f)}catch(a){}}var e=a(b,"Loading",void 0),f=document.createElement("script");return f.src=b.url,f.onload=function(){var a,b;void 0===r?(a=[],b=void 0):(f=r(),a=f[0],b=f[1]),c(e,a,b),d();var f},f.onerror=function(){g(b,new TypeError("Failed to fetch "+b.url)),d()},document.head.appendChild(f),e}function c(b,c,e){var f=d(b,c),g=f[0],h=f[1];return a(b,"WaitingForTurn",{args:g,deps:h,moduleBody:e})}function d(a,c){for(var e,f=[],g=[],i=0,j=c;i<j.length;i++){if(e=j[i],"exports"===e){f.push(a.exports);continue}if("require"===e){f.push(function(b,c,e){var f=d(a,b),g=f[0],i=f[1];h(i,function(){c&&c.apply(null,g)},e)});continue}if("meta"===e){f.push({url:!0===a.isTopLevel?a.url.substring(0,a.url.lastIndexOf("#")):a.url});continue}var l=k(n(a.urlBase,e));f.push(l.exports),g.push(l),"Initialized"===l.state&&b(l)}return[f,g]}function e(b){var c=a(b,"WaitingOnDeps",b.stateData);return h(b.stateData.deps,function(){return f(c)},function(a){return g(c,a)}),c}function f(b){var c=b.stateData;if(null!=c.moduleBody)try{c.moduleBody.apply(null,c.args)}catch(a){return g(b,a)}return a(b,"Executed",void 0)}function g(b,c){return!0===b.isTopLevel&&setTimeout(function(){throw c}),a(b,"Failed",c)}function h(a,b,c){var d=a.shift();return void 0===d?void(b&&b()):"WaitingOnDeps"===d.state?(!1,void h(a,b,c)):void i(d,function(){h(a,b,c)},c)}function i(a,b,c){switch(a.state){case"WaitingForTurn":return e(a),void i(a,b,c);case"Failed":return void(c&&c(a.stateData));case"Executed":return void b();case"Loading":case"WaitingOnDeps":return void a.onNextStateChange.push(function(){return i(a,b,c)});case"Initialized":throw new Error("All dependencies should be loading already before pressureDependencyToExecute is called.");default:throw new Error("Impossible module state: "+a.state);}}function j(a,b){switch(a.state){case"Executed":case"Failed":return void b();default:a.onNextStateChange.push(function(){return j(a,b)});}}function k(a){var b=q[a];return void 0===b&&(b=q[a]={url:a,urlBase:m(a),exports:Object.create(null),state:"Initialized",stateData:void 0,isTopLevel:!1,onNextStateChange:[]}),b}function l(a){return v.href=a,v.href}function m(a){return a=a.split("?")[0],a=a.split("#")[0],a.substring(0,a.lastIndexOf("/")+1)}function n(a,b){return-1===b.indexOf("://")?l(a+b):b}function o(){return document.baseURI||(document.querySelector("base")||window.location).href}function p(){var b=document.currentScript;if(!b)return u;if(window.HTMLImports){var c=window.HTMLImports.importForElement(b);return c?c.href:u}var d=b.ownerDocument.createElement("a");return d.href="",d.href}if(!window.define){var q=Object.create(null),r=void 0,s=0,t=void 0,u=o();window.define=function(a,b){var d=!1;r=function(){return d=!0,r=void 0,[a,b]};var f=p();setTimeout(function(){if(!1==d){r=void 0;var g=f+"#"+s++,h=k(g);h.isTopLevel=!0;var i=c(h,a,b);void 0===t?e(i):j(k(t),function(){e(i)}),t=g}},0)},window.define._reset=function(){for(var a in q)delete q[a];r=void 0,s=0,t=void 0,u=o()};var v=document.createElement("a")}})();</script>
<script>
  requirejs(["/components/inspec-profile.js"]);
</script>

<div style="max-width: 800px; margin: auto;" class="profile">
  <inspec-profile></inspec-profile>
</div>
<script>
  window.profile = document.getElementsByTagName("inspec-profile")[0];
  profile.profile = {"attributes":[{"default":2,"description":"CIS profile level to audit","name":"cis_level","required":false,"type":"numeric"},{"description":"The name of the apiserver process","name":"apiserver","required":false,"type":"string"},{"description":"The name of the controller manager process","name":"controller_manager","required":false,"type":"string"},{"description":"The name of the kube scheduler proces","name":"scheduler","required":false,"type":"string"},{"description":"The name of the kubelet process","name":"kubelet","required":false,"type":"string"}],"controls":[{"code":"control 'cis-kubernetes-benchmark-1.1.1' do\n  title 'Ensure that the --anonymous-auth argument is set to false'\n  desc \"Disable anonymous requests to the API server.\\n\\nRationale: When enabled, requests that are not rejected by other configured authentication methods are treated as anonymous requests. These requests are then served by the API server. You should rely on authentication to authorize access and disallow anonymous requests.\\nIf you are using RBAC authorization, it is generally considered reasonable to allow anonymous access to the API Server for health checks and discovery purposes, and hence this recommendation is not scored. However, you should consider whether anonymous discovery is an acceptable risk for your purposes.\"\n  impact 0.0\n\n  tag cis: 'kubernetes:1.1.1'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--anonymous-auth=false/) }\n  end\nend\n","desc":"Disable anonymous requests to the API server.\n\nRationale: When enabled, requests that are not rejected by other configured authentication methods are treated as anonymous requests. These requests are then served by the API server. You should rely on authentication to authorize access and disallow anonymous requests.\nIf you are using RBAC authorization, it is generally considered reasonable to allow anonymous access to the API Server for health checks and discovery purposes, and hence this recommendation is not scored. However, you should consider whether anonymous discovery is an acceptable risk for your purposes.","descriptions":{"default":"Disable anonymous requests to the API server.\n\nRationale: When enabled, requests that are not rejected by other configured authentication methods are treated as anonymous requests. These requests are then served by the API server. You should rely on authentication to authorize access and disallow anonymous requests.\nIf you are using RBAC authorization, it is generally considered reasonable to allow anonymous access to the API Server for health checks and discovery purposes, and hence this recommendation is not scored. However, you should consider whether anonymous discovery is an acceptable risk for your purposes."},"id":"cis-kubernetes-benchmark-1.1.1","impact":0,"refs":[],"source_location":{"line":28,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.1","level":1},"title":"Ensure that the --anonymous-auth argument is set to false"},{"code":"control 'cis-kubernetes-benchmark-1.1.2' do\n  title 'Ensure that the --basic-auth-file argument is not set'\n  desc \"Do not use basic authentication.\\n\\nRationale: Basic authentication uses plaintext credentials for authentication. Currently, the basic authentication credentials last indefinitely, and the password cannot be changed without restarting API server. The basic authentication is currently supported for convenience. Hence, basic authentication should not be used.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.2'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should_not match(/--basic-auth-file/) }\n  end\nend\n","desc":"Do not use basic authentication.\n\nRationale: Basic authentication uses plaintext credentials for authentication. Currently, the basic authentication credentials last indefinitely, and the password cannot be changed without restarting API server. The basic authentication is currently supported for convenience. Hence, basic authentication should not be used.","descriptions":{"default":"Do not use basic authentication.\n\nRationale: Basic authentication uses plaintext credentials for authentication. Currently, the basic authentication credentials last indefinitely, and the password cannot be changed without restarting API server. The basic authentication is currently supported for convenience. Hence, basic authentication should not be used."},"id":"cis-kubernetes-benchmark-1.1.2","impact":1,"refs":[],"source_location":{"line":41,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.2","level":1},"title":"Ensure that the --basic-auth-file argument is not set"},{"code":"control 'cis-kubernetes-benchmark-1.1.3' do\n  title 'Ensure that the --insecure-allow-any-token argument is not set'\n  desc \"Do not allow any insecure tokens\\n\\nRationale: Accepting insecure tokens would allow any token without actually authenticating anything. User information is parsed from the token and connections are allowed.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.3'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should_not match(/--insecure-allow-any-token/) }\n  end\nend\n","desc":"Do not allow any insecure tokens\n\nRationale: Accepting insecure tokens would allow any token without actually authenticating anything. User information is parsed from the token and connections are allowed.","descriptions":{"default":"Do not allow any insecure tokens\n\nRationale: Accepting insecure tokens would allow any token without actually authenticating anything. User information is parsed from the token and connections are allowed."},"id":"cis-kubernetes-benchmark-1.1.3","impact":1,"refs":[],"source_location":{"line":54,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.3","level":1},"title":"Ensure that the --insecure-allow-any-token argument is not set"},{"code":"control 'cis-kubernetes-benchmark-1.1.4' do\n  title 'Ensure that the --kubelet-https argument is set to true'\n  desc \"Use https for kubelet connections.\\n\\nRationale: Connections from apiserver to kubelets could potentially carry sensitive data such as secrets and keys. It is thus important to use in-transit encryption for any communication between the apiserver and kubelets.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.4'\n  tag level: 1\n\n  describe.one do\n    describe processes(apiserver).commands.to_s do\n      it { should match(/--kubelet-https=true/) }\n    end\n    describe processes(apiserver).commands.to_s do\n      it { should_not match(/--kubelet-https/) }\n    end\n  end\nend\n","desc":"Use https for kubelet connections.\n\nRationale: Connections from apiserver to kubelets could potentially carry sensitive data such as secrets and keys. It is thus important to use in-transit encryption for any communication between the apiserver and kubelets.","descriptions":{"default":"Use https for kubelet connections.\n\nRationale: Connections from apiserver to kubelets could potentially carry sensitive data such as secrets and keys. It is thus important to use in-transit encryption for any communication between the apiserver and kubelets."},"id":"cis-kubernetes-benchmark-1.1.4","impact":1,"refs":[],"source_location":{"line":67,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.4","level":1},"title":"Ensure that the --kubelet-https argument is set to true"},{"code":"control 'cis-kubernetes-benchmark-1.1.5' do\n  title 'Ensure that the --insecure-bind-address argument is not set'\n  desc \"Do not bind the insecure API service.\\n\\nRationale: If you bind the apiserver to an insecure address, basically anyone who could connect to it over the insecure port, would have unauthenticated and unencrypted access to your master node. The apiserver doesn't do any authentication checking for insecure binds and traffic to the Insecure API port is not encrpyted, allowing attackers to potentially read sensitive data in transit.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.5'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should_not match(/--insecure-bind-address/) }\n  end\nend\n","desc":"Do not bind the insecure API service.\n\nRationale: If you bind the apiserver to an insecure address, basically anyone who could connect to it over the insecure port, would have unauthenticated and unencrypted access to your master node. The apiserver doesn't do any authentication checking for insecure binds and traffic to the Insecure API port is not encrpyted, allowing attackers to potentially read sensitive data in transit.","descriptions":{"default":"Do not bind the insecure API service.\n\nRationale: If you bind the apiserver to an insecure address, basically anyone who could connect to it over the insecure port, would have unauthenticated and unencrypted access to your master node. The apiserver doesn't do any authentication checking for insecure binds and traffic to the Insecure API port is not encrpyted, allowing attackers to potentially read sensitive data in transit."},"id":"cis-kubernetes-benchmark-1.1.5","impact":1,"refs":[],"source_location":{"line":85,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.5","level":1},"title":"Ensure that the --insecure-bind-address argument is not set"},{"code":"control 'cis-kubernetes-benchmark-1.1.6' do\n  title 'Ensure that the --insecure-port argument is set to 0'\n  desc \"Do not bind to insecure port.\\n\\nRationale: Setting up the apiserver to serve on an insecure port would allow unauthenticated and unencrypted access to your master node. This would allow attackers who could access this port, to easily take control of the cluster.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.6'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--insecure-port=0/) }\n  end\nend\n","desc":"Do not bind to insecure port.\n\nRationale: Setting up the apiserver to serve on an insecure port would allow unauthenticated and unencrypted access to your master node. This would allow attackers who could access this port, to easily take control of the cluster.","descriptions":{"default":"Do not bind to insecure port.\n\nRationale: Setting up the apiserver to serve on an insecure port would allow unauthenticated and unencrypted access to your master node. This would allow attackers who could access this port, to easily take control of the cluster."},"id":"cis-kubernetes-benchmark-1.1.6","impact":1,"refs":[],"source_location":{"line":98,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.6","level":1},"title":"Ensure that the --insecure-port argument is set to 0"},{"code":"control 'cis-kubernetes-benchmark-1.1.7' do\n  title 'Ensure that the --secure-port argument is not set to 0'\n  desc \"Do not disable the secure port.\\n\\nRationale: The secure port is used to serve https with authentication and authorization. If you disable it, no https traffic is served and all traffic is served unencrypted.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.7'\n  tag level: 1\n\n  describe.one do\n    describe processes(apiserver).commands.to_s do\n      it { should match(/--secure-port=([1-9][0-9]{0,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])/) }\n    end\n    describe processes(apiserver).commands.to_s do\n      it { should_not match(/--secure-port/) }\n    end\n  end\nend\n","desc":"Do not disable the secure port.\n\nRationale: The secure port is used to serve https with authentication and authorization. If you disable it, no https traffic is served and all traffic is served unencrypted.","descriptions":{"default":"Do not disable the secure port.\n\nRationale: The secure port is used to serve https with authentication and authorization. If you disable it, no https traffic is served and all traffic is served unencrypted."},"id":"cis-kubernetes-benchmark-1.1.7","impact":1,"refs":[],"source_location":{"line":111,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.7","level":1},"title":"Ensure that the --secure-port argument is not set to 0"},{"code":"control 'cis-kubernetes-benchmark-1.1.8' do\n  title 'Ensure that the --profiling argument is set to false'\n  desc \"Disable profiling, if not needed.\\n\\nRationale: Profiling allows for the identification of specific performance bottlenecks. It generates a significant amount of program data that could potentially be exploited to uncover system and program details. If you are not experiencing any bottlenecks and do not need the profiler for troubleshooting purposes, it is recommended to turn it off to reduce the potential attack surface.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.8'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--profiling=false/) }\n  end\nend\n","desc":"Disable profiling, if not needed.\n\nRationale: Profiling allows for the identification of specific performance bottlenecks. It generates a significant amount of program data that could potentially be exploited to uncover system and program details. If you are not experiencing any bottlenecks and do not need the profiler for troubleshooting purposes, it is recommended to turn it off to reduce the potential attack surface.","descriptions":{"default":"Disable profiling, if not needed.\n\nRationale: Profiling allows for the identification of specific performance bottlenecks. It generates a significant amount of program data that could potentially be exploited to uncover system and program details. If you are not experiencing any bottlenecks and do not need the profiler for troubleshooting purposes, it is recommended to turn it off to reduce the potential attack surface."},"id":"cis-kubernetes-benchmark-1.1.8","impact":1,"refs":[],"source_location":{"line":129,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.8","level":1},"title":"Ensure that the --profiling argument is set to false"},{"code":"control 'cis-kubernetes-benchmark-1.1.9' do\n  title 'Ensure that the --repair-malformed-updates argument is set to false'\n  desc \"Disable fixing of malformed updates.\\n\\nRationale: The apiserver will potentially attempt to fix the update requests to pass the validation even if the requests are malformed. Malformed requests are one of the potential ways to interact with a service without legitimate information. Such requests could potentially be used to sabotage API Server responses.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.9'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--repair-malformed-updates=false/) }\n  end\nend\n","desc":"Disable fixing of malformed updates.\n\nRationale: The apiserver will potentially attempt to fix the update requests to pass the validation even if the requests are malformed. Malformed requests are one of the potential ways to interact with a service without legitimate information. Such requests could potentially be used to sabotage API Server responses.","descriptions":{"default":"Disable fixing of malformed updates.\n\nRationale: The apiserver will potentially attempt to fix the update requests to pass the validation even if the requests are malformed. Malformed requests are one of the potential ways to interact with a service without legitimate information. Such requests could potentially be used to sabotage API Server responses."},"id":"cis-kubernetes-benchmark-1.1.9","impact":1,"refs":[],"source_location":{"line":142,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.9","level":1},"title":"Ensure that the --repair-malformed-updates argument is set to false"},{"code":"control 'cis-kubernetes-benchmark-1.1.10' do\n  title 'Ensure that the admission control plugin AlwaysAdmit is not set'\n  desc \"Do not allow all requests.\\n\\nRationale: Setting admission control plugin `AlwaysAdmit` allows all requests and do not filter any requests.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.10'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should_not match(/--enable-admission-plugins=(?:.)*AlwaysAdmit,*(?:.)*/) }\n    it { should match(/--enable-admission-plugins=/) }\n  end\nend\n","desc":"Do not allow all requests.\n\nRationale: Setting admission control plugin `AlwaysAdmit` allows all requests and do not filter any requests.","descriptions":{"default":"Do not allow all requests.\n\nRationale: Setting admission control plugin `AlwaysAdmit` allows all requests and do not filter any requests."},"id":"cis-kubernetes-benchmark-1.1.10","impact":1,"refs":[],"source_location":{"line":155,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.10","level":1},"title":"Ensure that the admission control plugin AlwaysAdmit is not set"},{"code":"control 'cis-kubernetes-benchmark-1.1.11' do\n  title 'Ensure that the admission control plugin AlwaysPullImages is set'\n  desc \"Always pull images.\\n\\nRationale: Setting admission control policy to `AlwaysPullImages` forces every new pod to pull the required images every time. In a multitenant cluster users can be assured that their private images can only be used by those who have the credentials to pull them. Without this admisssion control policy, once an image has been pulled to a node, any pod from any user can use it simply by knowing the image's name, without any authorization check against the image ownership. When this plug-in is enabled, images are always pulled prior to starting containers, which means valid credentials are required.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.11'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--enable-admission-plugins=(?:.)*AlwaysPullImages,*(?:.)*/) }\n  end\nend\n","desc":"Always pull images.\n\nRationale: Setting admission control policy to `AlwaysPullImages` forces every new pod to pull the required images every time. In a multitenant cluster users can be assured that their private images can only be used by those who have the credentials to pull them. Without this admisssion control policy, once an image has been pulled to a node, any pod from any user can use it simply by knowing the image's name, without any authorization check against the image ownership. When this plug-in is enabled, images are always pulled prior to starting containers, which means valid credentials are required.","descriptions":{"default":"Always pull images.\n\nRationale: Setting admission control policy to `AlwaysPullImages` forces every new pod to pull the required images every time. In a multitenant cluster users can be assured that their private images can only be used by those who have the credentials to pull them. Without this admisssion control policy, once an image has been pulled to a node, any pod from any user can use it simply by knowing the image's name, without any authorization check against the image ownership. When this plug-in is enabled, images are always pulled prior to starting containers, which means valid credentials are required."},"id":"cis-kubernetes-benchmark-1.1.11","impact":1,"refs":[],"source_location":{"line":169,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.11","level":1},"title":"Ensure that the admission control plugin AlwaysPullImages is set"},{"code":"control 'cis-kubernetes-benchmark-1.1.12' do\n  title 'Ensure that the admission control plugin DenyEscalatingExec is set'\n  desc \"Deny execution of `exec` and `attach` commands in privileged pods.\\n\\nRationale: Setting admission control policy to `DenyEscalatingExec` denies `exec` and `attach` commands to pods that run with escalated privileges that allow host access. This includes pods that run as privileged, have access to the host IPC namespace, and have access to the host PID namespace.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.12'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--enable-admission-plugins=(?:.)*DenyEscalatingExec,*(?:.)*/) }\n  end\nend\n","desc":"Deny execution of `exec` and `attach` commands in privileged pods.\n\nRationale: Setting admission control policy to `DenyEscalatingExec` denies `exec` and `attach` commands to pods that run with escalated privileges that allow host access. This includes pods that run as privileged, have access to the host IPC namespace, and have access to the host PID namespace.","descriptions":{"default":"Deny execution of `exec` and `attach` commands in privileged pods.\n\nRationale: Setting admission control policy to `DenyEscalatingExec` denies `exec` and `attach` commands to pods that run with escalated privileges that allow host access. This includes pods that run as privileged, have access to the host IPC namespace, and have access to the host PID namespace."},"id":"cis-kubernetes-benchmark-1.1.12","impact":1,"refs":[],"source_location":{"line":182,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.12","level":1},"title":"Ensure that the admission control plugin DenyEscalatingExec is set"},{"code":"control 'cis-kubernetes-benchmark-1.1.13' do\n  title 'Ensure that the admission control plugin SecurityContextDeny is set'\n  desc \"Restrict pod level SecurityContext customization. Instead of using a customized SecurityContext for your pods, use a Pod Security Policy (PSP), which is a cluster-level resource that controls the actions that a pod can perform and what it has the ability to access.\\n\\nRationale: Setting admission control policy to `SecurityContextDeny` denies the pod level SecurityContext customization. Any attempts to customize the SecurityContexts that are not explicitly defined in the Pod Security Policy (PSP) are blocked. This ensures that all the pods adhere to the PSP defined by your organization and you have a uniform pod level security posture.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.13'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--enable-admission-plugins=(?:.)*SecurityContextDeny,*(?:.)*/) }\n  end\nend\n","desc":"Restrict pod level SecurityContext customization. Instead of using a customized SecurityContext for your pods, use a Pod Security Policy (PSP), which is a cluster-level resource that controls the actions that a pod can perform and what it has the ability to access.\n\nRationale: Setting admission control policy to `SecurityContextDeny` denies the pod level SecurityContext customization. Any attempts to customize the SecurityContexts that are not explicitly defined in the Pod Security Policy (PSP) are blocked. This ensures that all the pods adhere to the PSP defined by your organization and you have a uniform pod level security posture.","descriptions":{"default":"Restrict pod level SecurityContext customization. Instead of using a customized SecurityContext for your pods, use a Pod Security Policy (PSP), which is a cluster-level resource that controls the actions that a pod can perform and what it has the ability to access.\n\nRationale: Setting admission control policy to `SecurityContextDeny` denies the pod level SecurityContext customization. Any attempts to customize the SecurityContexts that are not explicitly defined in the Pod Security Policy (PSP) are blocked. This ensures that all the pods adhere to the PSP defined by your organization and you have a uniform pod level security posture."},"id":"cis-kubernetes-benchmark-1.1.13","impact":1,"refs":[],"source_location":{"line":195,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.13","level":1},"title":"Ensure that the admission control plugin SecurityContextDeny is set"},{"code":"control 'cis-kubernetes-benchmark-1.1.14' do\n  title 'Ensure that the admission control plugin NamespaceLifecycle is set'\n  desc \"Reject creating objects in a namespace that is undergoing termination.\\n\\nRationale: Setting admission control policy to `NamespaceLifecycle` ensures that objects cannot be created in non-existent namespaces, and that namespaces undergoing termination are not used for creating the new objects. This is recommended to enforce the integrity of the namespace termination process and also for the availability of the newer objects.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.14'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should_not match(/--disable-admission-plugins=(?:.)*NamespaceLifecycle,*(?:.)*/) }\n  end\nend\n","desc":"Reject creating objects in a namespace that is undergoing termination.\n\nRationale: Setting admission control policy to `NamespaceLifecycle` ensures that objects cannot be created in non-existent namespaces, and that namespaces undergoing termination are not used for creating the new objects. This is recommended to enforce the integrity of the namespace termination process and also for the availability of the newer objects.","descriptions":{"default":"Reject creating objects in a namespace that is undergoing termination.\n\nRationale: Setting admission control policy to `NamespaceLifecycle` ensures that objects cannot be created in non-existent namespaces, and that namespaces undergoing termination are not used for creating the new objects. This is recommended to enforce the integrity of the namespace termination process and also for the availability of the newer objects."},"id":"cis-kubernetes-benchmark-1.1.14","impact":1,"refs":[],"source_location":{"line":208,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.14","level":1},"title":"Ensure that the admission control plugin NamespaceLifecycle is set"},{"code":"control 'cis-kubernetes-benchmark-1.1.15' do\n  title 'Ensure that the --audit-log-path argument is set as appropriate'\n  desc \"Enable auditing on the Kubernetes API Server and set the desired audit log path as appropriate.\\n\\nRationale: Auditing the Kubernetes API Server provides a security-relevant chronological set of records documenting the sequence of activities that have affected system by individual users, administrators or other components of the system. Even though currently, Kubernetes provides only basic audit capabilities, it should be enabled. You can enable it by setting an appropriate audit log path.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.15'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--audit-log-path=/) }\n  end\nend\n","desc":"Enable auditing on the Kubernetes API Server and set the desired audit log path as appropriate.\n\nRationale: Auditing the Kubernetes API Server provides a security-relevant chronological set of records documenting the sequence of activities that have affected system by individual users, administrators or other components of the system. Even though currently, Kubernetes provides only basic audit capabilities, it should be enabled. You can enable it by setting an appropriate audit log path.","descriptions":{"default":"Enable auditing on the Kubernetes API Server and set the desired audit log path as appropriate.\n\nRationale: Auditing the Kubernetes API Server provides a security-relevant chronological set of records documenting the sequence of activities that have affected system by individual users, administrators or other components of the system. Even though currently, Kubernetes provides only basic audit capabilities, it should be enabled. You can enable it by setting an appropriate audit log path."},"id":"cis-kubernetes-benchmark-1.1.15","impact":1,"refs":[],"source_location":{"line":221,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.15","level":1},"title":"Ensure that the --audit-log-path argument is set as appropriate"},{"code":"control 'cis-kubernetes-benchmark-1.1.16' do\n  title 'Ensure that the --audit-log-maxage argument is set to 30 or as appropriate'\n  desc \"Retain the logs for at least 30 days or as appropriate.\\n\\nRationale: Retaining logs for at least 30 days ensures that you can go back in time and investigate or correlate any events. Set your audit log retention period to 30 days or as per your business requirements.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.16'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--audit-log-maxage=/) }\n  end\n\n  audit_log_maxage = processes(apiserver).commands.to_s.scan(/--audit-log-maxage=(\\d+)/)\n\n  unless audit_log_maxage.empty?\n    describe audit_log_maxage.last.first.to_i do\n      it { should cmp \u003e= 30 }\n    end\n  end\nend\n","desc":"Retain the logs for at least 30 days or as appropriate.\n\nRationale: Retaining logs for at least 30 days ensures that you can go back in time and investigate or correlate any events. Set your audit log retention period to 30 days or as per your business requirements.","descriptions":{"default":"Retain the logs for at least 30 days or as appropriate.\n\nRationale: Retaining logs for at least 30 days ensures that you can go back in time and investigate or correlate any events. Set your audit log retention period to 30 days or as per your business requirements."},"id":"cis-kubernetes-benchmark-1.1.16","impact":1,"refs":[],"source_location":{"line":234,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.16","level":1},"title":"Ensure that the --audit-log-maxage argument is set to 30 or as appropriate"},{"code":"control 'cis-kubernetes-benchmark-1.1.17' do\n  title 'Ensure that the --audit-log-maxbackup argument is set to 10 or as appropriate'\n  desc \"Retain 10 or an appropriate number of old log files.\\n\\nRationale: Kubernetes automatically rotates the log files. Retaining old log files ensures that you would have sufficient log data available for carrying out any investigation or correlation. For example, if you have set file size of 100 MB and the number of old log files to keep as 10, you would approximate have 1 GB of log data that you could potentially use for your analysis.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.17'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--audit-log-maxbackup=/) }\n  end\n\n  audit_log_maxbackup = processes(apiserver).commands.to_s.scan(/--audit-log-maxbackup=(\\d+)/)\n\n  unless audit_log_maxbackup.empty?\n    describe audit_log_maxbackup.last.first.to_i do\n      it { should cmp \u003e= 10 }\n    end\n  end\nend\n","desc":"Retain 10 or an appropriate number of old log files.\n\nRationale: Kubernetes automatically rotates the log files. Retaining old log files ensures that you would have sufficient log data available for carrying out any investigation or correlation. For example, if you have set file size of 100 MB and the number of old log files to keep as 10, you would approximate have 1 GB of log data that you could potentially use for your analysis.","descriptions":{"default":"Retain 10 or an appropriate number of old log files.\n\nRationale: Kubernetes automatically rotates the log files. Retaining old log files ensures that you would have sufficient log data available for carrying out any investigation or correlation. For example, if you have set file size of 100 MB and the number of old log files to keep as 10, you would approximate have 1 GB of log data that you could potentially use for your analysis."},"id":"cis-kubernetes-benchmark-1.1.17","impact":1,"refs":[],"source_location":{"line":255,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.17","level":1},"title":"Ensure that the --audit-log-maxbackup argument is set to 10 or as appropriate"},{"code":"control 'cis-kubernetes-benchmark-1.1.18' do\n  title 'Ensure that the --audit-log-maxsize argument is set to 100 or as appropriate'\n  desc \"Rotate log files on reaching 100 MB or as appropriate.\\n\\nRationale: Kubernetes automatically rotates the log files. Retaining old log files ensures that you would have sufficient log data available for carrying out any investigation or correlation. If you have set file size of 100 MB and the number of old log files to keep as 10, you would approximate have 1 GB of log data that you could potentially use for your analysis.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.18'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--audit-log-maxsize=/) }\n  end\n\n  audit_log_maxsize = processes(apiserver).commands.to_s.scan(/--audit-log-maxsize=(\\d+)/)\n\n  unless audit_log_maxsize.empty?\n    describe audit_log_maxsize.last.first.to_i do\n      it { should cmp \u003e= 100 }\n    end\n  end\nend\n","desc":"Rotate log files on reaching 100 MB or as appropriate.\n\nRationale: Kubernetes automatically rotates the log files. Retaining old log files ensures that you would have sufficient log data available for carrying out any investigation or correlation. If you have set file size of 100 MB and the number of old log files to keep as 10, you would approximate have 1 GB of log data that you could potentially use for your analysis.","descriptions":{"default":"Rotate log files on reaching 100 MB or as appropriate.\n\nRationale: Kubernetes automatically rotates the log files. Retaining old log files ensures that you would have sufficient log data available for carrying out any investigation or correlation. If you have set file size of 100 MB and the number of old log files to keep as 10, you would approximate have 1 GB of log data that you could potentially use for your analysis."},"id":"cis-kubernetes-benchmark-1.1.18","impact":1,"refs":[],"source_location":{"line":276,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.18","level":1},"title":"Ensure that the --audit-log-maxsize argument is set to 100 or as appropriate"},{"code":"control 'cis-kubernetes-benchmark-1.1.19' do\n  title 'Ensure that the --authorization-mode argument is not set to AlwaysAllow'\n  desc \"Do not always authorize all requests.\\n\\nRationale: The API Server, can be configured to allow all requests. This mode should not be used on any production cluster.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.19'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should_not match(/--authorization-mode=(?:.)*AlwaysAllow,*(?:.)*/) }\n    it { should match(/--authorization-mode=/) }\n  end\nend\n","desc":"Do not always authorize all requests.\n\nRationale: The API Server, can be configured to allow all requests. This mode should not be used on any production cluster.","descriptions":{"default":"Do not always authorize all requests.\n\nRationale: The API Server, can be configured to allow all requests. This mode should not be used on any production cluster."},"id":"cis-kubernetes-benchmark-1.1.19","impact":1,"refs":[],"source_location":{"line":297,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.19","level":1},"title":"Ensure that the --authorization-mode argument is not set to AlwaysAllow"},{"code":"control 'cis-kubernetes-benchmark-1.1.20' do\n  title 'Ensure that the --token-auth-file parameter is not set'\n  desc \"Do not use token based authentication.\\n\\nRationale: The token-based authentication utilizes static tokens to authenticate requests to the apiserver. The tokens are stored in clear-text in a file on the apiserver, and cannot be revoked or rotated without restarting the apiserver. Hence, do not use static token-based authentication.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.20'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should_not match(/--token-auth-file/) }\n  end\nend\n","desc":"Do not use token based authentication.\n\nRationale: The token-based authentication utilizes static tokens to authenticate requests to the apiserver. The tokens are stored in clear-text in a file on the apiserver, and cannot be revoked or rotated without restarting the apiserver. Hence, do not use static token-based authentication.","descriptions":{"default":"Do not use token based authentication.\n\nRationale: The token-based authentication utilizes static tokens to authenticate requests to the apiserver. The tokens are stored in clear-text in a file on the apiserver, and cannot be revoked or rotated without restarting the apiserver. Hence, do not use static token-based authentication."},"id":"cis-kubernetes-benchmark-1.1.20","impact":1,"refs":[],"source_location":{"line":311,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.20","level":1},"title":"Ensure that the --token-auth-file parameter is not set"},{"code":"control 'cis-kubernetes-benchmark-1.1.21' do\n  title 'Ensure that the --kubelet-certificate-authority argument is set as appropriate'\n  desc \"Verify kubelet's certificate before establishing connection.\\n\\nRationale: The connections from the apiserver to the kubelet are used for fetching logs for pods, attaching (through kubectl) to running pods, and using the kubelet's port-forwarding functionality. These connections terminate at the kubelet's HTTPS endpoint. By default, the apiserver does not verify the kubelet's serving certificate, which makes the connection subject to man-in-the-middle attacks, and unsafe to run over untrusted and/or public networks.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.21'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--kubelet-certificate-authority=/) }\n  end\nend\n","desc":"Verify kubelet's certificate before establishing connection.\n\nRationale: The connections from the apiserver to the kubelet are used for fetching logs for pods, attaching (through kubectl) to running pods, and using the kubelet's port-forwarding functionality. These connections terminate at the kubelet's HTTPS endpoint. By default, the apiserver does not verify the kubelet's serving certificate, which makes the connection subject to man-in-the-middle attacks, and unsafe to run over untrusted and/or public networks.","descriptions":{"default":"Verify kubelet's certificate before establishing connection.\n\nRationale: The connections from the apiserver to the kubelet are used for fetching logs for pods, attaching (through kubectl) to running pods, and using the kubelet's port-forwarding functionality. These connections terminate at the kubelet's HTTPS endpoint. By default, the apiserver does not verify the kubelet's serving certificate, which makes the connection subject to man-in-the-middle attacks, and unsafe to run over untrusted and/or public networks."},"id":"cis-kubernetes-benchmark-1.1.21","impact":1,"refs":[],"source_location":{"line":324,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.21","level":1},"title":"Ensure that the --kubelet-certificate-authority argument is set as appropriate"},{"code":"control 'cis-kubernetes-benchmark-1.1.22' do\n  title 'Ensure that the --kubelet-client-certificate and --kubelet-client-key arguments are set as appropriate'\n  desc \"Enable certificate based kubelet authentication.\\n\\nRationale: The apiserver, by default, does not authenticate itself to the kubelet's HTTPS endpoints. The requests from the apiserver are treated anonymously. You should set up certificate-based kubelet authentication to ensure that the apiserver authenticates itself to kubelets when submitting requests.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.22'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--kubelet-client-certificate=/) }\n    it { should match(/--kubelet-client-key=/) }\n  end\nend\n","desc":"Enable certificate based kubelet authentication.\n\nRationale: The apiserver, by default, does not authenticate itself to the kubelet's HTTPS endpoints. The requests from the apiserver are treated anonymously. You should set up certificate-based kubelet authentication to ensure that the apiserver authenticates itself to kubelets when submitting requests.","descriptions":{"default":"Enable certificate based kubelet authentication.\n\nRationale: The apiserver, by default, does not authenticate itself to the kubelet's HTTPS endpoints. The requests from the apiserver are treated anonymously. You should set up certificate-based kubelet authentication to ensure that the apiserver authenticates itself to kubelets when submitting requests."},"id":"cis-kubernetes-benchmark-1.1.22","impact":1,"refs":[],"source_location":{"line":337,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.22","level":1},"title":"Ensure that the --kubelet-client-certificate and --kubelet-client-key arguments are set as appropriate"},{"code":"control 'cis-kubernetes-benchmark-1.1.23' do\n  title 'Ensure that the --service-account-lookup argument is set to true'\n  desc \"Validate service account before validating token.\\n\\nRationale: If `--service-account-lookup` is not enabled, the apiserver only verifies that the authentication token is valid, and does not validate that the service account token mentioned in the request is actually present in etcd. This allows using a service account token even after the corresponding service account is deleted. This is an example of time of check to time of use security issue.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.23'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--service-account-lookup=true/) }\n  end\nend\n","desc":"Validate service account before validating token.\n\nRationale: If `--service-account-lookup` is not enabled, the apiserver only verifies that the authentication token is valid, and does not validate that the service account token mentioned in the request is actually present in etcd. This allows using a service account token even after the corresponding service account is deleted. This is an example of time of check to time of use security issue.","descriptions":{"default":"Validate service account before validating token.\n\nRationale: If `--service-account-lookup` is not enabled, the apiserver only verifies that the authentication token is valid, and does not validate that the service account token mentioned in the request is actually present in etcd. This allows using a service account token even after the corresponding service account is deleted. This is an example of time of check to time of use security issue."},"id":"cis-kubernetes-benchmark-1.1.23","impact":1,"refs":[],"source_location":{"line":351,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.23","level":1},"title":"Ensure that the --service-account-lookup argument is set to true"},{"code":"control 'cis-kubernetes-benchmark-1.1.24' do\n  title 'Ensure that the admission control plugin PodSecurityPolicy is set'\n  desc \"Reject creating pods that do not match Pod Security Policies.\\n\\nRationale: A Pod Security Policy is a cluster-level resource that controls the actions that a pod can perform and what it has the ability to access. The `PodSecurityPolicy` objects define a set of conditions that a pod must run with in order to be accepted into the system. Pod Security Policies are comprised of settings and strategies that control the security features a pod has access to and hence this must be used to control pod access permissions.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.25'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--enable-admission-plugins=(?:.)*PodSecurityPolicy,*(?:.)*/) }\n  end\nend\n","desc":"Reject creating pods that do not match Pod Security Policies.\n\nRationale: A Pod Security Policy is a cluster-level resource that controls the actions that a pod can perform and what it has the ability to access. The `PodSecurityPolicy` objects define a set of conditions that a pod must run with in order to be accepted into the system. Pod Security Policies are comprised of settings and strategies that control the security features a pod has access to and hence this must be used to control pod access permissions.","descriptions":{"default":"Reject creating pods that do not match Pod Security Policies.\n\nRationale: A Pod Security Policy is a cluster-level resource that controls the actions that a pod can perform and what it has the ability to access. The `PodSecurityPolicy` objects define a set of conditions that a pod must run with in order to be accepted into the system. Pod Security Policies are comprised of settings and strategies that control the security features a pod has access to and hence this must be used to control pod access permissions."},"id":"cis-kubernetes-benchmark-1.1.24","impact":1,"refs":[],"source_location":{"line":364,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.25","level":1},"title":"Ensure that the admission control plugin PodSecurityPolicy is set"},{"code":"control 'cis-kubernetes-benchmark-1.1.25' do\n  title 'Ensure that the --service-account-key-file argument is set as appropriate'\n  desc \"Explicitly set a service account public key file for service accounts on the apiserver.\\n\\nRationale: By default, if no `--service-account-key-file` is specified to the apiserver, it uses the private key from the TLS serving certificate to verify service account tokens. To ensure that the keys for service account tokens could be rotated as needed, a separate public/private key pair should be used for signing service account tokens. Hence, the public key should be specified to the apiserver with `--service-account-key-file`.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.25'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--service-account-key-file=/) }\n  end\nend\n","desc":"Explicitly set a service account public key file for service accounts on the apiserver.\n\nRationale: By default, if no `--service-account-key-file` is specified to the apiserver, it uses the private key from the TLS serving certificate to verify service account tokens. To ensure that the keys for service account tokens could be rotated as needed, a separate public/private key pair should be used for signing service account tokens. Hence, the public key should be specified to the apiserver with `--service-account-key-file`.","descriptions":{"default":"Explicitly set a service account public key file for service accounts on the apiserver.\n\nRationale: By default, if no `--service-account-key-file` is specified to the apiserver, it uses the private key from the TLS serving certificate to verify service account tokens. To ensure that the keys for service account tokens could be rotated as needed, a separate public/private key pair should be used for signing service account tokens. Hence, the public key should be specified to the apiserver with `--service-account-key-file`."},"id":"cis-kubernetes-benchmark-1.1.25","impact":1,"refs":[],"source_location":{"line":377,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.25","level":1},"title":"Ensure that the --service-account-key-file argument is set as appropriate"},{"code":"control 'cis-kubernetes-benchmark-1.1.26' do\n  title 'Ensure that the --etcd-certfile and --etcd-keyfile arguments are set as appropriate'\n  desc \"etcd should be configured to make use of TLS encryption for client connections.\\n\\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be protected by client authentication. This requires the API server to identify itself to the etcd server using a client certificate and key.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.26'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--etcd-certfile=/) }\n    it { should match(/--etcd-keyfile=/) }\n  end\nend\n","desc":"etcd should be configured to make use of TLS encryption for client connections.\n\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be protected by client authentication. This requires the API server to identify itself to the etcd server using a client certificate and key.","descriptions":{"default":"etcd should be configured to make use of TLS encryption for client connections.\n\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be protected by client authentication. This requires the API server to identify itself to the etcd server using a client certificate and key."},"id":"cis-kubernetes-benchmark-1.1.26","impact":1,"refs":[],"source_location":{"line":390,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.26","level":1},"title":"Ensure that the --etcd-certfile and --etcd-keyfile arguments are set as appropriate"},{"code":"control 'cis-kubernetes-benchmark-1.1.27' do\n  title 'Ensure that the admission control plugin ServiceAccount is set'\n  desc \"Automate service accounts management.\\n\\nRationale: When you create a pod, if you do not specify a service account, it is automatically assigned the `default` service account in the same namespace. You should create your own service account and let the API server manage its security tokens.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.27'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should_not match(/--disable-admission-plugins=(?:.)*ServiceAccount,*(?:.)*/) }\n  end\nend\n","desc":"Automate service accounts management.\n\nRationale: When you create a pod, if you do not specify a service account, it is automatically assigned the `default` service account in the same namespace. You should create your own service account and let the API server manage its security tokens.","descriptions":{"default":"Automate service accounts management.\n\nRationale: When you create a pod, if you do not specify a service account, it is automatically assigned the `default` service account in the same namespace. You should create your own service account and let the API server manage its security tokens."},"id":"cis-kubernetes-benchmark-1.1.27","impact":1,"refs":[],"source_location":{"line":404,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.27","level":1},"title":"Ensure that the admission control plugin ServiceAccount is set"},{"code":"control 'cis-kubernetes-benchmark-1.1.28' do\n  title 'Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate'\n  desc \"Setup TLS connection on the API server.\\n\\nRationale: API server communication contains sensitive parameters that should remain encrypted in transit. Configure the API server to serve only HTTPS traffic.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.28'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--tls-cert-file=/) }\n    it { should match(/--tls-private-key-file=/) }\n  end\nend\n","desc":"Setup TLS connection on the API server.\n\nRationale: API server communication contains sensitive parameters that should remain encrypted in transit. Configure the API server to serve only HTTPS traffic.","descriptions":{"default":"Setup TLS connection on the API server.\n\nRationale: API server communication contains sensitive parameters that should remain encrypted in transit. Configure the API server to serve only HTTPS traffic."},"id":"cis-kubernetes-benchmark-1.1.28","impact":1,"refs":[],"source_location":{"line":417,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.28","level":1},"title":"Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate"},{"code":"control 'cis-kubernetes-benchmark-1.1.29' do\n  title 'Ensure that the --client-ca-file argument is set as appropriate'\n  desc \"Setup TLS connection on the API server.\\n\\nRationale: API server communication contains sensitive parameters that should remain encrypted in transit. Configure the API server to serve only HTTPS traffic. If `--client-ca-file` argument is set, any request presenting a client certificate signed by one of the authorities in the `client-ca-file` is authenticated with an identity corresponding to the CommonName of the client certificate.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.29'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--client-ca-file=/) }\n  end\nend\n","desc":"Setup TLS connection on the API server.\n\nRationale: API server communication contains sensitive parameters that should remain encrypted in transit. Configure the API server to serve only HTTPS traffic. If `--client-ca-file` argument is set, any request presenting a client certificate signed by one of the authorities in the `client-ca-file` is authenticated with an identity corresponding to the CommonName of the client certificate.","descriptions":{"default":"Setup TLS connection on the API server.\n\nRationale: API server communication contains sensitive parameters that should remain encrypted in transit. Configure the API server to serve only HTTPS traffic. If `--client-ca-file` argument is set, any request presenting a client certificate signed by one of the authorities in the `client-ca-file` is authenticated with an identity corresponding to the CommonName of the client certificate."},"id":"cis-kubernetes-benchmark-1.1.29","impact":1,"refs":[],"source_location":{"line":431,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.29","level":1},"title":"Ensure that the --client-ca-file argument is set as appropriate"},{"code":"control 'cis-kubernetes-benchmark-1.1.30' do\n  title 'Ensure that the API Server only makes use of Strong Cryptographic Ciphers'\n  desc \"Ensure that the API server is configured to only use strong cryptographic ciphers.\\n\\nRationale: TLS ciphers have had a number of known vulnerabilities and weaknesses, which can reduce the protection provided by them. By default Kubernetes supports a number of TLS ciphersuites including some that have security concerns, weakening the protection provided.\"\n  impact 0.0\n\n  tag cis: 'kubernetes:1.1.30'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256/) }\n  end\nend\n","desc":"Ensure that the API server is configured to only use strong cryptographic ciphers.\n\nRationale: TLS ciphers have had a number of known vulnerabilities and weaknesses, which can reduce the protection provided by them. By default Kubernetes supports a number of TLS ciphersuites including some that have security concerns, weakening the protection provided.","descriptions":{"default":"Ensure that the API server is configured to only use strong cryptographic ciphers.\n\nRationale: TLS ciphers have had a number of known vulnerabilities and weaknesses, which can reduce the protection provided by them. By default Kubernetes supports a number of TLS ciphersuites including some that have security concerns, weakening the protection provided."},"id":"cis-kubernetes-benchmark-1.1.30","impact":0,"refs":[],"source_location":{"line":444,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.30","level":1},"title":"Ensure that the API Server only makes use of Strong Cryptographic Ciphers"},{"code":"control 'cis-kubernetes-benchmark-1.1.31' do\n  title 'Ensure that the --etcd-cafile argument is set as appropriate'\n  desc \"etcd should be configured to make use of TLS encryption for client connections.\\n\\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be protected by client authentication. This requires the API server to identify itself to the etcd server using a SSL Certificate Authority file.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.31'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--etcd-cafile/) }\n  end\nend\n","desc":"etcd should be configured to make use of TLS encryption for client connections.\n\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be protected by client authentication. This requires the API server to identify itself to the etcd server using a SSL Certificate Authority file.","descriptions":{"default":"etcd should be configured to make use of TLS encryption for client connections.\n\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be protected by client authentication. This requires the API server to identify itself to the etcd server using a SSL Certificate Authority file."},"id":"cis-kubernetes-benchmark-1.1.31","impact":1,"refs":[],"source_location":{"line":457,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.31","level":1},"title":"Ensure that the --etcd-cafile argument is set as appropriate"},{"code":"control 'cis-kubernetes-benchmark-1.1.32' do\n  title 'Ensure that the --authorization-mode argument includes Node'\n  desc \"Restrict kubelet nodes to reading only objects associated with them.\\n\\nRationale: The Node authorization mode only allows kubelets to read `Secret`, `ConfigMap`, `PersistentVolume`, and `PersistentVolumeClaim` objects associated with their nodes.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.32'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--authorization-mode=(?:.)*Node,*(?:.)*/) }\n  end\nend\n","desc":"Restrict kubelet nodes to reading only objects associated with them.\n\nRationale: The Node authorization mode only allows kubelets to read `Secret`, `ConfigMap`, `PersistentVolume`, and `PersistentVolumeClaim` objects associated with their nodes.","descriptions":{"default":"Restrict kubelet nodes to reading only objects associated with them.\n\nRationale: The Node authorization mode only allows kubelets to read `Secret`, `ConfigMap`, `PersistentVolume`, and `PersistentVolumeClaim` objects associated with their nodes."},"id":"cis-kubernetes-benchmark-1.1.32","impact":1,"refs":[],"source_location":{"line":470,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.32","level":1},"title":"Ensure that the --authorization-mode argument includes Node"},{"code":"control 'cis-kubernetes-benchmark-1.1.33' do\n  title 'Ensure that the admission control plugin NodeRestriction is set'\n  desc \"Limit the `Node` and `Pod` objects that a kubelet could modify.\\n\\nRationale: Using the `NodeRestriction` plug-in ensures that the kubelet is restricted to the `Node` and `Pod` objects that it could modify as defined. Such kubelets will only be allowed to modify their own `Node` API object, and only modify `Pod` API objects that are bound to their node.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.33'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--enable-admission-plugins=(?:.)*NodeRestriction,*(?:.)*/) }\n  end\nend\n","desc":"Limit the `Node` and `Pod` objects that a kubelet could modify.\n\nRationale: Using the `NodeRestriction` plug-in ensures that the kubelet is restricted to the `Node` and `Pod` objects that it could modify as defined. Such kubelets will only be allowed to modify their own `Node` API object, and only modify `Pod` API objects that are bound to their node.","descriptions":{"default":"Limit the `Node` and `Pod` objects that a kubelet could modify.\n\nRationale: Using the `NodeRestriction` plug-in ensures that the kubelet is restricted to the `Node` and `Pod` objects that it could modify as defined. Such kubelets will only be allowed to modify their own `Node` API object, and only modify `Pod` API objects that are bound to their node."},"id":"cis-kubernetes-benchmark-1.1.33","impact":1,"refs":[],"source_location":{"line":483,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.33","level":1},"title":"Ensure that the admission control plugin NodeRestriction is set"},{"code":"control 'cis-kubernetes-benchmark-1.1.34' do\n  title 'Ensure that the --experimental-encryption-provider-config argument is set as appropriate'\n  desc \"Encrypt etcd key-value store.\\n\\nRationale: etcd is a highly available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be encrypted at rest to avoid any disclosures.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.34'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--experimental-encryption-provider-config=/) }\n  end\nend\n","desc":"Encrypt etcd key-value store.\n\nRationale: etcd is a highly available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be encrypted at rest to avoid any disclosures.","descriptions":{"default":"Encrypt etcd key-value store.\n\nRationale: etcd is a highly available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be encrypted at rest to avoid any disclosures."},"id":"cis-kubernetes-benchmark-1.1.34","impact":1,"refs":[],"source_location":{"line":496,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.34","level":1},"title":"Ensure that the --experimental-encryption-provider-config argument is set as appropriate"},{"code":"control 'cis-kubernetes-benchmark-1.1.35' do\n  title 'Ensure that the encryption provider is set to aescbc'\n  desc \"Use `aescbc` encryption provider.\\n\\nRationale: `aescbc` is currently the strongest encryption provider, It should be preferred over other providers.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.35'\n  tag level: 1\n\n  describe 'cis-kubernetes-benchmark-1.1.35' do\n    skip 'Review the `EncryptionConfig` file and verify that `aescbc` is used as the encryption provider.'\n  end\nend\n","desc":"Use `aescbc` encryption provider.\n\nRationale: `aescbc` is currently the strongest encryption provider, It should be preferred over other providers.","descriptions":{"default":"Use `aescbc` encryption provider.\n\nRationale: `aescbc` is currently the strongest encryption provider, It should be preferred over other providers."},"id":"cis-kubernetes-benchmark-1.1.35","impact":1,"refs":[],"source_location":{"line":509,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.35","level":1},"title":"Ensure that the encryption provider is set to aescbc"},{"code":"control 'cis-kubernetes-benchmark-1.1.36' do\n  title 'Ensure that the admission control plugin EventRateLimit is set'\n  desc \"Limit the rate at which the API server accepts requests.\\n\\nRationale: Using `EventRateLimit` admission control enforces a limit on the number of events that the API Server will accept in a given time slice. In a large multi-tenant cluster, there might be a small percentage of misbehaving tenants which could have a significant impact on the performance of the cluster overall. Hence, it is recommended to limit the rate of events that the API server will accept.\\nNote: This is an Alpha feature in the Kubernetes 1.11 release.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.36'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--enable-admission-plugins=(?:.)*EventRateLimit,*(?:.)*/) }\n  end\nend\n","desc":"Limit the rate at which the API server accepts requests.\n\nRationale: Using `EventRateLimit` admission control enforces a limit on the number of events that the API Server will accept in a given time slice. In a large multi-tenant cluster, there might be a small percentage of misbehaving tenants which could have a significant impact on the performance of the cluster overall. Hence, it is recommended to limit the rate of events that the API server will accept.\nNote: This is an Alpha feature in the Kubernetes 1.11 release.","descriptions":{"default":"Limit the rate at which the API server accepts requests.\n\nRationale: Using `EventRateLimit` admission control enforces a limit on the number of events that the API Server will accept in a given time slice. In a large multi-tenant cluster, there might be a small percentage of misbehaving tenants which could have a significant impact on the performance of the cluster overall. Hence, it is recommended to limit the rate of events that the API server will accept.\nNote: This is an Alpha feature in the Kubernetes 1.11 release."},"id":"cis-kubernetes-benchmark-1.1.36","impact":1,"refs":[],"source_location":{"line":522,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.36","level":1},"title":"Ensure that the admission control plugin EventRateLimit is set"},{"code":"control 'cis-kubernetes-benchmark-1.1.37' do\n  title 'Ensure that the AdvancedAuditing argument is not set to false'\n  desc \"Do not disable advanced auditing.\\n\\nRationale: `AdvancedAuditing` enables a much more general API auditing pipeline, which includes support for pluggable output backends and an audit policy specifying how different requests should be audited. Additionally, this enables auditing of failed authentication, authorization and login attempts which could prove crucial for protecting your production clusters. It is thus recommended not to disable advanced auditing.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.37'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should_not match(/--feature-gates=(?:.)*AdvancedAuditing=false,*(?:.)*/) }\n  end\nend\n","desc":"Do not disable advanced auditing.\n\nRationale: `AdvancedAuditing` enables a much more general API auditing pipeline, which includes support for pluggable output backends and an audit policy specifying how different requests should be audited. Additionally, this enables auditing of failed authentication, authorization and login attempts which could prove crucial for protecting your production clusters. It is thus recommended not to disable advanced auditing.","descriptions":{"default":"Do not disable advanced auditing.\n\nRationale: `AdvancedAuditing` enables a much more general API auditing pipeline, which includes support for pluggable output backends and an audit policy specifying how different requests should be audited. Additionally, this enables auditing of failed authentication, authorization and login attempts which could prove crucial for protecting your production clusters. It is thus recommended not to disable advanced auditing."},"id":"cis-kubernetes-benchmark-1.1.37","impact":1,"refs":[],"source_location":{"line":535,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.37","level":1},"title":"Ensure that the AdvancedAuditing argument is not set to false"},{"code":"control 'cis-kubernetes-benchmark-1.1.38' do\n  title 'Ensure that the --request-timeout argument is set as appropriate'\n  desc \"Set global request timeout for API server requests as appropriate.\\n\\nRationale: Setting global request timeout allows extending the API server request timeout limit to a duration appropriate to the user's connection speed. By default, it is set to 60 seconds which might be problematic on slower connections making cluster resources inaccessible once the data volume for requests exceeds what can be transmitted in 60 seconds. But, setting this timeout limit to be too large can exhaust the API server resources making it prone to Denial-of-Service attack. Hence, it is recommended to set this limit as appropriate and change the default limit of 60 seconds only if needed.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.38'\n  tag level: 1\n\n  describe 'cis-kubernetes-benchmark-1.1.38' do\n    skip 'If you have a request timeout set, verify that it is set to an appropriate value'\n  end\nend\n","desc":"Set global request timeout for API server requests as appropriate.\n\nRationale: Setting global request timeout allows extending the API server request timeout limit to a duration appropriate to the user's connection speed. By default, it is set to 60 seconds which might be problematic on slower connections making cluster resources inaccessible once the data volume for requests exceeds what can be transmitted in 60 seconds. But, setting this timeout limit to be too large can exhaust the API server resources making it prone to Denial-of-Service attack. Hence, it is recommended to set this limit as appropriate and change the default limit of 60 seconds only if needed.","descriptions":{"default":"Set global request timeout for API server requests as appropriate.\n\nRationale: Setting global request timeout allows extending the API server request timeout limit to a duration appropriate to the user's connection speed. By default, it is set to 60 seconds which might be problematic on slower connections making cluster resources inaccessible once the data volume for requests exceeds what can be transmitted in 60 seconds. But, setting this timeout limit to be too large can exhaust the API server resources making it prone to Denial-of-Service attack. Hence, it is recommended to set this limit as appropriate and change the default limit of 60 seconds only if needed."},"id":"cis-kubernetes-benchmark-1.1.38","impact":1,"refs":[],"source_location":{"line":548,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.38","level":1},"title":"Ensure that the --request-timeout argument is set as appropriate"},{"code":"control 'cis-kubernetes-benchmark-1.1.39' do\n  title 'Ensure that the --authorization-mode argument includes RBAC'\n  desc \"Turn on Role Based Access Control.\\n\\nRationale: Role Based Access Control (RBAC) allows fine-grained control over the operations that different entities can perform on different objects in the cluster. It is recommended to use the RBAC authorisation mode.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.1.39'\n  tag level: 1\n\n  describe processes(apiserver).commands.to_s do\n    it { should match(/--authorization-mode=(?:.)*RBAC,*(?:.)*/) }\n  end\nend\n","desc":"Turn on Role Based Access Control.\n\nRationale: Role Based Access Control (RBAC) allows fine-grained control over the operations that different entities can perform on different objects in the cluster. It is recommended to use the RBAC authorisation mode.","descriptions":{"default":"Turn on Role Based Access Control.\n\nRationale: Role Based Access Control (RBAC) allows fine-grained control over the operations that different entities can perform on different objects in the cluster. It is recommended to use the RBAC authorisation mode."},"id":"cis-kubernetes-benchmark-1.1.39","impact":1,"refs":[],"source_location":{"line":561,"ref":"cis-kubernetes-benchmark-master/controls/1_1_master_node_api_server.rb"},"tags":{"cis":"kubernetes:1.1.39","level":1},"title":"Ensure that the --authorization-mode argument includes RBAC"},{"code":"control 'cis-kubernetes-benchmark-1.2.1' do\n  title 'Ensure that the --profiling argument is set to false'\n  desc \"Disable profiling, if not needed.\\n\\nRationale: Profiling allows for the identification of specific performance bottlenecks. It generates a significant amount of program data that could potentially be exploited to uncover system and program details. If you are not experiencing any bottlenecks and do not need the profiler for troubleshooting purposes, it is recommended to turn it off to reduce the potential attack surface.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.2.1'\n  tag level: 1\n\n  describe processes(scheduler).commands.to_s do\n    it { should match(/--profiling=false/) }\n  end\nend\n","desc":"Disable profiling, if not needed.\n\nRationale: Profiling allows for the identification of specific performance bottlenecks. It generates a significant amount of program data that could potentially be exploited to uncover system and program details. If you are not experiencing any bottlenecks and do not need the profiler for troubleshooting purposes, it is recommended to turn it off to reduce the potential attack surface.","descriptions":{"default":"Disable profiling, if not needed.\n\nRationale: Profiling allows for the identification of specific performance bottlenecks. It generates a significant amount of program data that could potentially be exploited to uncover system and program details. If you are not experiencing any bottlenecks and do not need the profiler for troubleshooting purposes, it is recommended to turn it off to reduce the potential attack surface."},"id":"cis-kubernetes-benchmark-1.2.1","impact":1,"refs":[],"source_location":{"line":28,"ref":"cis-kubernetes-benchmark-master/controls/1_2_master_node_scheduler.rb"},"tags":{"cis":"kubernetes:1.2.1","level":1},"title":"Ensure that the --profiling argument is set to false"},{"code":"control 'cis-kubernetes-benchmark-1.2.2' do\n  title 'Ensure that the --address argument is set to 127.0.0.1'\n  desc \"Do not bind the scheduler service to non-loopback insecure addresses.\\n\\nRationale: The Scheduler API service which runs on port 10251/TCP by default is used for health and metrics information and is available without authentication or encryption. As such it should only be bound to a localhost interface, to minimize the cluster's attack surface.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.2.2'\n  tag level: 1\n\n  describe.one do\n    describe processes(scheduler).commands.to_s do\n      it { should match(/--address=127\\.0\\.0\\.1/) }\n    end\n    describe processes(scheduler).commands.to_s do\n      it { should match(/--bind-address=127\\.0\\.0\\.1/) }\n    end\n  end\nend\n","desc":"Do not bind the scheduler service to non-loopback insecure addresses.\n\nRationale: The Scheduler API service which runs on port 10251/TCP by default is used for health and metrics information and is available without authentication or encryption. As such it should only be bound to a localhost interface, to minimize the cluster's attack surface.","descriptions":{"default":"Do not bind the scheduler service to non-loopback insecure addresses.\n\nRationale: The Scheduler API service which runs on port 10251/TCP by default is used for health and metrics information and is available without authentication or encryption. As such it should only be bound to a localhost interface, to minimize the cluster's attack surface."},"id":"cis-kubernetes-benchmark-1.2.2","impact":1,"refs":[],"source_location":{"line":41,"ref":"cis-kubernetes-benchmark-master/controls/1_2_master_node_scheduler.rb"},"tags":{"cis":"kubernetes:1.2.2","level":1},"title":"Ensure that the --address argument is set to 127.0.0.1"},{"code":"control 'cis-kubernetes-benchmark-1.3.1' do\n  title 'Ensure that the --terminated-pod-gc-threshold argument is set as appropriate'\n  desc \"Activate garbage collector on pod termination, as appropriate.\\n\\nRationale: Garbage collection is important to ensure sufficient resource availability and avoiding degraded performance and availability. In the worst case, the system might crash or just be unusable for a long period of time. The current setting for garbage collection is 12,500 terminated pods which might be too high for your system to sustain. Based on your system resources and tests, choose an appropriate threshold value to activate garbage collection.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.3.1'\n  tag level: 1\n\n  describe processes(controller_manager).commands.to_s do\n    it { should match(/--terminated-pod-gc-threshold=/) }\n  end\nend\n","desc":"Activate garbage collector on pod termination, as appropriate.\n\nRationale: Garbage collection is important to ensure sufficient resource availability and avoiding degraded performance and availability. In the worst case, the system might crash or just be unusable for a long period of time. The current setting for garbage collection is 12,500 terminated pods which might be too high for your system to sustain. Based on your system resources and tests, choose an appropriate threshold value to activate garbage collection.","descriptions":{"default":"Activate garbage collector on pod termination, as appropriate.\n\nRationale: Garbage collection is important to ensure sufficient resource availability and avoiding degraded performance and availability. In the worst case, the system might crash or just be unusable for a long period of time. The current setting for garbage collection is 12,500 terminated pods which might be too high for your system to sustain. Based on your system resources and tests, choose an appropriate threshold value to activate garbage collection."},"id":"cis-kubernetes-benchmark-1.3.1","impact":1,"refs":[],"source_location":{"line":28,"ref":"cis-kubernetes-benchmark-master/controls/1_3_master_node_controller_manager.rb"},"tags":{"cis":"kubernetes:1.3.1","level":1},"title":"Ensure that the --terminated-pod-gc-threshold argument is set as appropriate"},{"code":"control 'cis-kubernetes-benchmark-1.3.2' do\n  title 'Ensure that the --profiling argument is set to false'\n  desc \"Disable profiling, if not needed.\\n\\nRationale: Profiling allows for the identification of specific performance bottlenecks. It generates a significant amount of program data that could potentially be exploited to uncover system and program details. If you are not experiencing any bottlenecks and do not need the profiler for troubleshooting purposes, it is recommended to turn it off to reduce the potential attack surface.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.3.2'\n  tag level: 1\n\n  describe processes(controller_manager).commands.to_s do\n    it { should match(/--profiling=false/) }\n  end\nend\n","desc":"Disable profiling, if not needed.\n\nRationale: Profiling allows for the identification of specific performance bottlenecks. It generates a significant amount of program data that could potentially be exploited to uncover system and program details. If you are not experiencing any bottlenecks and do not need the profiler for troubleshooting purposes, it is recommended to turn it off to reduce the potential attack surface.","descriptions":{"default":"Disable profiling, if not needed.\n\nRationale: Profiling allows for the identification of specific performance bottlenecks. It generates a significant amount of program data that could potentially be exploited to uncover system and program details. If you are not experiencing any bottlenecks and do not need the profiler for troubleshooting purposes, it is recommended to turn it off to reduce the potential attack surface."},"id":"cis-kubernetes-benchmark-1.3.2","impact":1,"refs":[],"source_location":{"line":41,"ref":"cis-kubernetes-benchmark-master/controls/1_3_master_node_controller_manager.rb"},"tags":{"cis":"kubernetes:1.3.2","level":1},"title":"Ensure that the --profiling argument is set to false"},{"code":"control 'cis-kubernetes-benchmark-1.3.3' do\n  title 'Ensure that the --use-service-account-credentials argument is set to true'\n  desc \"Use individual service account credentials for each controller.\\n\\nRationale: The controller manager creates a service account per controller in the `kube-system` namespace, generates a credential for it, and builds a dedicated API client with that service account credential for each controller loop to use. Setting the `--use-service-account-credentials` to `true` runs each control loop within the controller manager using a separate service account credential. When used in combination with RBAC, this ensures that the control loops run with the minimum permissions required to perform their intended tasks.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.3.3'\n  tag level: 1\n\n  describe processes(controller_manager).commands.to_s do\n    it { should match(/--use-service-account-credentials=true/) }\n  end\nend\n","desc":"Use individual service account credentials for each controller.\n\nRationale: The controller manager creates a service account per controller in the `kube-system` namespace, generates a credential for it, and builds a dedicated API client with that service account credential for each controller loop to use. Setting the `--use-service-account-credentials` to `true` runs each control loop within the controller manager using a separate service account credential. When used in combination with RBAC, this ensures that the control loops run with the minimum permissions required to perform their intended tasks.","descriptions":{"default":"Use individual service account credentials for each controller.\n\nRationale: The controller manager creates a service account per controller in the `kube-system` namespace, generates a credential for it, and builds a dedicated API client with that service account credential for each controller loop to use. Setting the `--use-service-account-credentials` to `true` runs each control loop within the controller manager using a separate service account credential. When used in combination with RBAC, this ensures that the control loops run with the minimum permissions required to perform their intended tasks."},"id":"cis-kubernetes-benchmark-1.3.3","impact":1,"refs":[],"source_location":{"line":54,"ref":"cis-kubernetes-benchmark-master/controls/1_3_master_node_controller_manager.rb"},"tags":{"cis":"kubernetes:1.3.3","level":1},"title":"Ensure that the --use-service-account-credentials argument is set to true"},{"code":"control 'cis-kubernetes-benchmark-1.3.4' do\n  title 'Ensure that the --service-account-private-key-file argument is set as appropriate'\n  desc \"Explicitly set a service account private key file for service accounts on the controller manager.\\n\\nRationale: To ensure that keys for service account tokens can be rotated as needed, a separate public/private key pair should be used for signing service account tokens. The private key should be specified to the controller manager with `--service-account-private-key-file` as appropriate.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.3.4'\n  tag level: 1\n\n  describe processes(controller_manager).commands.to_s do\n    it { should match(/--service-account-private-key-file=/) }\n  end\nend\n","desc":"Explicitly set a service account private key file for service accounts on the controller manager.\n\nRationale: To ensure that keys for service account tokens can be rotated as needed, a separate public/private key pair should be used for signing service account tokens. The private key should be specified to the controller manager with `--service-account-private-key-file` as appropriate.","descriptions":{"default":"Explicitly set a service account private key file for service accounts on the controller manager.\n\nRationale: To ensure that keys for service account tokens can be rotated as needed, a separate public/private key pair should be used for signing service account tokens. The private key should be specified to the controller manager with `--service-account-private-key-file` as appropriate."},"id":"cis-kubernetes-benchmark-1.3.4","impact":1,"refs":[],"source_location":{"line":67,"ref":"cis-kubernetes-benchmark-master/controls/1_3_master_node_controller_manager.rb"},"tags":{"cis":"kubernetes:1.3.4","level":1},"title":"Ensure that the --service-account-private-key-file argument is set as appropriate"},{"code":"control 'cis-kubernetes-benchmark-1.3.5' do\n  title 'Ensure that the --root-ca-file argument is set as appropriate'\n  desc \"Allow pods to verify the API server's serving certificate before establishing connections.\\n\\nRationale: Processes running within pods that need to contact the API server must verify the API server's serving certificate. Failing to do so could be a subject to man-in-the-middle attacks. Providing the root certificate for the API server's serving certificate to the controller manager with the `--root-ca-file` argument allows the controller manager to inject the trusted bundle into pods so that they can verify TLS connections to the API server.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.3.5'\n  tag level: 1\n\n  describe processes(controller_manager).commands.to_s do\n    it { should match(/--root-ca-file=/) }\n  end\nend\n","desc":"Allow pods to verify the API server's serving certificate before establishing connections.\n\nRationale: Processes running within pods that need to contact the API server must verify the API server's serving certificate. Failing to do so could be a subject to man-in-the-middle attacks. Providing the root certificate for the API server's serving certificate to the controller manager with the `--root-ca-file` argument allows the controller manager to inject the trusted bundle into pods so that they can verify TLS connections to the API server.","descriptions":{"default":"Allow pods to verify the API server's serving certificate before establishing connections.\n\nRationale: Processes running within pods that need to contact the API server must verify the API server's serving certificate. Failing to do so could be a subject to man-in-the-middle attacks. Providing the root certificate for the API server's serving certificate to the controller manager with the `--root-ca-file` argument allows the controller manager to inject the trusted bundle into pods so that they can verify TLS connections to the API server."},"id":"cis-kubernetes-benchmark-1.3.5","impact":1,"refs":[],"source_location":{"line":80,"ref":"cis-kubernetes-benchmark-master/controls/1_3_master_node_controller_manager.rb"},"tags":{"cis":"kubernetes:1.3.5","level":1},"title":"Ensure that the --root-ca-file argument is set as appropriate"},{"code":"control 'cis-kubernetes-benchmark-1.3.6' do\n  title 'Ensure that the RotateKubeletServerCertificate argument is set to true'\n  desc \"Enable kubelet server certificate rotation on controller-manager.\\n\\nRationale: `RotateKubeletServerCertificate` causes the kubelet to both request a serving certificate after bootstrapping its client credentials and rotate the certificate as its existing credentials expire. This automated periodic rotation ensures that the there are no downtimes due to expired certificates and thus addressing availability in the CIA security triad.\\nNote: This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.3.6'\n  tag level: 1\n\n  describe processes(controller_manager).commands.to_s do\n    it { should match(/--feature-gates=(?:.)*RotateKubeletServerCertificate=true,*(?:.)*/) }\n  end\nend\n","desc":"Enable kubelet server certificate rotation on controller-manager.\n\nRationale: `RotateKubeletServerCertificate` causes the kubelet to both request a serving certificate after bootstrapping its client credentials and rotate the certificate as its existing credentials expire. This automated periodic rotation ensures that the there are no downtimes due to expired certificates and thus addressing availability in the CIA security triad.\nNote: This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself.","descriptions":{"default":"Enable kubelet server certificate rotation on controller-manager.\n\nRationale: `RotateKubeletServerCertificate` causes the kubelet to both request a serving certificate after bootstrapping its client credentials and rotate the certificate as its existing credentials expire. This automated periodic rotation ensures that the there are no downtimes due to expired certificates and thus addressing availability in the CIA security triad.\nNote: This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself."},"id":"cis-kubernetes-benchmark-1.3.6","impact":1,"refs":[],"source_location":{"line":93,"ref":"cis-kubernetes-benchmark-master/controls/1_3_master_node_controller_manager.rb"},"tags":{"cis":"kubernetes:1.3.6","level":1},"title":"Ensure that the RotateKubeletServerCertificate argument is set to true"},{"code":"control 'cis-kubernetes-benchmark-1.3.7' do\n  title 'Ensure that the --address argument is set to 127.0.0.1'\n  desc \"Do not bind the Controller Manager service to non-loopback insecure addresses.\\n\\nRationale: The Controller Manager API service which runs on port 10252/TCP by default is used for health and metrics information and is available without authentication or encryption. As such it should only be bound to a localhost interface, to minimize the cluster's attack surface.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.3.7'\n  tag level: 1\n\n  describe.one do\n    describe processes(controller_manager).commands.to_s do\n      it { should match(/--address=127\\.0\\.0\\.1/) }\n    end\n    describe processes(controller_manager).commands.to_s do\n      it { should match(/--bind-address=127\\.0\\.0\\.1/) }\n    end\n  end\nend\n","desc":"Do not bind the Controller Manager service to non-loopback insecure addresses.\n\nRationale: The Controller Manager API service which runs on port 10252/TCP by default is used for health and metrics information and is available without authentication or encryption. As such it should only be bound to a localhost interface, to minimize the cluster's attack surface.","descriptions":{"default":"Do not bind the Controller Manager service to non-loopback insecure addresses.\n\nRationale: The Controller Manager API service which runs on port 10252/TCP by default is used for health and metrics information and is available without authentication or encryption. As such it should only be bound to a localhost interface, to minimize the cluster's attack surface."},"id":"cis-kubernetes-benchmark-1.3.7","impact":1,"refs":[],"source_location":{"line":106,"ref":"cis-kubernetes-benchmark-master/controls/1_3_master_node_controller_manager.rb"},"tags":{"cis":"kubernetes:1.3.7","level":1},"title":"Ensure that the --address argument is set to 127.0.0.1"},{"code":"control 'cis-kubernetes-benchmark-1.4.1' do\n  title 'Ensure that the API server pod specification file permissions are set to 644 or more restrictive'\n  desc \"Ensure that the API server pod specification file has permissions of `644` or more restrictive.\\n\\nRationale: The API server pod specification file controls various parameters that set the behavior of the API server. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.4.1'\n  tag level: 1\n\n  only_if do\n    file('/etc/kubernetes/manifests/kube-apiserver.yaml').exist?\n  end\n\n  describe file('/etc/kubernetes/manifests/kube-apiserver.yaml').mode.to_s(8) do\n    it { should match(/[0246][024][024]/) }\n  end\nend\n","desc":"Ensure that the API server pod specification file has permissions of `644` or more restrictive.\n\nRationale: The API server pod specification file controls various parameters that set the behavior of the API server. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.","descriptions":{"default":"Ensure that the API server pod specification file has permissions of `644` or more restrictive.\n\nRationale: The API server pod specification file controls various parameters that set the behavior of the API server. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system."},"id":"cis-kubernetes-benchmark-1.4.1","impact":1,"refs":[],"source_location":{"line":20,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.1","level":1},"title":"Ensure that the API server pod specification file permissions are set to 644 or more restrictive"},{"code":"control 'cis-kubernetes-benchmark-1.4.2' do\n  title 'Ensure that the API server pod specification file ownership is set to root:root'\n  desc \"Ensure that the API server pod specification file ownership is set to `root:root`.\\n\\nRationale: The API server pod specification file controls various parameters that set the behavior of the API server. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.4.2'\n  tag level: 1\n\n  only_if do\n    file('/etc/kubernetes/manifests/kube-apiserver.yaml').exist?\n  end\n\n  describe file('/etc/kubernetes/manifests/kube-apiserver.yaml') do\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n  end\nend\n","desc":"Ensure that the API server pod specification file ownership is set to `root:root`.\n\nRationale: The API server pod specification file controls various parameters that set the behavior of the API server. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.","descriptions":{"default":"Ensure that the API server pod specification file ownership is set to `root:root`.\n\nRationale: The API server pod specification file controls various parameters that set the behavior of the API server. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`."},"id":"cis-kubernetes-benchmark-1.4.2","impact":1,"refs":[],"source_location":{"line":37,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.2","level":1},"title":"Ensure that the API server pod specification file ownership is set to root:root"},{"code":"control 'cis-kubernetes-benchmark-1.4.3' do\n  title 'Ensure that the controller manager pod specification file permissions are set to 644 or more restrictive'\n  desc \"Ensure that the controller manager pod specification file has permissions of `644` or more restrictive.\\n\\nRationale: The controller manager pod specification file controls various parameters that set the behavior of the Controller Manager on the master node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.4.3'\n  tag level: 1\n\n  only_if do\n    file('/etc/kubernetes/manifests/kube-controller-manager.yaml').exist?\n  end\n\n  describe file('/etc/kubernetes/manifests/kube-controller-manager.yaml').mode.to_s(8) do\n    it { should match(/[0246][024][024]/) }\n  end\nend\n","desc":"Ensure that the controller manager pod specification file has permissions of `644` or more restrictive.\n\nRationale: The controller manager pod specification file controls various parameters that set the behavior of the Controller Manager on the master node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.","descriptions":{"default":"Ensure that the controller manager pod specification file has permissions of `644` or more restrictive.\n\nRationale: The controller manager pod specification file controls various parameters that set the behavior of the Controller Manager on the master node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system."},"id":"cis-kubernetes-benchmark-1.4.3","impact":1,"refs":[],"source_location":{"line":55,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.3","level":1},"title":"Ensure that the controller manager pod specification file permissions are set to 644 or more restrictive"},{"code":"control 'cis-kubernetes-benchmark-1.4.4' do\n  title 'Ensure that the controller manager pod specification file ownership is set to root:root'\n  desc \"Ensure that the controller manager pod specification file ownership is set to `root:root`.\\n\\nRationale: The controller manager pod specification file controls various parameters that set the behavior of various components of the master node. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.4.4'\n  tag level: 1\n\n  only_if do\n    file('/etc/kubernetes/manifests/kube-controller-manager.yaml').exist?\n  end\n\n  describe file('/etc/kubernetes/manifests/kube-controller-manager.yaml') do\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n  end\nend\n","desc":"Ensure that the controller manager pod specification file ownership is set to `root:root`.\n\nRationale: The controller manager pod specification file controls various parameters that set the behavior of various components of the master node. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.","descriptions":{"default":"Ensure that the controller manager pod specification file ownership is set to `root:root`.\n\nRationale: The controller manager pod specification file controls various parameters that set the behavior of various components of the master node. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`."},"id":"cis-kubernetes-benchmark-1.4.4","impact":1,"refs":[],"source_location":{"line":72,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.4","level":1},"title":"Ensure that the controller manager pod specification file ownership is set to root:root"},{"code":"control 'cis-kubernetes-benchmark-1.4.5' do\n  title 'Ensure that the scheduler pod specification file permissions are set to 644 or more restrictive'\n  desc \"Ensure that the scheduler pod specification file has permissions of `644` or more restrictive.\\n\\nRationale: The scheduler pod specification file controls various parameters that set the behavior of the Scheduler service in the master node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.4.5'\n  tag level: 1\n\n  only_if do\n    file('/etc/kubernetes/manifests/kube-scheduler.yaml').exist?\n  end\n\n  describe file('/etc/kubernetes/manifests/kube-scheduler.yaml').mode.to_s(8) do\n    it { should match(/[0246][024][024]/) }\n  end\nend\n","desc":"Ensure that the scheduler pod specification file has permissions of `644` or more restrictive.\n\nRationale: The scheduler pod specification file controls various parameters that set the behavior of the Scheduler service in the master node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.","descriptions":{"default":"Ensure that the scheduler pod specification file has permissions of `644` or more restrictive.\n\nRationale: The scheduler pod specification file controls various parameters that set the behavior of the Scheduler service in the master node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system."},"id":"cis-kubernetes-benchmark-1.4.5","impact":1,"refs":[],"source_location":{"line":90,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.5","level":1},"title":"Ensure that the scheduler pod specification file permissions are set to 644 or more restrictive"},{"code":"control 'cis-kubernetes-benchmark-1.4.6' do\n  title 'Ensure that the scheduler pod specification file ownership is set to root:root'\n  desc \"Ensure that the scheduler pod specification file ownership is set to `root:root`.\\n\\nRationale: The scheduler pod specification file controls various parameters that set the behavior of the `kube-scheduler` service in the master node. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.4.6'\n  tag level: 1\n\n  only_if do\n    file('/etc/kubernetes/manifests/kube-scheduler.yaml').exist?\n  end\n\n  describe file('/etc/kubernetes/manifests/kube-scheduler.yaml') do\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n  end\nend\n","desc":"Ensure that the scheduler pod specification file ownership is set to `root:root`.\n\nRationale: The scheduler pod specification file controls various parameters that set the behavior of the `kube-scheduler` service in the master node. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.","descriptions":{"default":"Ensure that the scheduler pod specification file ownership is set to `root:root`.\n\nRationale: The scheduler pod specification file controls various parameters that set the behavior of the `kube-scheduler` service in the master node. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`."},"id":"cis-kubernetes-benchmark-1.4.6","impact":1,"refs":[],"source_location":{"line":107,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.6","level":1},"title":"Ensure that the scheduler pod specification file ownership is set to root:root"},{"code":"control 'cis-kubernetes-benchmark-1.4.7' do\n  title 'Ensure that the etcd pod specification file permissions are set to 644 or more restrictive'\n  desc \"Ensure that the `/etc/kubernetes/manifests/etcd.yaml` file has permissions of `644` or more restrictive.\\n\\nRationale: The etcd pod specification file `/etc/kubernetes/manifests/etcd.yaml` controls various parameters that set the behavior of the `etcd` service in the master node. etcd is a highly-available key-value store which Kubernetes uses for persistent storage of all of its REST API object. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.4.7'\n  tag level: 1\n\n  only_if do\n    file('/etc/kubernetes/manifests/etcd.yaml').exist?\n  end\n\n  describe file('/etc/kubernetes/manifests/etcd.yaml').mode.to_s(8) do\n    it { should match(/[0246][024][024]/) }\n  end\nend\n","desc":"Ensure that the `/etc/kubernetes/manifests/etcd.yaml` file has permissions of `644` or more restrictive.\n\nRationale: The etcd pod specification file `/etc/kubernetes/manifests/etcd.yaml` controls various parameters that set the behavior of the `etcd` service in the master node. etcd is a highly-available key-value store which Kubernetes uses for persistent storage of all of its REST API object. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.","descriptions":{"default":"Ensure that the `/etc/kubernetes/manifests/etcd.yaml` file has permissions of `644` or more restrictive.\n\nRationale: The etcd pod specification file `/etc/kubernetes/manifests/etcd.yaml` controls various parameters that set the behavior of the `etcd` service in the master node. etcd is a highly-available key-value store which Kubernetes uses for persistent storage of all of its REST API object. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system."},"id":"cis-kubernetes-benchmark-1.4.7","impact":1,"refs":[],"source_location":{"line":125,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.7","level":1},"title":"Ensure that the etcd pod specification file permissions are set to 644 or more restrictive"},{"code":"control 'cis-kubernetes-benchmark-1.4.8' do\n  title 'Ensure that the etcd pod specification file ownership is set to root:root'\n  desc \"Ensure that the `/etc/kubernetes/manifests/etcd.yaml` file ownership is set to `root:root`.\\n\\nRationale: The etcd pod specification file `/etc/kubernetes/manifests/etcd.yaml` controls various parameters that set the behavior of the `etcd` service in the master node. etcd is a highly-available key-value store which Kubernetes uses for persistent storage of all of its REST API object. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.4.8'\n  tag level: 1\n\n  only_if do\n    file('/etc/kubernetes/manifests/etcd.yaml').exist?\n  end\n\n  describe file('/etc/kubernetes/manifests/etcd.yaml') do\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n  end\nend\n","desc":"Ensure that the `/etc/kubernetes/manifests/etcd.yaml` file ownership is set to `root:root`.\n\nRationale: The etcd pod specification file `/etc/kubernetes/manifests/etcd.yaml` controls various parameters that set the behavior of the `etcd` service in the master node. etcd is a highly-available key-value store which Kubernetes uses for persistent storage of all of its REST API object. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.","descriptions":{"default":"Ensure that the `/etc/kubernetes/manifests/etcd.yaml` file ownership is set to `root:root`.\n\nRationale: The etcd pod specification file `/etc/kubernetes/manifests/etcd.yaml` controls various parameters that set the behavior of the `etcd` service in the master node. etcd is a highly-available key-value store which Kubernetes uses for persistent storage of all of its REST API object. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`."},"id":"cis-kubernetes-benchmark-1.4.8","impact":1,"refs":[],"source_location":{"line":142,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.8","level":1},"title":"Ensure that the etcd pod specification file ownership is set to root:root"},{"code":"control 'cis-kubernetes-benchmark-1.4.9' do\n  title 'Ensure that the Container Network Interface file permissions are set to 644 or more restrictive'\n  desc \"Ensure that the Container Network Interface files have permissions of `644` or more restrictive.\\n\\nRationale: Container Network Interface provides various networking options for overlay networking. You should consult their documentation and restrict their respective file permissions to maintain the integrity of those files. Those files should be writable by only the administrators on the system.\"\n  impact 0.0\n\n  tag cis: 'kubernetes:1.4.9'\n  tag level: 1\n\n  if file('/etc/sysconfig/flanneld').exist?\n    describe file('/etc/sysconfig/flanneld').mode.to_s(8) do\n      it { should match(/[0246][024][024]/) }\n    end\n  else\n    describe 'cis-kubernetes-benchmark-1.4.9' do\n      skip 'Review the permissions on your CNI configuration file(s).'\n    end\n  end\n\nend\n","desc":"Ensure that the Container Network Interface files have permissions of `644` or more restrictive.\n\nRationale: Container Network Interface provides various networking options for overlay networking. You should consult their documentation and restrict their respective file permissions to maintain the integrity of those files. Those files should be writable by only the administrators on the system.","descriptions":{"default":"Ensure that the Container Network Interface files have permissions of `644` or more restrictive.\n\nRationale: Container Network Interface provides various networking options for overlay networking. You should consult their documentation and restrict their respective file permissions to maintain the integrity of those files. Those files should be writable by only the administrators on the system."},"id":"cis-kubernetes-benchmark-1.4.9","impact":0,"refs":[],"source_location":{"line":160,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.9","level":1},"title":"Ensure that the Container Network Interface file permissions are set to 644 or more restrictive"},{"code":"control 'cis-kubernetes-benchmark-1.4.10' do\n  title 'Ensure that the Container Network Interface file ownership is set to root:root'\n  desc \"Ensure that the Container Network Interface files have ownership set to `root:root`.\\n\\nRationale: Container Network Interface provides various networking options for overlay networking. You should consult their documentation and restrict their respective file permissions to maintain the integrity of those files. Those files should be owned by `root:root`.\"\n  impact 0.0\n\n  tag cis: 'kubernetes:1.4.10'\n  tag level: 1\n\n  if file('/etc/sysconfig/flanneld').exist?\n    describe file('/etc/sysconfig/flanneld') do\n      it { should be_owned_by 'root' }\n      it { should be_grouped_into 'root' }\n    end\n  else\n    describe 'cis-kubernetes-benchmark-1.4.10' do\n      skip 'Review the ownership of your CNI configuration file(s).'\n    end\n  end\nend\n","desc":"Ensure that the Container Network Interface files have ownership set to `root:root`.\n\nRationale: Container Network Interface provides various networking options for overlay networking. You should consult their documentation and restrict their respective file permissions to maintain the integrity of those files. Those files should be owned by `root:root`.","descriptions":{"default":"Ensure that the Container Network Interface files have ownership set to `root:root`.\n\nRationale: Container Network Interface provides various networking options for overlay networking. You should consult their documentation and restrict their respective file permissions to maintain the integrity of those files. Those files should be owned by `root:root`."},"id":"cis-kubernetes-benchmark-1.4.10","impact":0,"refs":[],"source_location":{"line":180,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.10","level":1},"title":"Ensure that the Container Network Interface file ownership is set to root:root"},{"code":"control 'cis-kubernetes-benchmark-1.4.11' do\n  title 'Ensure that the etcd data directory permissions are set to 700 or more restrictive'\n  desc \"Ensure that the etcd data directory has permissions of `700` or more restrictive.\\n\\nRationale: etcd is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes. It should not be readable or writable by any group members or the world.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.4.11'\n  tag level: 1\n\n  etcd_process = processes(Regexp.new(%r{/usr/bin/etcd}))\n  data_dir = ''\n\n  catch(:stop) do\n    if etcd_process.exists?\n      if (data_dir = etcd_process.commands.to_s.scan(/--data-dir=(\\S+)/).last)\n        data_dir = data_dir.first\n        throw :stop\n      end\n\n      if (data_dir = file(\"/proc/#{etcd_process.pids.first}/environ\").content.split(\"\\0\").select { |i| i[/^ETCD_DATA_DIR/] }.first.to_s.split('=', 2).last.to_s)\n        throw :stop\n      end\n    end\n  end\n\n  if !data_dir.empty?\n    describe file(data_dir).mode.to_s(8) do\n      it { should match(/[01234567]00/) }\n    end\n  else\n    describe 'cis-kubernetes-benchmark-1.4.11' do\n      skip 'etcd data directory not found'\n    end\n  end\nend\n","desc":"Ensure that the etcd data directory has permissions of `700` or more restrictive.\n\nRationale: etcd is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes. It should not be readable or writable by any group members or the world.","descriptions":{"default":"Ensure that the etcd data directory has permissions of `700` or more restrictive.\n\nRationale: etcd is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes. It should not be readable or writable by any group members or the world."},"id":"cis-kubernetes-benchmark-1.4.11","impact":1,"refs":[],"source_location":{"line":200,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.11","level":1},"title":"Ensure that the etcd data directory permissions are set to 700 or more restrictive"},{"code":"control 'cis-kubernetes-benchmark-1.4.12' do\n  title 'Ensure that the etcd data directory ownership is set to etcd:etcd'\n  desc \"Ensure that the etcd data directory ownership is set to `etcd:etcd`.\\n\\nRationale: etcd is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes. It should be owned by `etcd:etcd`.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.4.12'\n  tag level: 1\n\n  etcd_process = processes(Regexp.new(%r{/usr/bin/etcd}))\n  data_dir = ''\n\n  catch(:stop) do\n    if etcd_process.exists?\n      if (data_dir = etcd_process.commands.to_s.scan(/--data-dir=(\\S+)/).last)\n        data_dir = data_dir.first\n        throw :stop\n      end\n\n      if (data_dir = file(\"/proc/#{etcd_process.pids.first}/environ\").content.split(\"\\0\").select { |i| i[/^ETCD_DATA_DIR/] }.first.to_s.split('=', 2).last.to_s)\n        throw :stop\n      end\n    end\n  end\n\n  if !data_dir.empty?\n    describe file(data_dir) do\n      it { should be_owned_by 'etcd' }\n      it { should be_grouped_into 'etcd' }\n    end\n  else\n    describe 'cis-kubernetes-benchmark-1.4.12' do\n      skip 'etcd data directory not found'\n    end\n  end\nend\n","desc":"Ensure that the etcd data directory ownership is set to `etcd:etcd`.\n\nRationale: etcd is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes. It should be owned by `etcd:etcd`.","descriptions":{"default":"Ensure that the etcd data directory ownership is set to `etcd:etcd`.\n\nRationale: etcd is a highly-available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. This data directory should be protected from any unauthorized reads or writes. It should be owned by `etcd:etcd`."},"id":"cis-kubernetes-benchmark-1.4.12","impact":1,"refs":[],"source_location":{"line":235,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.12","level":1},"title":"Ensure that the etcd data directory ownership is set to etcd:etcd"},{"code":"control 'cis-kubernetes-benchmark-1.4.13' do\n  title 'Ensure that the admin.conf file permissions are set to 644 or more restrictive'\n  desc \"Ensure that the `admin.conf` file has permissions of `644` or more restrictive.\\n\\nRationale: The `admin.conf` is the administrator kubeconfig file defining various settings for the administration of the cluster. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.4.13'\n  tag level: 1\n\n  only_if do\n    file('/etc/kubernetes/admin.conf').exist?\n  end\n\n  describe file('/etc/kubernetes/admin.conf').mode.to_s(8) do\n    it { should match(/[0246][024][024]/) }\n  end\nend\n","desc":"Ensure that the `admin.conf` file has permissions of `644` or more restrictive.\n\nRationale: The `admin.conf` is the administrator kubeconfig file defining various settings for the administration of the cluster. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.","descriptions":{"default":"Ensure that the `admin.conf` file has permissions of `644` or more restrictive.\n\nRationale: The `admin.conf` is the administrator kubeconfig file defining various settings for the administration of the cluster. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system."},"id":"cis-kubernetes-benchmark-1.4.13","impact":1,"refs":[],"source_location":{"line":271,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.13","level":1},"title":"Ensure that the admin.conf file permissions are set to 644 or more restrictive"},{"code":"control 'cis-kubernetes-benchmark-1.4.14' do\n  title 'Ensure that the admin.conf file ownership is set to root:root'\n  desc \"Ensure that the `admin.conf` file ownership is set to `root:root`.\\n\\nRationale: The `admin.conf` file contains the admin credentials for the cluster. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.4.14'\n  tag level: 1\n\n  only_if do\n    file('/etc/kubernetes/admin.conf').exist?\n  end\n\n  describe file('/etc/kubernetes/admin.conf') do\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n  end\nend\n","desc":"Ensure that the `admin.conf` file ownership is set to `root:root`.\n\nRationale: The `admin.conf` file contains the admin credentials for the cluster. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.","descriptions":{"default":"Ensure that the `admin.conf` file ownership is set to `root:root`.\n\nRationale: The `admin.conf` file contains the admin credentials for the cluster. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`."},"id":"cis-kubernetes-benchmark-1.4.14","impact":1,"refs":[],"source_location":{"line":288,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.14","level":1},"title":"Ensure that the admin.conf file ownership is set to root:root"},{"code":"control 'cis-kubernetes-benchmark-1.4.15' do\n  title 'Ensure that the scheduler.conf file has permissions of 644 or more restrictive'\n  desc \"Ensure that the `scheduler.conf` file has permissions of `644` or more restrictive.\\n\\nRationale: The `scheduler.conf` file is the kubeconfig file for the Scheduler. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.4.15'\n  tag level: 1\n\n  only_if do\n    file('/etc/kubernetes/scheduler.conf').exist?\n  end\n\n  describe file('/etc/kubernetes/scheduler.conf').mode.to_s(8) do\n    it { should match(/[0246][024][024]/) }\n  end\nend\n","desc":"Ensure that the `scheduler.conf` file has permissions of `644` or more restrictive.\n\nRationale: The `scheduler.conf` file is the kubeconfig file for the Scheduler. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.","descriptions":{"default":"Ensure that the `scheduler.conf` file has permissions of `644` or more restrictive.\n\nRationale: The `scheduler.conf` file is the kubeconfig file for the Scheduler. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system."},"id":"cis-kubernetes-benchmark-1.4.15","impact":1,"refs":[],"source_location":{"line":306,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.15","level":1},"title":"Ensure that the scheduler.conf file has permissions of 644 or more restrictive"},{"code":"control 'cis-kubernetes-benchmark-1.4.16' do\n  title 'Ensure that the scheduler.conf file ownership is set to root:root'\n  desc \"Ensure that the `scheduler.conf` file ownership is set to `root:root`.\\n\\nRationale: The `scheduler.conf` file is the kubeconfig file for the Scheduler. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.4.16'\n  tag level: 1\n\n  only_if do\n    file('/etc/kubernetes/scheduler.conf').exist?\n  end\n\n  describe file('/etc/kubernetes/scheduler.conf') do\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n  end\nend\n","desc":"Ensure that the `scheduler.conf` file ownership is set to `root:root`.\n\nRationale: The `scheduler.conf` file is the kubeconfig file for the Scheduler. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.","descriptions":{"default":"Ensure that the `scheduler.conf` file ownership is set to `root:root`.\n\nRationale: The `scheduler.conf` file is the kubeconfig file for the Scheduler. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`."},"id":"cis-kubernetes-benchmark-1.4.16","impact":1,"refs":[],"source_location":{"line":323,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.16","level":1},"title":"Ensure that the scheduler.conf file ownership is set to root:root"},{"code":"control 'cis-kubernetes-benchmark-1.4.17' do\n  title 'Ensure that the controller-manager.conf file permissions are set to 644 or more restrictive'\n  desc \"Ensure that the `controller-manager.conf` file has permissions of 644 or more restrictive.\\n\\nRationale: The `controller-manager.conf` file is the kubeconfig file for the Controller Manager. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.4.17'\n  tag level: 1\n\n  only_if do\n    file('/etc/kubernetes/controller-manager.conf').exist?\n  end\n\n  describe file('/etc/kubernetes/controller-manager.conf').mode.to_s(8) do\n    it { should match(/[0246][024][024]/) }\n  end\nend\n","desc":"Ensure that the `controller-manager.conf` file has permissions of 644 or more restrictive.\n\nRationale: The `controller-manager.conf` file is the kubeconfig file for the Controller Manager. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.","descriptions":{"default":"Ensure that the `controller-manager.conf` file has permissions of 644 or more restrictive.\n\nRationale: The `controller-manager.conf` file is the kubeconfig file for the Controller Manager. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system."},"id":"cis-kubernetes-benchmark-1.4.17","impact":1,"refs":[],"source_location":{"line":341,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.17","level":1},"title":"Ensure that the controller-manager.conf file permissions are set to 644 or more restrictive"},{"code":"control 'cis-kubernetes-benchmark-1.4.18' do\n  title 'Ensure that the controller-manager.conf file ownership is set to root:root'\n  desc \"Ensure that the `controller-manager.conf` file ownership is set to `root:root`.\\n\\nRationale: The `controller-manager.conf` file is the kubeconfig file for the Controller Manager. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.4.18'\n  tag level: 1\n\n  only_if do\n    file('/etc/kubernetes/controller-manager.conf').exist?\n  end\n\n  describe file('/etc/kubernetes/controller-manager.conf') do\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n  end\nend\n","desc":"Ensure that the `controller-manager.conf` file ownership is set to `root:root`.\n\nRationale: The `controller-manager.conf` file is the kubeconfig file for the Controller Manager. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.","descriptions":{"default":"Ensure that the `controller-manager.conf` file ownership is set to `root:root`.\n\nRationale: The `controller-manager.conf` file is the kubeconfig file for the Controller Manager. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`."},"id":"cis-kubernetes-benchmark-1.4.18","impact":1,"refs":[],"source_location":{"line":358,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.18","level":1},"title":"Ensure that the controller-manager.conf file ownership is set to root:root"},{"code":"control 'cis-kubernetes-benchmark-1.4.19' do\n  title 'Ensure that the Kubernetes PKI directory and file ownership is set to root:root'\n  desc \"Ensure that the Kubernetes PKI directory and file ownership is set to `root:root`.\\n\\nRationale: Kubernetes makes use of a number of certificates as part of its operation. You should set the ownership of the directory containing the PKI information and all files in that directory to maintain their integrity. The directory and files should be owned by `root:root`.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.4.19'\n  tag level: 1\n\n  only_if do\n    directory('/etc/kubernetes/pki').exist?\n  end\n\n  describe directory('/etc/kubernetes/pki') do\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n  end\nend\n","desc":"Ensure that the Kubernetes PKI directory and file ownership is set to `root:root`.\n\nRationale: Kubernetes makes use of a number of certificates as part of its operation. You should set the ownership of the directory containing the PKI information and all files in that directory to maintain their integrity. The directory and files should be owned by `root:root`.","descriptions":{"default":"Ensure that the Kubernetes PKI directory and file ownership is set to `root:root`.\n\nRationale: Kubernetes makes use of a number of certificates as part of its operation. You should set the ownership of the directory containing the PKI information and all files in that directory to maintain their integrity. The directory and files should be owned by `root:root`."},"id":"cis-kubernetes-benchmark-1.4.19","impact":1,"refs":[],"source_location":{"line":376,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.19","level":1},"title":"Ensure that the Kubernetes PKI directory and file ownership is set to root:root"},{"code":"control 'cis-kubernetes-benchmark-1.4.20' do\n  title 'Ensure that the Kubernetes PKI certificate file permissions are set to 644 or more restrictive'\n  desc \"Ensure that Kubernetes PKI certificate files have permissions of `644` or more restrictive.\\n\\nRationale: Kubernetes makes use of a number of certificate files as part of the operation of its components. The permissions on these files should be set to `644` or more restrictive to protect their integrity.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.4.20'\n  tag level: 1\n\n  only_if do\n    directory('/etc/kubernetes/pki').exist?\n  end\n\n  cert_files = command('find /etc/kubernetes/pki -type f -name *.crt').stdout.split\n  if cert_files.empty?\n    describe 'cis-kubernetes-benchmark-1.4.20' do\n      skip 'No certificate files found'\n    end\n  else\n    cert_files.each do |cert|\n      describe file(cert).mode.to_s(8) do\n        it { should match(/[0246][024][024]/) }\n      end\n    end\n  end\nend\n","desc":"Ensure that Kubernetes PKI certificate files have permissions of `644` or more restrictive.\n\nRationale: Kubernetes makes use of a number of certificate files as part of the operation of its components. The permissions on these files should be set to `644` or more restrictive to protect their integrity.","descriptions":{"default":"Ensure that Kubernetes PKI certificate files have permissions of `644` or more restrictive.\n\nRationale: Kubernetes makes use of a number of certificate files as part of the operation of its components. The permissions on these files should be set to `644` or more restrictive to protect their integrity."},"id":"cis-kubernetes-benchmark-1.4.20","impact":1,"refs":[],"source_location":{"line":394,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.20","level":1},"title":"Ensure that the Kubernetes PKI certificate file permissions are set to 644 or more restrictive"},{"code":"control 'cis-kubernetes-benchmark-1.4.21' do\n  title 'Ensure that the Kubernetes PKI key file permissions are set to 600'\n  desc \"Ensure that Kubernetes PKI key files have permissions of `600`.\\n\\nRationale: Kubernetes makes use of a number of key files as part of the operation of its components. The permissions on these files should be set to `600` to protect their integrity and confidentiality.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.4.21'\n  tag level: 1\n\n  only_if do\n    directory('/etc/kubernetes/pki').exist?\n  end\n\n  key_files = command('find /etc/kubernetes/pki -type f -name *.key').stdout.split\n  if key_files.empty?\n    describe 'cis-kubernetes-benchmark-1.4.21' do\n      skip 'No private key files found'\n    end\n  else\n    key_files.each do |key|\n      describe file(key) do\n        its('mode') { should cmp '0600' }\n      end\n    end\n  end\nend\n","desc":"Ensure that Kubernetes PKI key files have permissions of `600`.\n\nRationale: Kubernetes makes use of a number of key files as part of the operation of its components. The permissions on these files should be set to `600` to protect their integrity and confidentiality.","descriptions":{"default":"Ensure that Kubernetes PKI key files have permissions of `600`.\n\nRationale: Kubernetes makes use of a number of key files as part of the operation of its components. The permissions on these files should be set to `600` to protect their integrity and confidentiality."},"id":"cis-kubernetes-benchmark-1.4.21","impact":1,"refs":[],"source_location":{"line":420,"ref":"cis-kubernetes-benchmark-master/controls/1_4_master_node_configuration_files.rb"},"tags":{"cis":"kubernetes:1.4.21","level":1},"title":"Ensure that the Kubernetes PKI key file permissions are set to 600"},{"code":"control 'cis-kubernetes-benchmark-1.5.1' do\n  title 'Ensure that the --cert-file and --key-file arguments are set as appropriate'\n  desc \"Configure TLS encryption for the etcd service.\\n\\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be encrypted in transit.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.5.1'\n  tag level: 1\n\n  describe.one do\n    describe etcd_process.commands.to_s do\n      it { should match(/--cert-file=/) }\n    end\n\n    describe etcd_env_vars do\n      its(:ETCD_CERT_FILE) { should_not be_empty }\n    end\n  end\n\n  describe.one do\n    describe etcd_process.commands.to_s do\n      it { should match(/--key-file=/) }\n    end\n\n    describe etcd_env_vars do\n      its(:ETCD_KEY_FILE) { should_not be_empty }\n    end\n  end\nend\n","desc":"Configure TLS encryption for the etcd service.\n\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be encrypted in transit.","descriptions":{"default":"Configure TLS encryption for the etcd service.\n\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be encrypted in transit."},"id":"cis-kubernetes-benchmark-1.5.1","impact":1,"refs":[],"source_location":{"line":28,"ref":"cis-kubernetes-benchmark-master/controls/1_5_master_node_etcd.rb"},"tags":{"cis":"kubernetes:1.5.1","level":1},"title":"Ensure that the --cert-file and --key-file arguments are set as appropriate"},{"code":"control 'cis-kubernetes-benchmark-1.5.2' do\n  title 'Ensure that the --client-cert-auth argument is set to true'\n  desc \"Enable client authentication on etcd service.\\n\\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should not be available to unauthenticated clients. You should enable the client authentication via valid certificates to secure the access to the etcd service.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.5.2'\n  tag level: 1\n\n  describe.one do\n    describe etcd_process.commands.to_s do\n      it { should match(/--client-cert-auth=true/) }\n    end\n\n    describe etcd_env_vars do\n      its(:ETCD_CLIENT_CERT_AUTH) { should_not be_empty }\n    end\n  end\nend\n","desc":"Enable client authentication on etcd service.\n\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should not be available to unauthenticated clients. You should enable the client authentication via valid certificates to secure the access to the etcd service.","descriptions":{"default":"Enable client authentication on etcd service.\n\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should not be available to unauthenticated clients. You should enable the client authentication via valid certificates to secure the access to the etcd service."},"id":"cis-kubernetes-benchmark-1.5.2","impact":1,"refs":[],"source_location":{"line":57,"ref":"cis-kubernetes-benchmark-master/controls/1_5_master_node_etcd.rb"},"tags":{"cis":"kubernetes:1.5.2","level":1},"title":"Ensure that the --client-cert-auth argument is set to true"},{"code":"control 'cis-kubernetes-benchmark-1.5.3' do\n  title 'Ensure that the --auto-tls argument is not set to true'\n  desc \"Do not use self-signed certificates for TLS.\\n\\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should not be available to unauthenticated clients. You should enable the client authentication via valid certificates to secure the access to the etcd service.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.5.3'\n  tag level: 1\n\n  describe etcd_process.commands.to_s do\n    it { should_not match(/--auto-tls=true/) }\n  end\nend\n","desc":"Do not use self-signed certificates for TLS.\n\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should not be available to unauthenticated clients. You should enable the client authentication via valid certificates to secure the access to the etcd service.","descriptions":{"default":"Do not use self-signed certificates for TLS.\n\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should not be available to unauthenticated clients. You should enable the client authentication via valid certificates to secure the access to the etcd service."},"id":"cis-kubernetes-benchmark-1.5.3","impact":1,"refs":[],"source_location":{"line":76,"ref":"cis-kubernetes-benchmark-master/controls/1_5_master_node_etcd.rb"},"tags":{"cis":"kubernetes:1.5.3","level":1},"title":"Ensure that the --auto-tls argument is not set to true"},{"code":"control 'cis-kubernetes-benchmark-1.5.4' do\n  title 'Ensure that the --peer-cert-file and --peer-key-file arguments are set as appropriate'\n  desc \"etcd should be configured to make use of TLS encryption for peer connections.\\n\\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be encrypted in transit and also amongst peers in the etcd clusters.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.5.4'\n  tag level: 1\n\n  describe.one do\n    describe etcd_process.commands.to_s do\n      it { should match(/--peer-cert-file=/) }\n    end\n\n    describe etcd_env_vars do\n      its(:ETCD_PEER_CERT_FILE) { should_not be_empty }\n    end\n  end\n\n  describe.one do\n    describe etcd_process.commands.to_s do\n      it { should match(/--peer-key-file=/) }\n    end\n\n    describe etcd_env_vars do\n      its(:ETCD_PEER_KEY_FILE) { should_not be_empty }\n    end\n  end\nend\n","desc":"etcd should be configured to make use of TLS encryption for peer connections.\n\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be encrypted in transit and also amongst peers in the etcd clusters.","descriptions":{"default":"etcd should be configured to make use of TLS encryption for peer connections.\n\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be encrypted in transit and also amongst peers in the etcd clusters."},"id":"cis-kubernetes-benchmark-1.5.4","impact":1,"refs":[],"source_location":{"line":89,"ref":"cis-kubernetes-benchmark-master/controls/1_5_master_node_etcd.rb"},"tags":{"cis":"kubernetes:1.5.4","level":1},"title":"Ensure that the --peer-cert-file and --peer-key-file arguments are set as appropriate"},{"code":"control 'cis-kubernetes-benchmark-1.5.5' do\n  title 'Ensure that the --peer-client-cert-auth argument is set to true'\n  desc \"etcd should be configured for peer authentication.\\n\\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be accessible only by authenticated etcd peers in the etcd cluster.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.5.5'\n  tag level: 1\n\n  describe.one do\n    describe etcd_process.commands.to_s do\n      it { should match(/--peer-client-cert-auth=true/) }\n    end\n\n    describe etcd_env_vars do\n      its(:ETCD_PEER_CLIENT_CERT_AUTH) { should_not be_empty }\n    end\n  end\nend\n","desc":"etcd should be configured for peer authentication.\n\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be accessible only by authenticated etcd peers in the etcd cluster.","descriptions":{"default":"etcd should be configured for peer authentication.\n\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be accessible only by authenticated etcd peers in the etcd cluster."},"id":"cis-kubernetes-benchmark-1.5.5","impact":1,"refs":[],"source_location":{"line":118,"ref":"cis-kubernetes-benchmark-master/controls/1_5_master_node_etcd.rb"},"tags":{"cis":"kubernetes:1.5.5","level":1},"title":"Ensure that the --peer-client-cert-auth argument is set to true"},{"code":"control 'cis-kubernetes-benchmark-1.5.6' do\n  title 'Ensure that the --peer-auto-tls argument is not set to true'\n  desc \"Do not use automatically generated self-signed certificates for TLS connections between peers.\\n\\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be accessible only by authenticated etcd peers in the etcd cluster. Hence, do not use self-signed certificates for authentication.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.5.6'\n  tag level: 1\n\n  describe etcd_process.commands.to_s do\n    it { should_not match(/--peer-auto-tls=true/) }\n  end\nend\n","desc":"Do not use automatically generated self-signed certificates for TLS connections between peers.\n\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be accessible only by authenticated etcd peers in the etcd cluster. Hence, do not use self-signed certificates for authentication.","descriptions":{"default":"Do not use automatically generated self-signed certificates for TLS connections between peers.\n\nRationale: etcd is a highly-available key value store used by Kubernetes deployments for persistent storage of all of its REST API objects. These objects are sensitive in nature and should be accessible only by authenticated etcd peers in the etcd cluster. Hence, do not use self-signed certificates for authentication."},"id":"cis-kubernetes-benchmark-1.5.6","impact":1,"refs":[],"source_location":{"line":137,"ref":"cis-kubernetes-benchmark-master/controls/1_5_master_node_etcd.rb"},"tags":{"cis":"kubernetes:1.5.6","level":1},"title":"Ensure that the --peer-auto-tls argument is not set to true"},{"code":"control 'cis-kubernetes-benchmark-1.5.9' do\n  title 'Ensure that a unique Certificate Authority is used for etcd'\n  desc \"Use a different certificate authority for etcd from the one used for Kubernetes.\\n\\nRationale: etcd is a highly available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. Its access should be restricted to specifically designated clients and peers only.\\nAuthentication to etcd is based on whether the certificate presented was issued by a trusted certificate authority. There is no checking of certificate attributes such as common name or subject alternative name. As such, if any attackers were able to gain access to any certificate issued by the trusted certificate authority, they would be able to gain full access to the etcd database.\"\n  impact 0.0\n\n  tag cis: 'kubernetes:1.5.9'\n  tag level: 2\n\n  only_if {  cis_level == 2 }\n\n  describe 'cis-kubernetes-benchmark-1.5.9' do\n    skip 'Review if the CA used for etcd is different from the one used for Kubernetes'\n  end\nend\n","desc":"Use a different certificate authority for etcd from the one used for Kubernetes.\n\nRationale: etcd is a highly available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. Its access should be restricted to specifically designated clients and peers only.\nAuthentication to etcd is based on whether the certificate presented was issued by a trusted certificate authority. There is no checking of certificate attributes such as common name or subject alternative name. As such, if any attackers were able to gain access to any certificate issued by the trusted certificate authority, they would be able to gain full access to the etcd database.","descriptions":{"default":"Use a different certificate authority for etcd from the one used for Kubernetes.\n\nRationale: etcd is a highly available key-value store used by Kubernetes deployments for persistent storage of all of its REST API objects. Its access should be restricted to specifically designated clients and peers only.\nAuthentication to etcd is based on whether the certificate presented was issued by a trusted certificate authority. There is no checking of certificate attributes such as common name or subject alternative name. As such, if any attackers were able to gain access to any certificate issued by the trusted certificate authority, they would be able to gain full access to the etcd database."},"id":"cis-kubernetes-benchmark-1.5.9","impact":0,"refs":[],"source_location":{"line":150,"ref":"cis-kubernetes-benchmark-master/controls/1_5_master_node_etcd.rb"},"tags":{"cis":"kubernetes:1.5.9","level":2},"title":"Ensure that a unique Certificate Authority is used for etcd"},{"code":"control 'cis-kubernetes-benchmark-1.6.1' do\n  title 'Ensure that the cluster-admin role is only used where required'\n  desc \"The RBAC role `cluster-admin` provides wide-ranging powers over the environment and should be used only where and when needed.\\n\\nRationale: Kubernetes provides a set of default roles where RBAC is used. Some of these roles such as `cluster-admin` provide wide-ranging privileges which should only be applied where absolutely necessary. Roles such as `cluster-admin` allow super-user access to perform any action on any resource. When used in a `ClusterRoleBinding`, it gives full control over every resource in the cluster and in all namespaces. When used in a `RoleBinding`, it gives full control over every resource in the rolebinding's namespace, including the namespace itself.\"\n  impact 0.0\n\n  tag cis: 'kubernetes:1.6.1'\n  tag level: 1\n\n  describe 'cis-kubernetes-benchmark-1.6.1' do\n    skip 'Review the output of `kubectl get clusterrolebindings -o=custom-columns=NAME:.metadata.name,ROLE:.roleRef.name,SUBJECT:.subjects[*].name` and ensure the listed principals require `cluster-admin` privileges.'\n  end\nend\n","desc":"The RBAC role `cluster-admin` provides wide-ranging powers over the environment and should be used only where and when needed.\n\nRationale: Kubernetes provides a set of default roles where RBAC is used. Some of these roles such as `cluster-admin` provide wide-ranging privileges which should only be applied where absolutely necessary. Roles such as `cluster-admin` allow super-user access to perform any action on any resource. When used in a `ClusterRoleBinding`, it gives full control over every resource in the cluster and in all namespaces. When used in a `RoleBinding`, it gives full control over every resource in the rolebinding's namespace, including the namespace itself.","descriptions":{"default":"The RBAC role `cluster-admin` provides wide-ranging powers over the environment and should be used only where and when needed.\n\nRationale: Kubernetes provides a set of default roles where RBAC is used. Some of these roles such as `cluster-admin` provide wide-ranging privileges which should only be applied where absolutely necessary. Roles such as `cluster-admin` allow super-user access to perform any action on any resource. When used in a `ClusterRoleBinding`, it gives full control over every resource in the cluster and in all namespaces. When used in a `RoleBinding`, it gives full control over every resource in the rolebinding's namespace, including the namespace itself."},"id":"cis-kubernetes-benchmark-1.6.1","impact":0,"refs":[],"source_location":{"line":22,"ref":"cis-kubernetes-benchmark-master/controls/1_6_master_node_general_security_primitives.rb"},"tags":{"cis":"kubernetes:1.6.1","level":1},"title":"Ensure that the cluster-admin role is only used where required"},{"code":"control 'cis-kubernetes-benchmark-1.6.2' do\n  title 'Create administrative boundaries between resources using namespaces'\n  desc \"Use namespaces to isolate your Kubernetes objects.\\n\\nRationale: Limiting the scope of user permissions can reduce the impact of mistakes or malicious activities. A Kubernetes namespace allows you to partition created resources into logically named groups. Resources created in one namespace can be hidden from other namespaces. By default, each resource created by a user in Kubernetes cluster runs in a default namespace, called `default`. You can create additional namespaces and attach resources and users to them. You can use Kubernetes Authorization plugins to create policies that segregate access to namespace resources between different users.\"\n  impact 0.0\n\n  tag cis: 'kubernetes:1.6.2'\n  tag level: 1\n\n  describe 'cis-kubernetes-benchmark-1.6.2' do\n    skip 'Review the output of `kubectl get namespaces` and ensure they are the ones you need.'\n  end\nend\n","desc":"Use namespaces to isolate your Kubernetes objects.\n\nRationale: Limiting the scope of user permissions can reduce the impact of mistakes or malicious activities. A Kubernetes namespace allows you to partition created resources into logically named groups. Resources created in one namespace can be hidden from other namespaces. By default, each resource created by a user in Kubernetes cluster runs in a default namespace, called `default`. You can create additional namespaces and attach resources and users to them. You can use Kubernetes Authorization plugins to create policies that segregate access to namespace resources between different users.","descriptions":{"default":"Use namespaces to isolate your Kubernetes objects.\n\nRationale: Limiting the scope of user permissions can reduce the impact of mistakes or malicious activities. A Kubernetes namespace allows you to partition created resources into logically named groups. Resources created in one namespace can be hidden from other namespaces. By default, each resource created by a user in Kubernetes cluster runs in a default namespace, called `default`. You can create additional namespaces and attach resources and users to them. You can use Kubernetes Authorization plugins to create policies that segregate access to namespace resources between different users."},"id":"cis-kubernetes-benchmark-1.6.2","impact":0,"refs":[],"source_location":{"line":35,"ref":"cis-kubernetes-benchmark-master/controls/1_6_master_node_general_security_primitives.rb"},"tags":{"cis":"kubernetes:1.6.2","level":1},"title":"Create administrative boundaries between resources using namespaces"},{"code":"control 'cis-kubernetes-benchmark-1.6.3' do\n  title 'Create network segmentation using Network Policies'\n  desc \"Use network policies to isolate your cluster network.\\n\\nRationale: Running different applications on the same Kubernetes cluster creates a risk of one compromised application attacking a neighboring application. Network segmentation is important to ensure that containers can communicate only with those they are supposed to. A network policy is a specification of how selections of pods are allowed to communicate with each other and other network endpoints. `NetworkPolicy` resources use labels to select pods and define whitelist rules which allow traffic to the selected pods in addition to what is allowed by the isolation policy for a given namespace.\"\n  impact 0.0\n\n  tag cis: 'kubernetes:1.6.3'\n  tag level: 2\n\n  only_if {  cis_level == 2 }\n\n  describe 'cis-kubernetes-benchmark-1.6.3' do\n    skip 'Review the output of `kubectl get networkpolicy --namespace=kube-system` and ensure the `NetworkPolicy` objects are the ones you need.'\n  end\nend\n","desc":"Use network policies to isolate your cluster network.\n\nRationale: Running different applications on the same Kubernetes cluster creates a risk of one compromised application attacking a neighboring application. Network segmentation is important to ensure that containers can communicate only with those they are supposed to. A network policy is a specification of how selections of pods are allowed to communicate with each other and other network endpoints. `NetworkPolicy` resources use labels to select pods and define whitelist rules which allow traffic to the selected pods in addition to what is allowed by the isolation policy for a given namespace.","descriptions":{"default":"Use network policies to isolate your cluster network.\n\nRationale: Running different applications on the same Kubernetes cluster creates a risk of one compromised application attacking a neighboring application. Network segmentation is important to ensure that containers can communicate only with those they are supposed to. A network policy is a specification of how selections of pods are allowed to communicate with each other and other network endpoints. `NetworkPolicy` resources use labels to select pods and define whitelist rules which allow traffic to the selected pods in addition to what is allowed by the isolation policy for a given namespace."},"id":"cis-kubernetes-benchmark-1.6.3","impact":0,"refs":[],"source_location":{"line":48,"ref":"cis-kubernetes-benchmark-master/controls/1_6_master_node_general_security_primitives.rb"},"tags":{"cis":"kubernetes:1.6.3","level":2},"title":"Create network segmentation using Network Policies"},{"code":"control 'cis-kubernetes-benchmark-1.6.4' do\n  title 'Ensure that the seccomp profile is set to docker/default in your pod definitions'\n  desc \"Enable `docker/default` seccomp profile in your pod definitions.\\n\\nRationale: Seccomp (secure computing mode) is used to restrict the set of system calls applications can make, allowing cluster administrators greater control over the security of workloads running in the cluster. Kubernetes disables seccomp profiles by default for historical reasons. You should enable it to ensure that the workloads have restricted actions available within the container.\"\n  impact 0.0\n\n  tag cis: 'kubernetes:1.6.4'\n  tag level: 2\n\n  only_if {  cis_level == 2 }\n\n  describe 'cis-kubernetes-benchmark-1.6.4' do\n    skip 'Review all the pod definitions in your cluster and verify that `seccomp` is enabled.'\n  end\nend\n","desc":"Enable `docker/default` seccomp profile in your pod definitions.\n\nRationale: Seccomp (secure computing mode) is used to restrict the set of system calls applications can make, allowing cluster administrators greater control over the security of workloads running in the cluster. Kubernetes disables seccomp profiles by default for historical reasons. You should enable it to ensure that the workloads have restricted actions available within the container.","descriptions":{"default":"Enable `docker/default` seccomp profile in your pod definitions.\n\nRationale: Seccomp (secure computing mode) is used to restrict the set of system calls applications can make, allowing cluster administrators greater control over the security of workloads running in the cluster. Kubernetes disables seccomp profiles by default for historical reasons. You should enable it to ensure that the workloads have restricted actions available within the container."},"id":"cis-kubernetes-benchmark-1.6.4","impact":0,"refs":[],"source_location":{"line":63,"ref":"cis-kubernetes-benchmark-master/controls/1_6_master_node_general_security_primitives.rb"},"tags":{"cis":"kubernetes:1.6.4","level":2},"title":"Ensure that the seccomp profile is set to docker/default in your pod definitions"},{"code":"control 'cis-kubernetes-benchmark-1.6.5' do\n  title 'Apply Security Context to Your Pods and Containers'\n  desc \"Apply Security Context to Your Pods and Containers\\n\\nRationale: A security context defines the operating system security settings (uid, gid, capabilities, SELinux role, etc..) applied to a container. When designing your containers and pods, make sure that you configure the security context for your pods, containers, and volumes. A security context is a property defined in the deployment yaml. It controls the security parameters that will be assigned to the pod/container/volume. There are two levels of security context: pod level security context, and container level security context.\"\n  impact 0.0\n\n  tag cis: 'kubernetes:1.6.5'\n  tag level: 2\n\n  only_if {  cis_level == 2 }\n\n  describe 'cis-kubernetes-benchmark-1.6.6' do\n    skip 'Review the pod definitions in your cluster and verify that you have security contexts defined as appropriate.'\n  end\nend\n","desc":"Apply Security Context to Your Pods and Containers\n\nRationale: A security context defines the operating system security settings (uid, gid, capabilities, SELinux role, etc..) applied to a container. When designing your containers and pods, make sure that you configure the security context for your pods, containers, and volumes. A security context is a property defined in the deployment yaml. It controls the security parameters that will be assigned to the pod/container/volume. There are two levels of security context: pod level security context, and container level security context.","descriptions":{"default":"Apply Security Context to Your Pods and Containers\n\nRationale: A security context defines the operating system security settings (uid, gid, capabilities, SELinux role, etc..) applied to a container. When designing your containers and pods, make sure that you configure the security context for your pods, containers, and volumes. A security context is a property defined in the deployment yaml. It controls the security parameters that will be assigned to the pod/container/volume. There are two levels of security context: pod level security context, and container level security context."},"id":"cis-kubernetes-benchmark-1.6.5","impact":0,"refs":[],"source_location":{"line":78,"ref":"cis-kubernetes-benchmark-master/controls/1_6_master_node_general_security_primitives.rb"},"tags":{"cis":"kubernetes:1.6.5","level":2},"title":"Apply Security Context to Your Pods and Containers"},{"code":"control 'cis-kubernetes-benchmark-1.6.6' do\n  title 'Configure Image Provenance using ImagePolicyWebhook admission controller'\n  desc \"Configure Image Provenance for your deployment.\\n\\nRationale: Kubernetes supports plugging in provenance rules to accept or reject the images in your deployments. You could configure such rules to ensure that only approved images are deployed in the cluster.\"\n  impact 0.0\n\n  tag cis: 'kubernetes:1.6.6'\n  tag level: 2\n\n  only_if {  cis_level == 2 }\n\n  describe 'cis-kubernetes-benchmark-1.6.6' do\n    skip 'Review the pod definitions in your cluster and verify that image provenance is configured as appropriate.'\n  end\nend\n","desc":"Configure Image Provenance for your deployment.\n\nRationale: Kubernetes supports plugging in provenance rules to accept or reject the images in your deployments. You could configure such rules to ensure that only approved images are deployed in the cluster.","descriptions":{"default":"Configure Image Provenance for your deployment.\n\nRationale: Kubernetes supports plugging in provenance rules to accept or reject the images in your deployments. You could configure such rules to ensure that only approved images are deployed in the cluster."},"id":"cis-kubernetes-benchmark-1.6.6","impact":0,"refs":[],"source_location":{"line":93,"ref":"cis-kubernetes-benchmark-master/controls/1_6_master_node_general_security_primitives.rb"},"tags":{"cis":"kubernetes:1.6.6","level":2},"title":"Configure Image Provenance using ImagePolicyWebhook admission controller"},{"code":"control 'cis-kubernetes-benchmark-1.6.7' do\n  title 'Configure Network policies as appropriate'\n  desc \"Configure Network policies as appropriate.\\n\\nRationale: The Network Policy API is now stable. Network policy, implemented through a network plug-in, allows users to set and enforce rules governing which pods can communicate with each other. You should leverage it as appropriate in your environment.\"\n  impact 0.0\n\n  tag cis: 'kubernetes:1.6.7'\n  tag level: 2\n\n  only_if {  cis_level == 2 }\n\n  describe 'cis-kubernetes-benchmark-1.6.7' do\n    skip 'Review the network policies enforced and ensure that they are suitable for your requirements.'\n  end\nend\n","desc":"Configure Network policies as appropriate.\n\nRationale: The Network Policy API is now stable. Network policy, implemented through a network plug-in, allows users to set and enforce rules governing which pods can communicate with each other. You should leverage it as appropriate in your environment.","descriptions":{"default":"Configure Network policies as appropriate.\n\nRationale: The Network Policy API is now stable. Network policy, implemented through a network plug-in, allows users to set and enforce rules governing which pods can communicate with each other. You should leverage it as appropriate in your environment."},"id":"cis-kubernetes-benchmark-1.6.7","impact":0,"refs":[],"source_location":{"line":108,"ref":"cis-kubernetes-benchmark-master/controls/1_6_master_node_general_security_primitives.rb"},"tags":{"cis":"kubernetes:1.6.7","level":2},"title":"Configure Network policies as appropriate"},{"code":"control 'cis-kubernetes-benchmark-1.6.8' do\n  title 'Place compensating controls in the form of PSP and RBAC for privileged containers usage'\n  desc \"Use Pod Security Policies (PSP) and RBAC authorization to mitigate the risk arising from using privileged containers.\\n\\nRationale: A number of components used by Kubernetes clusters currently make use of privileged containers (e.g. Container Network Interface plugins). Privileged containers pose a risk to the underlying host infrastructure. You should use PSP and RBAC or other forms of authorization to mitigate the risk arising out of such privileged container usage. PSPs should be in place to restrict access to create privileged containers to specific roles only, and access to those roles should be restricted using RBAC role bindings.\"\n  impact 0.0\n\n  tag cis: 'kubernetes:1.6.8'\n  tag level: 2\n\n  only_if {  cis_level == 2 }\n\n  describe 'cis-kubernetes-benchmark-1.6.8' do\n    skip 'Review Pod Security Policies and RBAC authorization.'\n  end\nend\n","desc":"Use Pod Security Policies (PSP) and RBAC authorization to mitigate the risk arising from using privileged containers.\n\nRationale: A number of components used by Kubernetes clusters currently make use of privileged containers (e.g. Container Network Interface plugins). Privileged containers pose a risk to the underlying host infrastructure. You should use PSP and RBAC or other forms of authorization to mitigate the risk arising out of such privileged container usage. PSPs should be in place to restrict access to create privileged containers to specific roles only, and access to those roles should be restricted using RBAC role bindings.","descriptions":{"default":"Use Pod Security Policies (PSP) and RBAC authorization to mitigate the risk arising from using privileged containers.\n\nRationale: A number of components used by Kubernetes clusters currently make use of privileged containers (e.g. Container Network Interface plugins). Privileged containers pose a risk to the underlying host infrastructure. You should use PSP and RBAC or other forms of authorization to mitigate the risk arising out of such privileged container usage. PSPs should be in place to restrict access to create privileged containers to specific roles only, and access to those roles should be restricted using RBAC role bindings."},"id":"cis-kubernetes-benchmark-1.6.8","impact":0,"refs":[],"source_location":{"line":123,"ref":"cis-kubernetes-benchmark-master/controls/1_6_master_node_general_security_primitives.rb"},"tags":{"cis":"kubernetes:1.6.8","level":2},"title":"Place compensating controls in the form of PSP and RBAC for privileged containers usage"},{"code":"control 'cis-kubernetes-benchmark-1.7.1' do\n  title 'Do not admit privileged containers'\n  desc \"Do not generally permit containers to be run with the `securityContext.privileged` flag set to `true`.\\n\\nRationale: Privileged containers have access to all Linux Kernel capabilities and devices. A container running with full privileges can do almost everything that the host can do. This flag exists to allow special use-cases, like manipulating the network stack and accessing devices.\\nThere should be at least one PodSecurityPolicy (PSP) defined which does not permit privileged containers.\\nIf you need to run privileged containers, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.\"\n  impact 0.0\n\n  tag cis: 'kubernetes:1.7.1'\n  tag level: 1\n\n  describe 'cis-kubernetes-benchmark-1.7.1' do\n    skip \"For each PSP review the output of `kubectl get psp \u003cname\u003e -o=jsonpath='{.spec.priveged}'` and verify at least one is not set to `true`.\"\n  end\nend\n","desc":"Do not generally permit containers to be run with the `securityContext.privileged` flag set to `true`.\n\nRationale: Privileged containers have access to all Linux Kernel capabilities and devices. A container running with full privileges can do almost everything that the host can do. This flag exists to allow special use-cases, like manipulating the network stack and accessing devices.\nThere should be at least one PodSecurityPolicy (PSP) defined which does not permit privileged containers.\nIf you need to run privileged containers, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.","descriptions":{"default":"Do not generally permit containers to be run with the `securityContext.privileged` flag set to `true`.\n\nRationale: Privileged containers have access to all Linux Kernel capabilities and devices. A container running with full privileges can do almost everything that the host can do. This flag exists to allow special use-cases, like manipulating the network stack and accessing devices.\nThere should be at least one PodSecurityPolicy (PSP) defined which does not permit privileged containers.\nIf you need to run privileged containers, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP."},"id":"cis-kubernetes-benchmark-1.7.1","impact":0,"refs":[],"source_location":{"line":22,"ref":"cis-kubernetes-benchmark-master/controls/1_7_master_node_pod_security_policies.rb"},"tags":{"cis":"kubernetes:1.7.1","level":1},"title":"Do not admit privileged containers"},{"code":"control 'cis-kubernetes-benchmark-1.7.2' do\n  title 'Do not admit containers wishing to share the host process ID namespace'\n  desc \"Do not generally permit containers to be run with the `hostPID` flag set to true.\\n\\nRationale: A container running in the host's PID namespace can inspect processes running outside the container. If the container also has access to ptrace capabilities this can be used to escalate privileges outside of the container.\\nThere should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to share the host PID namespace.\\nIf you need to run containers which require hostPID, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.7.2'\n  tag level: 1\n\n  describe 'cis-kubernetes-benchmark-1.7.2' do\n    skip \"For each PSP review the output of `kubectl get psp \u003cname\u003e -o=jsonpath='{.spec.hostPID}'` and verify at least one is not set to `true`.\"\n  end\nend\n","desc":"Do not generally permit containers to be run with the `hostPID` flag set to true.\n\nRationale: A container running in the host's PID namespace can inspect processes running outside the container. If the container also has access to ptrace capabilities this can be used to escalate privileges outside of the container.\nThere should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to share the host PID namespace.\nIf you need to run containers which require hostPID, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.","descriptions":{"default":"Do not generally permit containers to be run with the `hostPID` flag set to true.\n\nRationale: A container running in the host's PID namespace can inspect processes running outside the container. If the container also has access to ptrace capabilities this can be used to escalate privileges outside of the container.\nThere should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to share the host PID namespace.\nIf you need to run containers which require hostPID, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP."},"id":"cis-kubernetes-benchmark-1.7.2","impact":1,"refs":[],"source_location":{"line":35,"ref":"cis-kubernetes-benchmark-master/controls/1_7_master_node_pod_security_policies.rb"},"tags":{"cis":"kubernetes:1.7.2","level":1},"title":"Do not admit containers wishing to share the host process ID namespace"},{"code":"control 'cis-kubernetes-benchmark-1.7.3' do\n  title 'Do not admit containers wishing to share the host IPC namespace'\n  desc \"Do not generally permit containers to be run with the `hostIPC` flag set to true.\\n\\nRationale: A container running in the host's IPC namespace can use IPC to interact with processes outside the container.\\nThere should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to share the host IPC namespace.\\nIf you have a requirement to containers which require hostIPC, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.7.3'\n  tag level: 1\n\n  describe 'cis-kubernetes-benchmark-1.7.3' do\n    skip \"For each PSP review the output of `kubectl get psp \u003cname\u003e -o=jsonpath='{.spec.hostIPC}'` and verify at least one is not set to `true`.\"\n  end\nend\n","desc":"Do not generally permit containers to be run with the `hostIPC` flag set to true.\n\nRationale: A container running in the host's IPC namespace can use IPC to interact with processes outside the container.\nThere should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to share the host IPC namespace.\nIf you have a requirement to containers which require hostIPC, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.","descriptions":{"default":"Do not generally permit containers to be run with the `hostIPC` flag set to true.\n\nRationale: A container running in the host's IPC namespace can use IPC to interact with processes outside the container.\nThere should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to share the host IPC namespace.\nIf you have a requirement to containers which require hostIPC, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP."},"id":"cis-kubernetes-benchmark-1.7.3","impact":1,"refs":[],"source_location":{"line":48,"ref":"cis-kubernetes-benchmark-master/controls/1_7_master_node_pod_security_policies.rb"},"tags":{"cis":"kubernetes:1.7.3","level":1},"title":"Do not admit containers wishing to share the host IPC namespace"},{"code":"control 'cis-kubernetes-benchmark-1.7.4' do\n  title 'Do not admit containers wishing to share the host network namespace'\n  desc \"Do not generally permit containers to be run with the `hostNetwork`flag set to true.\\n\\nRationale: A container running in the host's network namespace could access the local loopback device, and could access network traffic to and from other pods.\\nThere should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to share the host network namespace.\\nIf you have need to run containers which require hostNetwork, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.7.4'\n  tag level: 1\n\n  describe 'cis-kubernetes-benchmark-1.7.4' do\n    skip \"For each PSP review the output of `kubectl get psp \u003cname\u003e -o=jsonpath='{.spec.hostNetwork}'` and verify at least one is not set to `true`.\"\n  end\nend\n","desc":"Do not generally permit containers to be run with the `hostNetwork`flag set to true.\n\nRationale: A container running in the host's network namespace could access the local loopback device, and could access network traffic to and from other pods.\nThere should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to share the host network namespace.\nIf you have need to run containers which require hostNetwork, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.","descriptions":{"default":"Do not generally permit containers to be run with the `hostNetwork`flag set to true.\n\nRationale: A container running in the host's network namespace could access the local loopback device, and could access network traffic to and from other pods.\nThere should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to share the host network namespace.\nIf you have need to run containers which require hostNetwork, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP."},"id":"cis-kubernetes-benchmark-1.7.4","impact":1,"refs":[],"source_location":{"line":61,"ref":"cis-kubernetes-benchmark-master/controls/1_7_master_node_pod_security_policies.rb"},"tags":{"cis":"kubernetes:1.7.4","level":1},"title":"Do not admit containers wishing to share the host network namespace"},{"code":"control 'cis-kubernetes-benchmark-1.7.5' do\n  title 'Do not admit containers with allowPrivilegeEscalation'\n  desc \"Do not generally permit containers to be run with the `allowPrivilegeEscalation` flag set to true.\\n\\nRationale: A container running with the `allowPrivilegeEscalation` flag set to `true` may have processes that can gain more privileges than their parent.\\nThere should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to allow privilege escalation. The option exists (and is defaulted to true) to permit setuid binaries to run.\\nIf you have need to run containers which use setuid binaries or require privilege escalation, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:1.7.5'\n  tag level: 1\n\n  describe 'cis-kubernetes-benchmark-1.7.5' do\n    skip \"For each PSP review the output of `kubectl get psp \u003cname\u003e -o=jsonpath='{.spec.allowPrivilegeEscalation}'` and verify at least one is not set to `true`.\"\n  end\nend\n","desc":"Do not generally permit containers to be run with the `allowPrivilegeEscalation` flag set to true.\n\nRationale: A container running with the `allowPrivilegeEscalation` flag set to `true` may have processes that can gain more privileges than their parent.\nThere should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to allow privilege escalation. The option exists (and is defaulted to true) to permit setuid binaries to run.\nIf you have need to run containers which use setuid binaries or require privilege escalation, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.","descriptions":{"default":"Do not generally permit containers to be run with the `allowPrivilegeEscalation` flag set to true.\n\nRationale: A container running with the `allowPrivilegeEscalation` flag set to `true` may have processes that can gain more privileges than their parent.\nThere should be at least one PodSecurityPolicy (PSP) defined which does not permit containers to allow privilege escalation. The option exists (and is defaulted to true) to permit setuid binaries to run.\nIf you have need to run containers which use setuid binaries or require privilege escalation, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP."},"id":"cis-kubernetes-benchmark-1.7.5","impact":1,"refs":[],"source_location":{"line":74,"ref":"cis-kubernetes-benchmark-master/controls/1_7_master_node_pod_security_policies.rb"},"tags":{"cis":"kubernetes:1.7.5","level":1},"title":"Do not admit containers with allowPrivilegeEscalation"},{"code":"control 'cis-kubernetes-benchmark-1.7.6' do\n  title 'Do not admit root containers'\n  desc \"Do not generally permit containers to be run as the root user.\\n\\nRationale: Containers may run as any Linux user. Containers which run as the root user, whilst constrained by Container Runtime security features still have a escalated likelihood of container breakout.\\nIdeally, all containers should run as a defined non-UID 0 user.\\nThere should be at least one PodSecurityPolicy (PSP) defined which does not permit root users in a container.\\nIf you need to run root containers, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.\"\n  impact 0.0\n\n  tag cis: 'kubernetes:1.7.6'\n  tag level: 2\n\n  only_if {  cis_level == 2 }\n\n  describe 'cis-kubernetes-benchmark-1.7.6' do\n    skip \"For each PSP review the output of `kubectl get psp \u003cname\u003e -o=jsonpath='{.spec.runAsUser.rule}'` and verify at least one returns `MustRunAsNonRoot` or `MustRunAs` with the range of UIDs not including 0.\"\n  end\nend\n","desc":"Do not generally permit containers to be run as the root user.\n\nRationale: Containers may run as any Linux user. Containers which run as the root user, whilst constrained by Container Runtime security features still have a escalated likelihood of container breakout.\nIdeally, all containers should run as a defined non-UID 0 user.\nThere should be at least one PodSecurityPolicy (PSP) defined which does not permit root users in a container.\nIf you need to run root containers, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.","descriptions":{"default":"Do not generally permit containers to be run as the root user.\n\nRationale: Containers may run as any Linux user. Containers which run as the root user, whilst constrained by Container Runtime security features still have a escalated likelihood of container breakout.\nIdeally, all containers should run as a defined non-UID 0 user.\nThere should be at least one PodSecurityPolicy (PSP) defined which does not permit root users in a container.\nIf you need to run root containers, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP."},"id":"cis-kubernetes-benchmark-1.7.6","impact":0,"refs":[],"source_location":{"line":87,"ref":"cis-kubernetes-benchmark-master/controls/1_7_master_node_pod_security_policies.rb"},"tags":{"cis":"kubernetes:1.7.6","level":2},"title":"Do not admit root containers"},{"code":"control 'cis-kubernetes-benchmark-1.7.7' do\n  title 'Do not admit containers with dangerous capabilities'\n  desc \"Do not generally permit containers with potentially dangerous capabilities.\\n\\nRationale: Containers run with a default set of capabilities as assigned by the Container Runtime. By default this can include potentially dangerous capabilities. By default with Docker as the container runtime the NET_RAW capability is enabled which may be misused by malicious containers.\\nIdeally, all containers should drop this capability.\\nThere should be at least one PodSecurityPolicy (PSP) defined which prevents containers with the NET_RAW capability from launching.\\nIf you need to run containers with this capability, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.\"\n  impact 0.0\n\n  tag cis: 'kubernetes:1.7.7'\n  tag level: 2\n\n  only_if {  cis_level == 2 }\n\n  describe 'cis-kubernetes-benchmark-1.7.7' do\n    skip \"For each PSP review the output of `kubectl get psp \u003cname\u003e -o=jsonpath='{.spec.requiredDropCapabilities}'` and verify at least one returns `NET_RAW` or `ALL`.\"\n  end\nend\n","desc":"Do not generally permit containers with potentially dangerous capabilities.\n\nRationale: Containers run with a default set of capabilities as assigned by the Container Runtime. By default this can include potentially dangerous capabilities. By default with Docker as the container runtime the NET_RAW capability is enabled which may be misused by malicious containers.\nIdeally, all containers should drop this capability.\nThere should be at least one PodSecurityPolicy (PSP) defined which prevents containers with the NET_RAW capability from launching.\nIf you need to run containers with this capability, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP.","descriptions":{"default":"Do not generally permit containers with potentially dangerous capabilities.\n\nRationale: Containers run with a default set of capabilities as assigned by the Container Runtime. By default this can include potentially dangerous capabilities. By default with Docker as the container runtime the NET_RAW capability is enabled which may be misused by malicious containers.\nIdeally, all containers should drop this capability.\nThere should be at least one PodSecurityPolicy (PSP) defined which prevents containers with the NET_RAW capability from launching.\nIf you need to run containers with this capability, this should be defined in a separate PSP and you should carefully check RBAC controls to ensure that only limited service accounts and users are given permission to access that PSP."},"id":"cis-kubernetes-benchmark-1.7.7","impact":0,"refs":[],"source_location":{"line":102,"ref":"cis-kubernetes-benchmark-master/controls/1_7_master_node_pod_security_policies.rb"},"tags":{"cis":"kubernetes:1.7.7","level":2},"title":"Do not admit containers with dangerous capabilities"},{"code":"control 'cis-kubernetes-benchmark-2.1.1' do\n  title 'Ensure that the --anonymous-auth argument is set to false'\n  desc \"Disable anonymous requests to the Kubelet server.\\n\\nRationale: When enabled, requests that are not rejected by other configured authentication methods are treated as anonymous requests. These requests are then served by the Kubelet server. You should rely on authentication to authorize access and disallow anonymous requests.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.1.1'\n  tag level: 1\n\n  describe processes(kubelet).commands.to_s do\n    it { should match(/--anonymous-auth=false/) }\n  end\nend\n","desc":"Disable anonymous requests to the Kubelet server.\n\nRationale: When enabled, requests that are not rejected by other configured authentication methods are treated as anonymous requests. These requests are then served by the Kubelet server. You should rely on authentication to authorize access and disallow anonymous requests.","descriptions":{"default":"Disable anonymous requests to the Kubelet server.\n\nRationale: When enabled, requests that are not rejected by other configured authentication methods are treated as anonymous requests. These requests are then served by the Kubelet server. You should rely on authentication to authorize access and disallow anonymous requests."},"id":"cis-kubernetes-benchmark-2.1.1","impact":1,"refs":[],"source_location":{"line":28,"ref":"cis-kubernetes-benchmark-master/controls/2_1_worker_node_kubelet.rb"},"tags":{"cis":"kubernetes:2.1.1","level":1},"title":"Ensure that the --anonymous-auth argument is set to false"},{"code":"control 'cis-kubernetes-benchmark-2.1.2' do\n  title 'Ensure that the --authorization-mode argument is not set to AlwaysAllow'\n  desc \"Do not allow all requests. Enable explicit authorization.\\n\\nRationale: Kubelets, by default, allow all authenticated requests (even anonymous ones) without needing explicit authorization checks from the apiserver. You should restrict this behavior and only allow explicitly authorized requests.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.1.2'\n  tag level: 1\n\n  describe processes(kubelet).commands.to_s do\n    it { should_not match(/--authorization-mode=(?:.)*AlwaysAllow,*(?:.)*/) }\n    it { should match(/--authorization-mode=/) }\n  end\nend\n","desc":"Do not allow all requests. Enable explicit authorization.\n\nRationale: Kubelets, by default, allow all authenticated requests (even anonymous ones) without needing explicit authorization checks from the apiserver. You should restrict this behavior and only allow explicitly authorized requests.","descriptions":{"default":"Do not allow all requests. Enable explicit authorization.\n\nRationale: Kubelets, by default, allow all authenticated requests (even anonymous ones) without needing explicit authorization checks from the apiserver. You should restrict this behavior and only allow explicitly authorized requests."},"id":"cis-kubernetes-benchmark-2.1.2","impact":1,"refs":[],"source_location":{"line":41,"ref":"cis-kubernetes-benchmark-master/controls/2_1_worker_node_kubelet.rb"},"tags":{"cis":"kubernetes:2.1.2","level":1},"title":"Ensure that the --authorization-mode argument is not set to AlwaysAllow"},{"code":"control 'cis-kubernetes-benchmark-2.1.3' do\n  title 'Ensure that the --client-ca-file argument is set as appropriate'\n  desc \"Enable Kubelet authentication using certificates.\\n\\nRationale: The connections from the apiserver to the kubelet are used for fetching logs for pods, attaching (through kubectl) to running pods, and using the kubelet's port-forwarding functionality. These connections terminate at the kubelet's HTTPS endpoint. By default, the apiserver does not verify the kubelet's serving certificate, which makes the connection subject to man-in-the-middle attacks, and unsafe to run over untrusted and/or public networks. Enabling Kubelet certificate authentication ensures that the apiserver could authenticate the Kubelet before submitting any requests.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.1.3'\n  tag level: 1\n\n  describe processes(kubelet).commands.to_s do\n    it { should match(/--client-ca-file=/) }\n  end\nend\n","desc":"Enable Kubelet authentication using certificates.\n\nRationale: The connections from the apiserver to the kubelet are used for fetching logs for pods, attaching (through kubectl) to running pods, and using the kubelet's port-forwarding functionality. These connections terminate at the kubelet's HTTPS endpoint. By default, the apiserver does not verify the kubelet's serving certificate, which makes the connection subject to man-in-the-middle attacks, and unsafe to run over untrusted and/or public networks. Enabling Kubelet certificate authentication ensures that the apiserver could authenticate the Kubelet before submitting any requests.","descriptions":{"default":"Enable Kubelet authentication using certificates.\n\nRationale: The connections from the apiserver to the kubelet are used for fetching logs for pods, attaching (through kubectl) to running pods, and using the kubelet's port-forwarding functionality. These connections terminate at the kubelet's HTTPS endpoint. By default, the apiserver does not verify the kubelet's serving certificate, which makes the connection subject to man-in-the-middle attacks, and unsafe to run over untrusted and/or public networks. Enabling Kubelet certificate authentication ensures that the apiserver could authenticate the Kubelet before submitting any requests."},"id":"cis-kubernetes-benchmark-2.1.3","impact":1,"refs":[],"source_location":{"line":55,"ref":"cis-kubernetes-benchmark-master/controls/2_1_worker_node_kubelet.rb"},"tags":{"cis":"kubernetes:2.1.3","level":1},"title":"Ensure that the --client-ca-file argument is set as appropriate"},{"code":"control 'cis-kubernetes-benchmark-2.1.4' do\n  title 'Ensure that the --read-only-port argument is set to 0'\n  desc \"Disable the read-only port.\\n\\nRationale: The Kubelet process provides a read-only API in addition to the main Kubelet API. Unauthenticated access is provided to this read-only API which could possibly retrieve potentially sensitive information about the cluster.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.1.4'\n  tag level: 1\n\n  describe processes(kubelet).commands.to_s do\n    it { should match(/--read-only-port=0/) }\n  end\nend\n","desc":"Disable the read-only port.\n\nRationale: The Kubelet process provides a read-only API in addition to the main Kubelet API. Unauthenticated access is provided to this read-only API which could possibly retrieve potentially sensitive information about the cluster.","descriptions":{"default":"Disable the read-only port.\n\nRationale: The Kubelet process provides a read-only API in addition to the main Kubelet API. Unauthenticated access is provided to this read-only API which could possibly retrieve potentially sensitive information about the cluster."},"id":"cis-kubernetes-benchmark-2.1.4","impact":1,"refs":[],"source_location":{"line":68,"ref":"cis-kubernetes-benchmark-master/controls/2_1_worker_node_kubelet.rb"},"tags":{"cis":"kubernetes:2.1.4","level":1},"title":"Ensure that the --read-only-port argument is set to 0"},{"code":"control 'cis-kubernetes-benchmark-2.1.5' do\n  title 'Ensure that the --streaming-connection-idle-timeout argument is not set to 0'\n  desc \"Do not disable timeouts on streaming connections.\\n\\nRationale: Setting idle timeouts ensures that you are protected against Denial-of-Service attacks, inactive connections and running out of ephemeral ports. **Note:** By default, `--streaming-connection-idle-timeout` is set to 4 hours which might be too high for your environment. Setting this as appropriate would additionally ensure that such streaming connections are timed out after serving legitimate use cases.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.1.5'\n  tag level: 1\n\n  describe processes(kubelet).commands.to_s do\n    it { should_not match(/--streaming-connection-idle-timeout=0/) }\n  end\nend\n","desc":"Do not disable timeouts on streaming connections.\n\nRationale: Setting idle timeouts ensures that you are protected against Denial-of-Service attacks, inactive connections and running out of ephemeral ports. **Note:** By default, `--streaming-connection-idle-timeout` is set to 4 hours which might be too high for your environment. Setting this as appropriate would additionally ensure that such streaming connections are timed out after serving legitimate use cases.","descriptions":{"default":"Do not disable timeouts on streaming connections.\n\nRationale: Setting idle timeouts ensures that you are protected against Denial-of-Service attacks, inactive connections and running out of ephemeral ports. **Note:** By default, `--streaming-connection-idle-timeout` is set to 4 hours which might be too high for your environment. Setting this as appropriate would additionally ensure that such streaming connections are timed out after serving legitimate use cases."},"id":"cis-kubernetes-benchmark-2.1.5","impact":1,"refs":[],"source_location":{"line":81,"ref":"cis-kubernetes-benchmark-master/controls/2_1_worker_node_kubelet.rb"},"tags":{"cis":"kubernetes:2.1.5","level":1},"title":"Ensure that the --streaming-connection-idle-timeout argument is not set to 0"},{"code":"control 'cis-kubernetes-benchmark-2.1.6' do\n  title 'Ensure that the --protect-kernel-defaults argument is set to true'\n  desc \"Protect tuned kernel parameters from overriding kubelet default kernel parameter values.\\n\\nRationale: Kernel parameters are usually tuned and hardened by the system administrators before putting the systems into production. These parameters protect the kernel and the system. Your kubelet kernel defaults that rely on such parameters should be appropriately set to match the desired secured system state. Ignoring this could potentially lead to running pods with undesired kernel behavior.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.1.6'\n  tag level: 1\n\n  describe processes(kubelet).commands.to_s do\n    it { should match(/--protect-kernel-defaults=true/) }\n  end\nend\n","desc":"Protect tuned kernel parameters from overriding kubelet default kernel parameter values.\n\nRationale: Kernel parameters are usually tuned and hardened by the system administrators before putting the systems into production. These parameters protect the kernel and the system. Your kubelet kernel defaults that rely on such parameters should be appropriately set to match the desired secured system state. Ignoring this could potentially lead to running pods with undesired kernel behavior.","descriptions":{"default":"Protect tuned kernel parameters from overriding kubelet default kernel parameter values.\n\nRationale: Kernel parameters are usually tuned and hardened by the system administrators before putting the systems into production. These parameters protect the kernel and the system. Your kubelet kernel defaults that rely on such parameters should be appropriately set to match the desired secured system state. Ignoring this could potentially lead to running pods with undesired kernel behavior."},"id":"cis-kubernetes-benchmark-2.1.6","impact":1,"refs":[],"source_location":{"line":94,"ref":"cis-kubernetes-benchmark-master/controls/2_1_worker_node_kubelet.rb"},"tags":{"cis":"kubernetes:2.1.6","level":1},"title":"Ensure that the --protect-kernel-defaults argument is set to true"},{"code":"control 'cis-kubernetes-benchmark-2.1.7' do\n  title 'Ensure that the --make-iptables-util-chains argument is set to true'\n  desc \"Allow Kubelet to manage iptables.\\n\\nRationale: Kubelets can automatically manage the required changes to iptables based on how you choose your networking options for the pods. It is recommended to let kubelets manage the changes to iptables. This ensures that the iptables configuration remains in sync with pods networking configuration. Manually configuring iptables with dynamic pod network configuration changes might hamper the communication between pods/containers and to the outside world. You might have iptables rules too restrictive or too open.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.1.7'\n  tag level: 1\n\n  describe processes(kubelet).commands.to_s do\n    it { should match(/--make-iptables-util-chains=true/) }\n  end\nend\n","desc":"Allow Kubelet to manage iptables.\n\nRationale: Kubelets can automatically manage the required changes to iptables based on how you choose your networking options for the pods. It is recommended to let kubelets manage the changes to iptables. This ensures that the iptables configuration remains in sync with pods networking configuration. Manually configuring iptables with dynamic pod network configuration changes might hamper the communication between pods/containers and to the outside world. You might have iptables rules too restrictive or too open.","descriptions":{"default":"Allow Kubelet to manage iptables.\n\nRationale: Kubelets can automatically manage the required changes to iptables based on how you choose your networking options for the pods. It is recommended to let kubelets manage the changes to iptables. This ensures that the iptables configuration remains in sync with pods networking configuration. Manually configuring iptables with dynamic pod network configuration changes might hamper the communication between pods/containers and to the outside world. You might have iptables rules too restrictive or too open."},"id":"cis-kubernetes-benchmark-2.1.7","impact":1,"refs":[],"source_location":{"line":107,"ref":"cis-kubernetes-benchmark-master/controls/2_1_worker_node_kubelet.rb"},"tags":{"cis":"kubernetes:2.1.7","level":1},"title":"Ensure that the --make-iptables-util-chains argument is set to true"},{"code":"control 'cis-kubernetes-benchmark-2.1.8' do\n  title 'Ensure that the --hostname-override argument is not set'\n  desc \"Do not override node hostnames.\\n\\nRationale: Overriding hostnames could potentially break TLS setup between the kubelet and the apiserver. Additionally, with overridden hostnames, it becomes increasingly difficult to associate logs with a particular node and process them for security analytics. Hence, you should setup your kubelet nodes with resolvable FQDNs and avoid overriding the hostnames with IPs.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.1.8'\n  tag level: 1\n\n  describe processes(kubelet).commands.to_s do\n    it { should_not match(/--hostname-override/) }\n  end\nend\n","desc":"Do not override node hostnames.\n\nRationale: Overriding hostnames could potentially break TLS setup between the kubelet and the apiserver. Additionally, with overridden hostnames, it becomes increasingly difficult to associate logs with a particular node and process them for security analytics. Hence, you should setup your kubelet nodes with resolvable FQDNs and avoid overriding the hostnames with IPs.","descriptions":{"default":"Do not override node hostnames.\n\nRationale: Overriding hostnames could potentially break TLS setup between the kubelet and the apiserver. Additionally, with overridden hostnames, it becomes increasingly difficult to associate logs with a particular node and process them for security analytics. Hence, you should setup your kubelet nodes with resolvable FQDNs and avoid overriding the hostnames with IPs."},"id":"cis-kubernetes-benchmark-2.1.8","impact":1,"refs":[],"source_location":{"line":120,"ref":"cis-kubernetes-benchmark-master/controls/2_1_worker_node_kubelet.rb"},"tags":{"cis":"kubernetes:2.1.8","level":1},"title":"Ensure that the --hostname-override argument is not set"},{"code":"control 'cis-kubernetes-benchmark-2.1.9' do\n  title 'Ensure that the --event-qps argument is set to 0'\n  desc \"Do not limit event creation.\\n\\nRationale: It is important to capture all events and not restrict event creation. Events are an important source of security information and analytics that ensure that your environment is consistently monitored using the event data.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.1.9'\n  tag level: 1\n\n  describe processes(kubelet).commands.to_s do\n    it { should match(/--event-qps=0/) }\n  end\nend\n","desc":"Do not limit event creation.\n\nRationale: It is important to capture all events and not restrict event creation. Events are an important source of security information and analytics that ensure that your environment is consistently monitored using the event data.","descriptions":{"default":"Do not limit event creation.\n\nRationale: It is important to capture all events and not restrict event creation. Events are an important source of security information and analytics that ensure that your environment is consistently monitored using the event data."},"id":"cis-kubernetes-benchmark-2.1.9","impact":1,"refs":[],"source_location":{"line":133,"ref":"cis-kubernetes-benchmark-master/controls/2_1_worker_node_kubelet.rb"},"tags":{"cis":"kubernetes:2.1.9","level":1},"title":"Ensure that the --event-qps argument is set to 0"},{"code":"control 'cis-kubernetes-benchmark-2.1.10' do\n  title 'Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate'\n  desc \"Setup TLS connection on the Kubelets.\\n\\nRationale: Kubelet communication contains sensitive parameters that should remain encrypted in transit. Configure the Kubelets to serve only HTTPS traffic.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.1.10'\n  tag level: 1\n\n  describe processes(kubelet).commands.to_s do\n    it { should match(/--tls-cert-file=/) }\n    it { should match(/--tls-private-key-file=/) }\n  end\nend\n","desc":"Setup TLS connection on the Kubelets.\n\nRationale: Kubelet communication contains sensitive parameters that should remain encrypted in transit. Configure the Kubelets to serve only HTTPS traffic.","descriptions":{"default":"Setup TLS connection on the Kubelets.\n\nRationale: Kubelet communication contains sensitive parameters that should remain encrypted in transit. Configure the Kubelets to serve only HTTPS traffic."},"id":"cis-kubernetes-benchmark-2.1.10","impact":1,"refs":[],"source_location":{"line":146,"ref":"cis-kubernetes-benchmark-master/controls/2_1_worker_node_kubelet.rb"},"tags":{"cis":"kubernetes:2.1.10","level":1},"title":"Ensure that the --tls-cert-file and --tls-private-key-file arguments are set as appropriate"},{"code":"control 'cis-kubernetes-benchmark-2.1.11' do\n  title 'Ensure that the --cadvisor-port argument is set to 0'\n  desc \"Disable cAdvisor.\\n\\nRationale: cAdvisor provides potentially sensitive data and there's currently no way to block access to it using anything other than iptables. It does not require authentication/authorization to connect to the cAdvisor port. Hence, you should disable the port.\\n**Note** The cAdvisor port setting was deprecated in Kubernetes v1.10 and will be removed in v1.12.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.1.11'\n  tag level: 1\n\n  describe processes(kubelet).commands.to_s do\n    it { should match(/--cadvisor-port=0/) }\n  end\nend\n","desc":"Disable cAdvisor.\n\nRationale: cAdvisor provides potentially sensitive data and there's currently no way to block access to it using anything other than iptables. It does not require authentication/authorization to connect to the cAdvisor port. Hence, you should disable the port.\n**Note** The cAdvisor port setting was deprecated in Kubernetes v1.10 and will be removed in v1.12.","descriptions":{"default":"Disable cAdvisor.\n\nRationale: cAdvisor provides potentially sensitive data and there's currently no way to block access to it using anything other than iptables. It does not require authentication/authorization to connect to the cAdvisor port. Hence, you should disable the port.\n**Note** The cAdvisor port setting was deprecated in Kubernetes v1.10 and will be removed in v1.12."},"id":"cis-kubernetes-benchmark-2.1.11","impact":1,"refs":[],"source_location":{"line":160,"ref":"cis-kubernetes-benchmark-master/controls/2_1_worker_node_kubelet.rb"},"tags":{"cis":"kubernetes:2.1.11","level":1},"title":"Ensure that the --cadvisor-port argument is set to 0"},{"code":"control 'cis-kubernetes-benchmark-2.1.12' do\n  title 'Ensure that the --rotate-certificates argument is not set to false'\n  desc \"Enable kubelet client certificate rotation.\\n\\nRationale: The `--rotate-certificates` setting causes the kubelet to rotate its client certificates by creating new CSRs as its existing credentials expire. This automated periodic rotation ensures that the there are no downtimes due to expired certificates and thus addressing availability in the CIA security triad.\\n**Note:**This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself.\\n**Note:** This feature also require the `RotateKubeletClientCertificate` feature gate to be enabled (which is the default since Kubernetes v1.7)\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.1.12'\n  tag level: 1\n\n  describe processes(kubelet).commands.to_s do\n    it { should match(/--feature-gates=(?:.)*RotateKubeletClientCertificate=true,*(?:.)*/) }\n    it { should match(/--rotate-certificates=true/) }\n  end\nend\n","desc":"Enable kubelet client certificate rotation.\n\nRationale: The `--rotate-certificates` setting causes the kubelet to rotate its client certificates by creating new CSRs as its existing credentials expire. This automated periodic rotation ensures that the there are no downtimes due to expired certificates and thus addressing availability in the CIA security triad.\n**Note:**This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself.\n**Note:** This feature also require the `RotateKubeletClientCertificate` feature gate to be enabled (which is the default since Kubernetes v1.7)","descriptions":{"default":"Enable kubelet client certificate rotation.\n\nRationale: The `--rotate-certificates` setting causes the kubelet to rotate its client certificates by creating new CSRs as its existing credentials expire. This automated periodic rotation ensures that the there are no downtimes due to expired certificates and thus addressing availability in the CIA security triad.\n**Note:**This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself.\n**Note:** This feature also require the `RotateKubeletClientCertificate` feature gate to be enabled (which is the default since Kubernetes v1.7)"},"id":"cis-kubernetes-benchmark-2.1.12","impact":1,"refs":[],"source_location":{"line":173,"ref":"cis-kubernetes-benchmark-master/controls/2_1_worker_node_kubelet.rb"},"tags":{"cis":"kubernetes:2.1.12","level":1},"title":"Ensure that the --rotate-certificates argument is not set to false"},{"code":"control 'cis-kubernetes-benchmark-2.1.13' do\n  title 'Ensure that the RotateKubeletServerCertificate argument is set to true'\n  desc \"Enable kubelet server certificate rotation.\\n\\nRationale: `RotateKubeletServerCertificate` causes the kubelet to both request a serving certificate after bootstrapping its client credentials and rotate the certificate as its existing credentials expire. This automated periodic rotation ensures that the there are no downtimes due to expired certificates and thus addressing availability in the CIA security triad.\\nNote: This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.1.13'\n  tag level: 1\n\n  describe processes(kubelet).commands.to_s do\n    it { should match(/--feature-gates=(?:.)*RotateKubeletServerCertificate=true,*(?:.)*/) }\n  end\nend\n","desc":"Enable kubelet server certificate rotation.\n\nRationale: `RotateKubeletServerCertificate` causes the kubelet to both request a serving certificate after bootstrapping its client credentials and rotate the certificate as its existing credentials expire. This automated periodic rotation ensures that the there are no downtimes due to expired certificates and thus addressing availability in the CIA security triad.\nNote: This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself.","descriptions":{"default":"Enable kubelet server certificate rotation.\n\nRationale: `RotateKubeletServerCertificate` causes the kubelet to both request a serving certificate after bootstrapping its client credentials and rotate the certificate as its existing credentials expire. This automated periodic rotation ensures that the there are no downtimes due to expired certificates and thus addressing availability in the CIA security triad.\nNote: This recommendation only applies if you let kubelets get their certificates from the API server. In case your kubelet certificates come from an outside authority/tool (e.g. Vault) then you need to take care of rotation yourself."},"id":"cis-kubernetes-benchmark-2.1.13","impact":1,"refs":[],"source_location":{"line":187,"ref":"cis-kubernetes-benchmark-master/controls/2_1_worker_node_kubelet.rb"},"tags":{"cis":"kubernetes:2.1.13","level":1},"title":"Ensure that the RotateKubeletServerCertificate argument is set to true"},{"code":"control 'cis-kubernetes-benchmark-2.1.14' do\n  title 'Ensure that the Kubelet only makes use of Strong Cryptographic Ciphers'\n  desc \"Ensure that the Kubelet is configured to only use strong cryptographic ciphers.\\n\\nRationale: TLS ciphers have had a number of known vulnerabilities and weaknesses, which can reduce the protection provided by them. By default Kubernetes supports a number of TLS ciphersuites including some that have security concerns, weakening the protection provided.\"\n  impact 0.0\n\n  tag cis: 'kubernetes:2.1.14'\n  tag level: 1\n\n  describe processes(kubelet).commands.to_s do\n    it { should match(/--tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256/) }\n  end\nend\n","desc":"Ensure that the Kubelet is configured to only use strong cryptographic ciphers.\n\nRationale: TLS ciphers have had a number of known vulnerabilities and weaknesses, which can reduce the protection provided by them. By default Kubernetes supports a number of TLS ciphersuites including some that have security concerns, weakening the protection provided.","descriptions":{"default":"Ensure that the Kubelet is configured to only use strong cryptographic ciphers.\n\nRationale: TLS ciphers have had a number of known vulnerabilities and weaknesses, which can reduce the protection provided by them. By default Kubernetes supports a number of TLS ciphersuites including some that have security concerns, weakening the protection provided."},"id":"cis-kubernetes-benchmark-2.1.14","impact":0,"refs":[],"source_location":{"line":200,"ref":"cis-kubernetes-benchmark-master/controls/2_1_worker_node_kubelet.rb"},"tags":{"cis":"kubernetes:2.1.14","level":1},"title":"Ensure that the Kubelet only makes use of Strong Cryptographic Ciphers"},{"code":"control 'cis-kubernetes-benchmark-2.2.1' do\n  title 'Ensure that the kubelet.conf file permissions are set to 644 or more restrictive'\n  desc \"Ensure that the `kubelet.conf` file has permissions of `644` or more restrictive.\\n\\nRationale: The `kubelet.conf` file is the kubeconfig file for the node, and controls various parameters that set the behavior and identity of the worker node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.2.1'\n  tag level: 1\n\n  only_if do\n    file('/etc/kubernetes/kubelet.conf').exist?\n  end\n\n  describe file('/etc/kubernetes/kubelet.conf').mode.to_s(8) do\n    it { should match(/[0246][024][024]/) }\n  end\nend\n","desc":"Ensure that the `kubelet.conf` file has permissions of `644` or more restrictive.\n\nRationale: The `kubelet.conf` file is the kubeconfig file for the node, and controls various parameters that set the behavior and identity of the worker node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.","descriptions":{"default":"Ensure that the `kubelet.conf` file has permissions of `644` or more restrictive.\n\nRationale: The `kubelet.conf` file is the kubeconfig file for the node, and controls various parameters that set the behavior and identity of the worker node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system."},"id":"cis-kubernetes-benchmark-2.2.1","impact":1,"refs":[],"source_location":{"line":20,"ref":"cis-kubernetes-benchmark-master/controls/2_2_worker_node_configuration_files.rb"},"tags":{"cis":"kubernetes:2.2.1","level":1},"title":"Ensure that the kubelet.conf file permissions are set to 644 or more restrictive"},{"code":"control 'cis-kubernetes-benchmark-2.2.2' do\n  title 'Ensure that the kubelet.conf file ownership is set to root:root'\n  desc \"Ensure that the `kubelet.conf` file ownership is set to `root:root`.\\n\\nRationale: The `kubelet.conf` file is the kubeconfig file for the node, and controls various parameters that set the behavior and identity of the worker node. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root.`\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.2.2'\n  tag level: 1\n\n  only_if do\n    file('/etc/kubernetes/kubelet.conf').exist?\n  end\n\n  describe file('/etc/kubernetes/kubelet.conf') do\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n  end\nend\n","desc":"Ensure that the `kubelet.conf` file ownership is set to `root:root`.\n\nRationale: The `kubelet.conf` file is the kubeconfig file for the node, and controls various parameters that set the behavior and identity of the worker node. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root.`","descriptions":{"default":"Ensure that the `kubelet.conf` file ownership is set to `root:root`.\n\nRationale: The `kubelet.conf` file is the kubeconfig file for the node, and controls various parameters that set the behavior and identity of the worker node. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root.`"},"id":"cis-kubernetes-benchmark-2.2.2","impact":1,"refs":[],"source_location":{"line":37,"ref":"cis-kubernetes-benchmark-master/controls/2_2_worker_node_configuration_files.rb"},"tags":{"cis":"kubernetes:2.2.2","level":1},"title":"Ensure that the kubelet.conf file ownership is set to root:root"},{"code":"control 'cis-kubernetes-benchmark-2.2.3' do\n  title 'Ensure that the kubelet service file permissions are set to 644 or more restrictive'\n  desc \"Ensure that the `kubelet` service file has permissions of `644` or more restrictive.\\n\\nRationale: The `kubelet` service file controls various parameters that set the behavior of the `kubelet` service in the worker node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.2.3'\n  tag level: 1\n\n  if file('/etc/systemd/system/kubelet.service.d/10-kubeadm.conf').exist?\n    describe file('/etc/systemd/system/kubelet.service.d/10-kubeadm.conf').mode.to_s(8) do\n      it { should match(/[0246][024][024]/) }\n    end\n  else\n    describe 'cis-kubernetes-benchmark-2.2.3' do\n      skip 'Review the permissions on your Kubelet systemd service file.'\n    end\n  end\nend\n","desc":"Ensure that the `kubelet` service file has permissions of `644` or more restrictive.\n\nRationale: The `kubelet` service file controls various parameters that set the behavior of the `kubelet` service in the worker node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.","descriptions":{"default":"Ensure that the `kubelet` service file has permissions of `644` or more restrictive.\n\nRationale: The `kubelet` service file controls various parameters that set the behavior of the `kubelet` service in the worker node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system."},"id":"cis-kubernetes-benchmark-2.2.3","impact":1,"refs":[],"source_location":{"line":55,"ref":"cis-kubernetes-benchmark-master/controls/2_2_worker_node_configuration_files.rb"},"tags":{"cis":"kubernetes:2.2.3","level":1},"title":"Ensure that the kubelet service file permissions are set to 644 or more restrictive"},{"code":"control 'cis-kubernetes-benchmark-2.2.4' do\n  title 'Ensure that the kubelet service file ownership is set to root:root'\n  desc \"Ensure that the `kubelet` service file ownership is set to `root:root`.\\n\\nRationale: The `kubelet` service file controls various parameters that set the behavior of the `kubelet` service in the worker node. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.2.4'\n  tag level: 1\n\n  if file('/etc/systemd/system/kubelet.service.d/10-kubeadm.conf').exist?\n    describe file('/etc/systemd/system/kubelet.service.d/10-kubeadm.conf') do\n      it { should be_owned_by 'root' }\n      it { should be_grouped_into 'root' }\n    end\n  else\n    describe 'cis-kubernetes-benchmark-1.4.10' do\n      skip 'Review the ownership of your Kubelet systemd service file.'\n    end\n  end\nend\n","desc":"Ensure that the `kubelet` service file ownership is set to `root:root`.\n\nRationale: The `kubelet` service file controls various parameters that set the behavior of the `kubelet` service in the worker node. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.","descriptions":{"default":"Ensure that the `kubelet` service file ownership is set to `root:root`.\n\nRationale: The `kubelet` service file controls various parameters that set the behavior of the `kubelet` service in the worker node. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`."},"id":"cis-kubernetes-benchmark-2.2.4","impact":1,"refs":[],"source_location":{"line":74,"ref":"cis-kubernetes-benchmark-master/controls/2_2_worker_node_configuration_files.rb"},"tags":{"cis":"kubernetes:2.2.4","level":1},"title":"Ensure that the kubelet service file ownership is set to root:root"},{"code":"control 'cis-kubernetes-benchmark-2.2.5' do\n  title 'Ensure that the proxy kubeconfig file permissions are set to 644 or more restrictive'\n  desc \"If `kube-proxy` is running, ensure that the proxy kubeconfig file has permissions of `644` or more restrictive.\\n\\nRationale: The `kube-proxy` kubeconfig file controls various parameters of the `kube-proxy` service in the worker node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.2.5'\n  tag level: 1\n\n  if processes('kube-proxy').exists?\n    conf_file = processes('kube-proxy').commands.first.scan(/--config=(\\S+)/).last.first\n\n    if file(conf_file).exist?\n      describe file(conf_file).mode.to_s(8) do\n        it { should match(/[0246][024][024]/) }\n      end\n    else\n      describe 'cis-kubernetes-benchmark-2.2.5' do\n        skip 'kube-proxy config file configured but not found'\n      end\n    end\n  else\n    describe 'cis-kubernetes-benchmark-2.2.5' do\n      skip 'kube-proxy process not found'\n    end\n  end\nend\n","desc":"If `kube-proxy` is running, ensure that the proxy kubeconfig file has permissions of `644` or more restrictive.\n\nRationale: The `kube-proxy` kubeconfig file controls various parameters of the `kube-proxy` service in the worker node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.","descriptions":{"default":"If `kube-proxy` is running, ensure that the proxy kubeconfig file has permissions of `644` or more restrictive.\n\nRationale: The `kube-proxy` kubeconfig file controls various parameters of the `kube-proxy` service in the worker node. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system."},"id":"cis-kubernetes-benchmark-2.2.5","impact":1,"refs":[],"source_location":{"line":94,"ref":"cis-kubernetes-benchmark-master/controls/2_2_worker_node_configuration_files.rb"},"tags":{"cis":"kubernetes:2.2.5","level":1},"title":"Ensure that the proxy kubeconfig file permissions are set to 644 or more restrictive"},{"code":"control 'cis-kubernetes-benchmark-2.2.6' do\n  title 'Ensure that the proxy kubeconfig file ownership is set to root:root'\n  desc \"If `kube-proxy` is running, ensure that the file ownership of its kubeconfig file is set to `root:root`.\\n\\nRationale: The kubeconfig file for `kube-proxy` controls various parameters for the `kube-proxy` service in the worker node. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.2.6'\n  tag level: 1\n\n  if processes('kube-proxy').exists?\n    conf_file = processes('kube-proxy').commands.first.scan(/--config=(\\S+)/).last.first\n\n    if file(conf_file).exist?\n      describe file(conf_file) do\n        it { should be_owned_by 'root' }\n        it { should be_grouped_into 'root' }\n      end\n    else\n      describe 'cis-kubernetes-benchmark-2.2.6' do\n        skip 'kube-proxy config file configured but not found'\n      end\n    end\n  else\n    describe 'cis-kubernetes-benchmark-2.2.6' do\n      skip 'kube-proxy process not found'\n    end\n  end\nend\n","desc":"If `kube-proxy` is running, ensure that the file ownership of its kubeconfig file is set to `root:root`.\n\nRationale: The kubeconfig file for `kube-proxy` controls various parameters for the `kube-proxy` service in the worker node. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.","descriptions":{"default":"If `kube-proxy` is running, ensure that the file ownership of its kubeconfig file is set to `root:root`.\n\nRationale: The kubeconfig file for `kube-proxy` controls various parameters for the `kube-proxy` service in the worker node. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`."},"id":"cis-kubernetes-benchmark-2.2.6","impact":1,"refs":[],"source_location":{"line":121,"ref":"cis-kubernetes-benchmark-master/controls/2_2_worker_node_configuration_files.rb"},"tags":{"cis":"kubernetes:2.2.6","level":1},"title":"Ensure that the proxy kubeconfig file ownership is set to root:root"},{"code":"control 'cis-kubernetes-benchmark-2.2.7' do\n  title 'Ensure that the certificate authorities file permissions are set to 644 or more restrictive'\n  desc \"Ensure that the certificate authorities file has permissions of `644` or more restrictive.\\n\\nRationale: The certificate authorities file controls the authorities used to validate API requests. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.2.7'\n  tag level: 1\n\n  if processes('kubelet').exists?\n    ca_cert_path = processes('kubelet').commands.first.scan(/--client-ca-file=(\\S+)/)\n\n    if ca_cert_path.empty?\n      describe 'cis-kubernetes-benchmark-2.2.7' do\n        skip 'No client CA file specified for `kubelet` process'\n      end\n    else\n      describe file(ca_cert_path.last.first).mode.to_s(8) do\n        it { should match(/[0246][024][024]/) }\n      end\n    end\n  else\n    describe 'cis-kubernetes-benchmark-2.2.7' do\n      skip 'kubelet process not found'\n    end\n  end\nend\n","desc":"Ensure that the certificate authorities file has permissions of `644` or more restrictive.\n\nRationale: The certificate authorities file controls the authorities used to validate API requests. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.","descriptions":{"default":"Ensure that the certificate authorities file has permissions of `644` or more restrictive.\n\nRationale: The certificate authorities file controls the authorities used to validate API requests. You should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system."},"id":"cis-kubernetes-benchmark-2.2.7","impact":1,"refs":[],"source_location":{"line":149,"ref":"cis-kubernetes-benchmark-master/controls/2_2_worker_node_configuration_files.rb"},"tags":{"cis":"kubernetes:2.2.7","level":1},"title":"Ensure that the certificate authorities file permissions are set to 644 or more restrictive"},{"code":"control 'cis-kubernetes-benchmark-2.2.8' do\n  title 'Ensure that the client certificate authorities file ownership is set to root:root'\n  desc \"Ensure that the certificate authorities file ownership is set to `root:root`.\\n\\nRationale: The certificate authorities file controls the authorities used to validate API requests. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.2.8'\n  tag level: 1\n\n  if processes('kubelet').exists?\n    ca_cert_path = processes('kubelet').commands.to_s.scan(/--client-ca-file=(\\S+)/)\n\n    if ca_cert_path.empty?\n      describe 'cis-kubernetes-benchmark-2.2.8' do\n        skip 'No client CA file specified for `kubelet` process'\n      end\n    else\n      describe file(ca_cert_path.last.first) do\n        it { should be_owned_by 'root' }\n        it { should be_grouped_into 'root' }\n      end\n    end\n  else\n    describe 'cis-kubernetes-benchmark-2.2.8' do\n      skip 'kubelet process not found'\n    end\n  end\nend\n","desc":"Ensure that the certificate authorities file ownership is set to `root:root`.\n\nRationale: The certificate authorities file controls the authorities used to validate API requests. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`.","descriptions":{"default":"Ensure that the certificate authorities file ownership is set to `root:root`.\n\nRationale: The certificate authorities file controls the authorities used to validate API requests. You should set its file ownership to maintain the integrity of the file. The file should be owned by `root:root`."},"id":"cis-kubernetes-benchmark-2.2.8","impact":1,"refs":[],"source_location":{"line":176,"ref":"cis-kubernetes-benchmark-master/controls/2_2_worker_node_configuration_files.rb"},"tags":{"cis":"kubernetes:2.2.8","level":1},"title":"Ensure that the client certificate authorities file ownership is set to root:root"},{"code":"control 'cis-kubernetes-benchmark-2.2.9' do\n  title 'Ensure that the kubelet configuration file ownership is set to root:root'\n  desc \"Ensure that if the kubelet refers to a configuration file with the --config argument, that file is owned by root:root.\\n\\nRationale: The kubelet reads various parameters, including security settings, from a config file specified by the `--config` argument. If this file is specified you should restrict its file permissions to maintain the integrity of the file. The file should be owned by root:root.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.2.9'\n  tag level: 1\n\n  if processes('kubelet').exists?\n    config_path = processes('kubelet').commands.first.scan(/--config=(\\S+)/)\n\n    if config_path.empty?\n      describe 'cis-kubernetes-benchmark-2.2.9' do\n        skip 'No config file specified for `kubelet` process'\n      end\n    else\n      describe file(config_path.last.first) do\n        it { should be_owned_by 'root' }\n        it { should be_grouped_into 'root' }\n      end\n    end\n  else\n    describe 'cis-kubernetes-benchmark-2.2.9' do\n      skip 'kubelet process not found'\n    end\n  end\nend\n","desc":"Ensure that if the kubelet refers to a configuration file with the --config argument, that file is owned by root:root.\n\nRationale: The kubelet reads various parameters, including security settings, from a config file specified by the `--config` argument. If this file is specified you should restrict its file permissions to maintain the integrity of the file. The file should be owned by root:root.","descriptions":{"default":"Ensure that if the kubelet refers to a configuration file with the --config argument, that file is owned by root:root.\n\nRationale: The kubelet reads various parameters, including security settings, from a config file specified by the `--config` argument. If this file is specified you should restrict its file permissions to maintain the integrity of the file. The file should be owned by root:root."},"id":"cis-kubernetes-benchmark-2.2.9","impact":1,"refs":[],"source_location":{"line":204,"ref":"cis-kubernetes-benchmark-master/controls/2_2_worker_node_configuration_files.rb"},"tags":{"cis":"kubernetes:2.2.9","level":1},"title":"Ensure that the kubelet configuration file ownership is set to root:root"},{"code":"control 'cis-kubernetes-benchmark-2.2.10' do\n  title 'Ensure that the kubelet configuration file has permissions set to 644 or more restrictive'\n  desc \"Ensure that if the kubelet refers to a configuration file with the `--config` argument, that file has permissions of 644 or more restrictive.\\n\\nRationale: The kubelet reads various parameters, including security settings, from a config file specified by the `--config` argument. If this file is specified you should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.\"\n  impact 1.0\n\n  tag cis: 'kubernetes:2.2.10'\n  tag level: 1\n\n  if processes('kubelet').exists?\n    config_path = processes('kubelet').commands.first.scan(/--config=(\\S+)/)\n\n    if config_path.empty?\n      describe 'cis-kubernetes-benchmark-2.2.10' do\n        skip 'No config file specified for `kubelet` process'\n      end\n    else\n      describe file(config_path.last.first).mode.to_s(8) do\n        it { should match(/[0246][024][024]/) }\n      end\n    end\n  else\n    describe 'cis-kubernetes-benchmark-2.2.10' do\n      skip 'kubelet process not found'\n    end\n  end\nend\n","desc":"Ensure that if the kubelet refers to a configuration file with the `--config` argument, that file has permissions of 644 or more restrictive.\n\nRationale: The kubelet reads various parameters, including security settings, from a config file specified by the `--config` argument. If this file is specified you should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system.","descriptions":{"default":"Ensure that if the kubelet refers to a configuration file with the `--config` argument, that file has permissions of 644 or more restrictive.\n\nRationale: The kubelet reads various parameters, including security settings, from a config file specified by the `--config` argument. If this file is specified you should restrict its file permissions to maintain the integrity of the file. The file should be writable by only the administrators on the system."},"id":"cis-kubernetes-benchmark-2.2.10","impact":1,"refs":[],"source_location":{"line":232,"ref":"cis-kubernetes-benchmark-master/controls/2_2_worker_node_configuration_files.rb"},"tags":{"cis":"kubernetes:2.2.10","level":1},"title":"Ensure that the kubelet configuration file has permissions set to 644 or more restrictive"}],"copyright":"Schuberg Philis B.V.","copyright_email":"kvlaardingerbroek@schubergphilis.com","generator":{"name":"inspec","version":"3.9.3"},"groups":[{"controls":["cis-kubernetes-benchmark-1.1.1","cis-kubernetes-benchmark-1.1.2","cis-kubernetes-benchmark-1.1.3","cis-kubernetes-benchmark-1.1.4","cis-kubernetes-benchmark-1.1.5","cis-kubernetes-benchmark-1.1.6","cis-kubernetes-benchmark-1.1.7","cis-kubernetes-benchmark-1.1.8","cis-kubernetes-benchmark-1.1.9","cis-kubernetes-benchmark-1.1.10","cis-kubernetes-benchmark-1.1.11","cis-kubernetes-benchmark-1.1.12","cis-kubernetes-benchmark-1.1.13","cis-kubernetes-benchmark-1.1.14","cis-kubernetes-benchmark-1.1.15","cis-kubernetes-benchmark-1.1.16","cis-kubernetes-benchmark-1.1.17","cis-kubernetes-benchmark-1.1.18","cis-kubernetes-benchmark-1.1.19","cis-kubernetes-benchmark-1.1.20","cis-kubernetes-benchmark-1.1.21","cis-kubernetes-benchmark-1.1.22","cis-kubernetes-benchmark-1.1.23","cis-kubernetes-benchmark-1.1.24","cis-kubernetes-benchmark-1.1.25","cis-kubernetes-benchmark-1.1.26","cis-kubernetes-benchmark-1.1.27","cis-kubernetes-benchmark-1.1.28","cis-kubernetes-benchmark-1.1.29","cis-kubernetes-benchmark-1.1.30","cis-kubernetes-benchmark-1.1.31","cis-kubernetes-benchmark-1.1.32","cis-kubernetes-benchmark-1.1.33","cis-kubernetes-benchmark-1.1.34","cis-kubernetes-benchmark-1.1.35","cis-kubernetes-benchmark-1.1.36","cis-kubernetes-benchmark-1.1.37","cis-kubernetes-benchmark-1.1.38","cis-kubernetes-benchmark-1.1.39"],"id":"controls/1_1_master_node_api_server.rb","title":"1.1 Master Node: API Server"},{"controls":["cis-kubernetes-benchmark-1.2.1","cis-kubernetes-benchmark-1.2.2"],"id":"controls/1_2_master_node_scheduler.rb","title":"1.2 Master Node: Scheduler"},{"controls":["cis-kubernetes-benchmark-1.3.1","cis-kubernetes-benchmark-1.3.2","cis-kubernetes-benchmark-1.3.3","cis-kubernetes-benchmark-1.3.4","cis-kubernetes-benchmark-1.3.5","cis-kubernetes-benchmark-1.3.6","cis-kubernetes-benchmark-1.3.7"],"id":"controls/1_3_master_node_controller_manager.rb","title":"1.3 Master Node: Controller Manager"},{"controls":["cis-kubernetes-benchmark-1.4.1","cis-kubernetes-benchmark-1.4.2","cis-kubernetes-benchmark-1.4.3","cis-kubernetes-benchmark-1.4.4","cis-kubernetes-benchmark-1.4.5","cis-kubernetes-benchmark-1.4.6","cis-kubernetes-benchmark-1.4.7","cis-kubernetes-benchmark-1.4.8","cis-kubernetes-benchmark-1.4.9","cis-kubernetes-benchmark-1.4.10","cis-kubernetes-benchmark-1.4.11","cis-kubernetes-benchmark-1.4.12","cis-kubernetes-benchmark-1.4.13","cis-kubernetes-benchmark-1.4.14","cis-kubernetes-benchmark-1.4.15","cis-kubernetes-benchmark-1.4.16","cis-kubernetes-benchmark-1.4.17","cis-kubernetes-benchmark-1.4.18","cis-kubernetes-benchmark-1.4.19","cis-kubernetes-benchmark-1.4.20","cis-kubernetes-benchmark-1.4.21"],"id":"controls/1_4_master_node_configuration_files.rb","title":"1.4 Master Node: Configuration Files"},{"controls":["cis-kubernetes-benchmark-1.5.1","cis-kubernetes-benchmark-1.5.2","cis-kubernetes-benchmark-1.5.3","cis-kubernetes-benchmark-1.5.4","cis-kubernetes-benchmark-1.5.5","cis-kubernetes-benchmark-1.5.6","cis-kubernetes-benchmark-1.5.9"],"id":"controls/1_5_master_node_etcd.rb","title":"1.5 Master Node: etcd"},{"controls":["cis-kubernetes-benchmark-1.6.1","cis-kubernetes-benchmark-1.6.2","cis-kubernetes-benchmark-1.6.3","cis-kubernetes-benchmark-1.6.4","cis-kubernetes-benchmark-1.6.5","cis-kubernetes-benchmark-1.6.6","cis-kubernetes-benchmark-1.6.7","cis-kubernetes-benchmark-1.6.8"],"id":"controls/1_6_master_node_general_security_primitives.rb","title":"1.6 Master Node: General Security Primitives"},{"controls":["cis-kubernetes-benchmark-1.7.1","cis-kubernetes-benchmark-1.7.2","cis-kubernetes-benchmark-1.7.3","cis-kubernetes-benchmark-1.7.4","cis-kubernetes-benchmark-1.7.5","cis-kubernetes-benchmark-1.7.6","cis-kubernetes-benchmark-1.7.7"],"id":"controls/1_7_master_node_pod_security_policies.rb","title":"1.7 Master Node: Pod Security Policies"},{"controls":["cis-kubernetes-benchmark-2.1.1","cis-kubernetes-benchmark-2.1.2","cis-kubernetes-benchmark-2.1.3","cis-kubernetes-benchmark-2.1.4","cis-kubernetes-benchmark-2.1.5","cis-kubernetes-benchmark-2.1.6","cis-kubernetes-benchmark-2.1.7","cis-kubernetes-benchmark-2.1.8","cis-kubernetes-benchmark-2.1.9","cis-kubernetes-benchmark-2.1.10","cis-kubernetes-benchmark-2.1.11","cis-kubernetes-benchmark-2.1.12","cis-kubernetes-benchmark-2.1.13","cis-kubernetes-benchmark-2.1.14"],"id":"controls/2_1_worker_node_kubelet.rb","title":"2.1 Worker Node: Kubelet"},{"controls":["cis-kubernetes-benchmark-2.2.1","cis-kubernetes-benchmark-2.2.2","cis-kubernetes-benchmark-2.2.3","cis-kubernetes-benchmark-2.2.4","cis-kubernetes-benchmark-2.2.5","cis-kubernetes-benchmark-2.2.6","cis-kubernetes-benchmark-2.2.7","cis-kubernetes-benchmark-2.2.8","cis-kubernetes-benchmark-2.2.9","cis-kubernetes-benchmark-2.2.10"],"id":"controls/2_2_worker_node_configuration_files.rb","title":"2.2 Worker Node: Configuration Files"}],"inputs":[{"name":"cis_level","options":{"description":"CIS profile level to audit","required":false,"type":"numeric","value":2}},{"name":"apiserver","options":{"description":"The name of the apiserver process","required":false,"type":"string"}},{"name":"controller_manager","options":{"description":"The name of the controller manager process","required":false,"type":"string"}},{"name":"scheduler","options":{"description":"The name of the kube scheduler proces","required":false,"type":"string"}},{"name":"kubelet","options":{"description":"The name of the kubelet process","required":false,"type":"string"}}],"inspec_version":"\u003e= 2.3.5","license":"Apache-2.0","maintainer":"Kristian Vlaardingerbroek","name":"cis-kubernetes-benchmark","sha256":"1fd6d1cc037bb26f5231338bf197207e7e09535b39889dcae8c0672aa270d313","status":"loaded","summary":"An InSpec Compliance profile for the CIS Kubernetes Benchmark","supports":[{"platform-family":"unix"}],"title":"CIS Kubernetes Benchmark Profile","version":"0.4.0"}
</script>


    
    
    

    
    <footer>
      <ul>
  <li><a href="/legal">Legal notice</a></li>
  <li><a href="/contributing">Contributing</a></li>
  <li><a href="https://twitter.com/devsecio">Twitter</a></li>
  <li><a href="https://galaxy.ansible.com/devsec/hardening">Ansible Galaxy</a></li>
  <li><a href="https://supermarket.getchef.com/cookbooks?q=hardening">Chef Community</a></li>
  <li><a href="https://forge.puppetlabs.com/hardening">Puppet Forge</a></li>
</ul>

    </footer>
    

    <script src="/jquery/dist/jquery.min.js"></script>
    <script src="/foundation/js/foundation/foundation.js"></script>
    <script src="/foundation/js/foundation/foundation.equalizer.js"></script>
    <script src="/foundation/js/foundation/foundation.topbar.js"></script>

    <script src="/js/app.js"></script>

    <script type="text/javascript">
    var $buoop = {vs:{i:9,f:15,o:12.1,s:5.1}};
    $buoop.ol = window.onload;
    window.onload=function(){
      console.log($buoop);
      try {if ($buoop.ol) $buoop.ol();}catch (e) {}
      var e = document.createElement("script");
      e.setAttribute("type", "text/javascript");
      e.setAttribute("src", "//browser-update.org/update.js");
      document.body.appendChild(e);
    }

    </script>
  </body>
</html>
