{"name":"mysql-baseline","title":"DevSec MySQL Baseline","maintainer":"DevSec Hardening Framework Team","copyright":"DevSec Hardening Framework Team","copyright_email":"hello@dev-sec.io","license":"Apache-2.0","summary":"Test-suite for best-practice mysql hardening","version":"3.1.0","supports":[{"platform-family":"unix"}],"controls":[{"title":"ensure the service is enabled and running","desc":null,"descriptions":{},"impact":0.5,"refs":[],"tags":{},"code":"control 'mysql-conf-01' do\n  impact 0.5\n  title 'ensure the service is enabled and running'\n  describe service(service_name) do\n    it { should be_enabled }\n    it { should be_running }\n  end\nend\n","source_location":{"ref":"mysql-baseline-master/controls/mysql_conf.rb","line":42},"id":"mysql-conf-01"},{"title":"only one instance of mysql should run on a server","desc":null,"descriptions":{},"impact":0.5,"refs":[],"tags":{},"code":"control 'mysql-conf-02' do\n  impact 0.5\n  title 'only one instance of mysql should run on a server'\n  describe command('ps aux | grep mysqld | egrep -v \"grep|mysqld_safe|logger\" | wc -l') do\n    its(:stdout) { should match(/^1$/) }\n  end\nend\n","source_location":{"ref":"mysql-baseline-master/controls/mysql_conf.rb","line":52},"id":"mysql-conf-02"},{"title":"enable secure configurations for mysql","desc":null,"descriptions":{},"impact":0.7,"refs":[],"tags":{},"code":"control 'mysql-conf-03' do\n  impact 0.7\n  title 'enable secure configurations for mysql'\n  describe mysql_conf.params('mysqld') do\n    its('safe-user-create') { should cmp 1 }\n    its('old_passwords') { should_not cmp 1 }\n    its('secure-auth') { should cmp 1 }\n    its('user') { should cmp 'mysql' }\n    its('skip-symbolic-links') { should cmp 1 }\n    its('secure-file-priv') { should_not eq nil }\n    its('local-infile') { should cmp 0 }\n    its('skip-show-database') { should eq '' }\n    its('skip-grant-tables') { should eq nil }\n    its('allow-suspicious-udfs') { should cmp 0 }\n  end\nend\n","source_location":{"ref":"mysql-baseline-master/controls/mysql_conf.rb","line":61},"id":"mysql-conf-03"},{"title":"ensure the mysql data path is owned by mysql user","desc":null,"descriptions":{},"impact":0.7,"refs":[],"tags":{},"code":"control 'mysql-conf-04' do\n  impact 0.7\n  title 'ensure the mysql data path is owned by mysql user'\n  describe file(mysql_data_path) do\n    it { should be_directory }\n    it { should be_owned_by 'mysql' }\n    it { should be_grouped_into 'mysql' }\n  end\nend\n","source_location":{"ref":"mysql-baseline-master/controls/mysql_conf.rb","line":79},"id":"mysql-conf-04"},{"title":"ensure data path is owned by mysql user","desc":null,"descriptions":{},"impact":0.5,"refs":[],"tags":{},"code":"control 'mysql-conf-05' do\n  impact 0.5\n  title 'ensure data path is owned by mysql user'\n  describe file(\"#{mysql_data_path}/ibdata1\") do\n    it { should be_owned_by 'mysql' }\n    it { should be_grouped_into 'mysql' }\n    it { should_not be_readable.by('others') }\n    it { should_not be_writable.by('others') }\n    it { should_not be_executable.by('others') }\n  end\nend\n","source_location":{"ref":"mysql-baseline-master/controls/mysql_conf.rb","line":89},"id":"mysql-conf-05"},{"title":"ensure log file is owned by mysql user","desc":null,"descriptions":{},"impact":0.5,"refs":[],"tags":{},"code":"control 'mysql-conf-06' do\n  impact 0.5\n  title 'ensure log file is owned by mysql user'\n  describe file(\"#{mysql_log_path}/#{mysql_log_file}\") do\n    it { should be_owned_by 'mysql' }\n    it { should be_grouped_into mysql_log_group }\n    it { should_not be_readable.by('others') }\n    it { should_not be_writable.by('others') }\n    it { should_not be_executable.by('others') }\n  end\nend\n","source_location":{"ref":"mysql-baseline-master/controls/mysql_conf.rb","line":101},"id":"mysql-conf-06"},{"title":"ensure the mysql config file is owned by root","desc":null,"descriptions":{},"impact":0.7,"refs":[],"tags":{},"code":"control 'mysql-conf-07' do\n  impact 0.7\n  title 'ensure the mysql config file is owned by root'\n  describe file(mysql_config_file) do\n    it { should be_file }\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n    it { should_not be_readable.by('others') }\n  end\nend\n","source_location":{"ref":"mysql-baseline-master/controls/mysql_conf.rb","line":113},"id":"mysql-conf-07"},{"title":"ensure the mysql hardening config file is owned by root","desc":null,"descriptions":{},"impact":0.5,"refs":[],"tags":{},"code":"control 'mysql-conf-08' do\n  impact 0.5\n  title 'ensure the mysql hardening config file is owned by root'\n  describe file(mysql_hardening_file) do\n    it { should be_owned_by 'root' }\n    it { should be_grouped_into 'root' }\n    it { should_not be_readable.by('others') }\n  end\n  only_if { command(\"ls #{mysql_hardening_file}\").exit_status.zero? }\nend\n","source_location":{"ref":"mysql-baseline-master/controls/mysql_conf.rb","line":125},"id":"mysql-conf-08"},{"title":"the use of MYSQL_PWD is insecure and can exploit the password","desc":null,"descriptions":{},"impact":1.0,"refs":[],"tags":{},"code":"control 'mysql-conf-09' do\n  impact 1.0\n  title 'the use of MYSQL_PWD is insecure and can exploit the password'\n  describe command('env') do\n    its(:stdout) { should_not match(/^MYSQL_PWD=/) }\n  end\nend\n","source_location":{"ref":"mysql-baseline-master/controls/mysql_conf.rb","line":137},"id":"mysql-conf-09"},{"title":"use supported mysql version in production","desc":null,"descriptions":{},"impact":0.3,"refs":[],"tags":{},"code":"control 'mysql-db-01' do\n  impact 0.3\n  title 'use supported mysql version in production'\n  describe command(\"mysql -u#{user} -p#{pass} mysql -s -e 'select version();' | tail -1\") do\n    its(:stdout) { should_not match(/Community/) }\n  end\nend\n","source_location":{"ref":"mysql-baseline-master/controls/mysql_db.rb","line":22},"id":"mysql-db-01"},{"title":"use mysql version 5 or higher","desc":null,"descriptions":{},"impact":0.5,"refs":[],"tags":{},"code":"control 'mysql-db-02' do\n  impact 0.5\n  title 'use mysql version 5 or higher'\n  describe command(\"mysql -u#{user} -p#{pass} mysql -s -e 'select substring_index(version(),\\\".\\\",1);'\") do\n    its(:stdout) { should cmp >= 5 }\n  end\nend\n","source_location":{"ref":"mysql-baseline-master/controls/mysql_db.rb","line":30},"id":"mysql-db-02"},{"title":"test database must be deleted","desc":null,"descriptions":{},"impact":1.0,"refs":[],"tags":{},"code":"control 'mysql-db-03' do\n  impact 1.0\n  title 'test database must be deleted'\n  describe command(\"mysql -u#{user} -p#{pass} -s -e 'show databases like \\\"test\\\";'\") do\n    its(:stdout) { should_not match(/test/) }\n  end\nend\n","source_location":{"ref":"mysql-baseline-master/controls/mysql_db.rb","line":38},"id":"mysql-db-03"},{"title":"deactivate annonymous user names","desc":null,"descriptions":{},"impact":1.0,"refs":[],"tags":{},"code":"control 'mysql-db-04' do\n  impact 1.0\n  title 'deactivate annonymous user names'\n  describe command(\"mysql -u#{user} -p#{pass} mysql -s -e 'select count(*) from mysql.user where user=\\\"\\\";' | tail -1\") do\n    its(:stdout) { should match(/^0/) }\n  end\nend\n","source_location":{"ref":"mysql-baseline-master/controls/mysql_db.rb","line":46},"id":"mysql-db-04"},{"title":"default passwords must be changed","desc":null,"descriptions":{},"impact":1.0,"refs":[],"tags":{},"code":"control 'mysql-db-05' do\n  impact 1.0\n  title 'default passwords must be changed'\n  describe command(\"mysql -u#{user} -p#{pass} mysql -s -e 'select count(*) from mysql.user where length(password)=0 or password=\\\"\\\";' | tail -1\") do\n    its(:stdout) { should match(/^0/) }\n  end\nend\n","source_location":{"ref":"mysql-baseline-master/controls/mysql_db.rb","line":54},"id":"mysql-db-05"},{"title":"the grant option must not be used","desc":null,"descriptions":{},"impact":0.5,"refs":[],"tags":{},"code":"control 'mysql-db-06' do\n  impact 0.5\n  title 'the grant option must not be used'\n  describe command(\"mysql -u#{user} -p#{pass} mysql -s -e 'select count(*) from mysql.user where grant_priv=\\\"y\\\" and User!=\\\"root\\\" and User!=\\\"debian-sys-maint\\\";' | tail -1\") do\n    its(:stdout) { should match(/^0/) }\n  end\nend\n","source_location":{"ref":"mysql-baseline-master/controls/mysql_db.rb","line":62},"id":"mysql-db-06"},{"title":"ensure no wildcards are used for hostnames","desc":null,"descriptions":{},"impact":0.5,"refs":[],"tags":{},"code":"control 'mysql-db-07' do\n  impact 0.5\n  title 'ensure no wildcards are used for hostnames'\n  describe command(\"mysql -u#{user} -p#{pass} mysql -s -e 'select count(*) from mysql.user where host=\\\"%\\\"' | tail -1\") do\n    its(:stdout) { should match(/^0/) }\n  end\nend\n","source_location":{"ref":"mysql-baseline-master/controls/mysql_db.rb","line":70},"id":"mysql-db-07"},{"title":"it must be ensured that superuser can login via localhost only","desc":null,"descriptions":{},"impact":0.5,"refs":[],"tags":{},"code":"control 'mysql-db-08' do\n  impact 0.5\n  title 'it must be ensured that superuser can login via localhost only'\n  describe command(\"mysql -u#{user} -p#{pass} mysql -s -e 'select count(*) from mysql.user where user=\\\"root\\\" and host not in (\\\"localhost\\\",\\\"127.0.0.1\\\",\\\"::1\\\")' | tail -1\") do\n    its(:stdout) { should match(/^0/) }\n  end\nend\n","source_location":{"ref":"mysql-baseline-master/controls/mysql_db.rb","line":78},"id":"mysql-db-08"}],"groups":[{"title":null,"controls":["mysql-conf-01","mysql-conf-02","mysql-conf-03","mysql-conf-04","mysql-conf-05","mysql-conf-06","mysql-conf-07","mysql-conf-08","mysql-conf-09"],"id":"controls/mysql_conf.rb"},{"title":null,"controls":["mysql-db-01","mysql-db-02","mysql-db-03","mysql-db-04","mysql-db-05","mysql-db-06","mysql-db-07","mysql-db-08"],"id":"controls/mysql_db.rb"}],"inputs":[{"name":"User","options":{"description":"MySQL database user","required":true,"value":"root"}},{"name":"Password","options":{"description":"MySQL database password","required":true,"value":"iloverandompasswordsbutthiswilldo"}}],"sha256":"2c86e98703a7f88c13483f2ccb9c8f131262fef5ace02bee90b181a3234e44f0","status":"loaded","generator":{"name":"inspec","version":"3.9.3"}}
